
================================================================================
SESSION LOG
================================================================================
Session Name: all
Session ID: 20260120_122847
Start Time: 2026-01-20 12:28:47
Command: run_tests.py all
Working Directory: C:\esp32-project
Python Version: 3.10.11
================================================================================

ðŸš€ Starting session: all
ðŸ“‹ Logging to: C:\esp32-project\logs\session_20260120_122847_all.log
ðŸ“Š LLM log: C:\esp32-project\logs\session_20260120_122847_all.llm.md

Running: pytest -v
================================================================================
C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\site-packages\pytest_asyncio\plugin.py:247: PytestDeprecationWarning: The configuration option "asyncio_default_fixture_loop_scope" is unset.
The event loop scope for asynchronous fixtures will default to the fixture caching scope. Future versions of pytest-asyncio will default the loop scope for asynchronous fixtures to function scope. Set the default fixture loop scope explicitly in order to avoid unexpected behavior in the future. Valid fixture loop scopes are: "function", "class", "module", "package", "session"

  warnings.warn(PytestDeprecationWarning(_DEFAULT_FIXTURE_LOOP_SCOPE_UNSET))
============================= test session starts =============================
platform win32 -- Python 3.10.11, pytest-8.3.4, pluggy-1.6.0 -- C:\Users\doghe\AppData\Local\Programs\Python\Python310\python.exe
cachedir: .pytest_cache
PyQt6 6.10.2 -- Qt runtime 6.10.1 -- Qt compiled 6.10.0
rootdir: C:\esp32-project
configfile: pyproject.toml
testpaths: tests, tools/wiki_to_chromadb/tests, tools/script-generator/tests
plugins: cov-4.1.0, anyio-4.12.1, hydra-core-1.3.2, asyncio-1.3.0, base-url-2.1.0, mock-3.15.1, playwright-0.7.2, qt-4.5.0, timeout-2.4.0, xvfb-3.1.1, typeguard-4.4.4
asyncio: mode=strict, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 950 items

tests/e2e/test_chromadb_e2e.py::TestChromaDBInitialization::test_chromadb_initialization SKIPPED [  0%]
tests/e2e/test_chromadb_e2e.py::TestChromaDBDocumentIngestion::test_chromadb_document_ingestion SKIPPED [  0%]
tests/e2e/test_chromadb_e2e.py::TestChromaDBSemanticSearch::test_chromadb_semantic_search SKIPPED [  0%]
tests/e2e/test_chromadb_e2e.py::TestChromaDBMetadataFiltering::test_chromadb_metadata_filtering SKIPPED [  0%]
tests/e2e/test_chromadb_e2e.py::TestChromaDBRelevanceScoring::test_chromadb_relevance_scoring SKIPPED [  0%]
tests/e2e/test_chromadb_e2e.py::TestChromaDBCollectionManagement::test_chromadb_collection_management SKIPPED [  0%]
tests/e2e/test_chromadb_e2e.py::TestChromaDBPerformance::test_chromadb_query_performance SKIPPED [  0%]
tests/e2e/test_chromadb_e2e.py::TestChromaDBPerformance::test_chromadb_retrieval_accuracy SKIPPED [  0%]
tests/e2e/test_full_pipeline_e2e.py::TestBroadcastWithRAG::test_broadcast_generation_with_rag SKIPPED [  0%]
tests/e2e/test_full_pipeline_e2e.py::TestMultiSegmentBroadcast::test_multi_segment_broadcast SKIPPED [  1%]
tests/e2e/test_full_pipeline_e2e.py::TestStoryContinuity::test_story_continuity SKIPPED [  1%]
tests/e2e/test_full_pipeline_e2e.py::TestValidationWithRealLLM::test_validation_with_real_llm SKIPPED [  1%]
tests/e2e/test_ollama_e2e.py::TestOllamaConnection::test_ollama_connection SKIPPED [  1%]
tests/e2e/test_ollama_e2e.py::TestOllamaConnection::test_ollama_model_availability SKIPPED [  1%]
tests/e2e/test_ollama_e2e.py::TestOllamaTextGeneration::test_ollama_text_generation SKIPPED [  1%]
tests/e2e/test_ollama_e2e.py::TestOllamaTextGeneration::test_ollama_json_mode SKIPPED [  1%]
tests/e2e/test_ollama_e2e.py::TestOllamaTextGeneration::test_ollama_streaming SKIPPED [  1%]
tests/e2e/test_ollama_e2e.py::TestOllamaTextGeneration::test_ollama_parameters SKIPPED [  1%]
tests/e2e/test_ollama_e2e.py::TestOllamaErrorHandling::test_ollama_timeout SKIPPED [  2%]
tests/e2e/test_ollama_e2e.py::TestOllamaErrorHandling::test_ollama_invalid_model SKIPPED [  2%]
tests/integration/test_broadcast_pipeline.py::TestBroadcastPipelineIntegration::test_single_segment_generation_workflow PASSED [  2%]
tests/integration/test_broadcast_pipeline.py::TestBroadcastPipelineIntegration::test_multi_segment_broadcast_session PASSED [  2%]
tests/integration/test_broadcast_pipeline.py::TestRAGPipelineIntegration::test_rag_retrieval_and_generation PASSED [  2%]
tests/integration/test_broadcast_pipeline.py::TestLoggingIntegration::test_complete_workflow_with_logging PASSED [  2%]
tests/integration/test_broadcast_pipeline.py::TestErrorHandlingIntegration::test_ollama_failure_recovery PASSED [  2%]
tests/integration/test_broadcast_pipeline.py::TestErrorHandlingIntegration::test_empty_rag_results_handling PASSED [  2%]
tests/integration/test_broadcast_pipeline.py::TestValidationIntegration::test_validation_in_pipeline PASSED [  2%]
tests/integration/test_broadcast_pipeline.py::TestPerformanceIntegration::test_multiple_rapid_generations PASSED [  2%]
tests/unit/test_broadcast.py::TestBroadcastCLI::test_dj_name_resolution PASSED [  3%]
tests/unit/test_broadcast.py::TestBroadcastCLI::test_dj_name_case_insensitive PASSED [  3%]
tests/unit/test_broadcast.py::TestBroadcastCLI::test_dj_full_name_resolution PASSED [  3%]
tests/unit/test_broadcast.py::TestBroadcastCLI::test_invalid_dj_name PASSED [  3%]
tests/unit/test_broadcast.py::TestBroadcastCLI::test_output_filename_generation PASSED [  3%]
tests/unit/test_broadcast.py::TestBroadcastCLI::test_output_filename_with_stories PASSED [  3%]
tests/unit/test_broadcast.py::TestBroadcastHelpers::test_dj_shortcuts_complete PASSED [  3%]
tests/unit/test_broadcast.py::TestBroadcastHelpers::test_available_djs_list PASSED [  3%]
tests/unit/test_broadcast_engine.py::TestBroadcastEngineInitialization::test_basic_initialization PASSED [  3%]
tests/unit/test_broadcast_engine.py::TestBroadcastEngineInitialization::test_initialization_with_custom_paths PASSED [  4%]
tests/unit/test_broadcast_engine.py::TestBroadcastEngineInitialization::test_initialization_with_validation PASSED [  4%]
tests/unit/test_broadcast_engine.py::TestBroadcastEngineSegmentGeneration::test_generate_weather_segment FAILED [  4%]
tests/unit/test_broadcast_engine.py::TestBroadcastEngineStateManagement::test_session_memory_tracking PASSED [  4%]
tests/unit/test_broadcast_engine.py::TestBroadcastEngineStateManagement::test_world_state_persistence PASSED [  4%]
tests/unit/test_broadcast_engine.py::TestBroadcastEngineValidation::test_validation_enabled PASSED [  4%]
tests/unit/test_broadcast_engine.py::TestBroadcastEngineValidation::test_validation_disabled PASSED [  4%]
tests/unit/test_broadcast_engine.py::TestBroadcastEngineContentTypes::test_weather_content_type_selection PASSED [  4%]
tests/unit/test_broadcast_engine.py::TestBroadcastEngineErrorHandling::test_generator_failure_handling PASSED [  4%]
tests/unit/test_broadcast_engine.py::TestBroadcastEngineIntegration::test_multi_segment_generation PASSED [  4%]
tests/unit/test_content_types.py::TestWeatherContent::test_select_weather_basic PASSED [  5%]
tests/unit/test_content_types.py::TestWeatherContent::test_get_weather_template_vars PASSED [  5%]
tests/unit/test_content_types.py::TestWeatherContent::test_weather_time_of_day_morning PASSED [  5%]
tests/unit/test_content_types.py::TestWeatherContent::test_weather_time_of_day_evening PASSED [  5%]
tests/unit/test_content_types.py::TestNewsContent::test_select_news_category PASSED [  5%]
tests/unit/test_content_types.py::TestNewsContent::test_get_news_template_vars PASSED [  5%]
tests/unit/test_content_types.py::TestNewsContent::test_news_categories_variety PASSED [  5%]
tests/unit/test_content_types.py::TestGossipContent::test_gossip_tracker_initialization PASSED [  5%]
tests/unit/test_content_types.py::TestGossipContent::test_gossip_tracker_with_persistence_path PASSED [  5%]
tests/unit/test_content_types.py::TestGossipContent::test_gossip_tracker_has_lists PASSED [  6%]
tests/unit/test_content_types.py::TestGossipContent::test_get_gossip_template_vars PASSED [  6%]
tests/unit/test_content_types.py::TestTimeCheckContent::test_get_time_check_template_vars_morning PASSED [  6%]
tests/unit/test_content_types.py::TestTimeCheckContent::test_get_time_check_template_vars_evening PASSED [  6%]
tests/unit/test_content_types.py::TestTimeCheckContent::test_time_check_formatting PASSED [  6%]
tests/unit/test_content_types.py::TestContentTypeIntegration::test_all_content_types_available PASSED [  6%]
tests/unit/test_content_types.py::TestContentTypeIntegration::test_template_vars_consistency PASSED [  6%]
tests/unit/test_content_types.py::TestContentTypeEdgeCases::test_invalid_time_of_day PASSED [  6%]
tests/unit/test_content_types.py::TestContentTypeEdgeCases::test_missing_dj_name PASSED [  6%]
tests/unit/test_content_types.py::TestContentTypeEdgeCases::test_future_date PASSED [  6%]
tests/unit/test_dj_knowledge_profiles.py::TestConfidenceTier::test_confidence_tier_values PASSED [  7%]
tests/unit/test_dj_knowledge_profiles.py::TestConfidenceTier::test_confidence_tier_ordering PASSED [  7%]
tests/unit/test_dj_knowledge_profiles.py::TestConfidenceTier::test_confidence_tier_membership PASSED [  7%]
tests/unit/test_dj_knowledge_profiles.py::TestQueryResult::test_query_result_creation PASSED [  7%]
tests/unit/test_dj_knowledge_profiles.py::TestQueryResult::test_query_result_without_framing PASSED [  7%]
tests/unit/test_dj_knowledge_profiles.py::TestDJKnowledgeProfileBase::test_profile_initialization PASSED [  7%]
tests/unit/test_dj_knowledge_profiles.py::TestDJKnowledgeProfileBase::test_get_temporal_filter PASSED [  7%]
tests/unit/test_dj_knowledge_profiles.py::TestJulieProfile::test_julie_profile_attributes PASSED [  7%]
tests/unit/test_dj_knowledge_profiles.py::TestJulieProfile::test_julie_high_confidence_filter PASSED [  7%]
tests/unit/test_dj_knowledge_profiles.py::TestJulieProfile::test_julie_medium_confidence_filter PASSED [  8%]
tests/unit/test_dj_knowledge_profiles.py::TestJulieProfile::test_julie_low_confidence_filter PASSED [  8%]
tests/unit/test_dj_knowledge_profiles.py::TestJulieProfile::test_julie_vault_tec_discovery_templates PASSED [  8%]
tests/unit/test_dj_knowledge_profiles.py::TestJulieProfile::test_julie_rumor_templates PASSED [  8%]
tests/unit/test_dj_knowledge_profiles.py::TestJulieProfile::test_julie_narrative_framing_vault_tec PASSED [  8%]
tests/unit/test_dj_knowledge_profiles.py::TestJulieProfile::test_julie_narrative_framing_rumor PASSED [  8%]
tests/unit/test_dj_knowledge_profiles.py::TestJulieProfile::test_julie_narrative_framing_standard PASSED [  8%]
tests/unit/test_dj_knowledge_profiles.py::TestMrNewVegasProfile::test_mr_new_vegas_profile_attributes PASSED [  8%]
tests/unit/test_dj_knowledge_profiles.py::TestMrNewVegasProfile::test_mr_new_vegas_high_confidence_filter PASSED [  8%]
tests/unit/test_dj_knowledge_profiles.py::TestMrNewVegasProfile::test_mr_new_vegas_medium_confidence_filter PASSED [  8%]
tests/unit/test_dj_knowledge_profiles.py::TestMrNewVegasProfile::test_mr_new_vegas_low_confidence_filter PASSED [  9%]
tests/unit/test_dj_knowledge_profiles.py::TestMrNewVegasProfile::test_mr_new_vegas_prewar_access_filter PASSED [  9%]
tests/unit/test_dj_knowledge_profiles.py::TestMrNewVegasProfile::test_mr_new_vegas_prewar_templates PASSED [  9%]
tests/unit/test_dj_knowledge_profiles.py::TestMrNewVegasProfile::test_mr_new_vegas_rumor_templates PASSED [  9%]
tests/unit/test_dj_knowledge_profiles.py::TestMrNewVegasProfile::test_mr_new_vegas_narrative_framing_prewar PASSED [  9%]
tests/unit/test_dj_knowledge_profiles.py::TestMrNewVegasProfile::test_mr_new_vegas_narrative_framing_rumor PASSED [  9%]
tests/unit/test_dj_knowledge_profiles.py::TestTravisNervousProfile::test_travis_nervous_profile_attributes PASSED [  9%]
tests/unit/test_dj_knowledge_profiles.py::TestTravisNervousProfile::test_travis_nervous_high_confidence_filter PASSED [  9%]
tests/unit/test_dj_knowledge_profiles.py::TestTravisNervousProfile::test_travis_nervous_medium_confidence_filter PASSED [  9%]
tests/unit/test_dj_knowledge_profiles.py::TestTravisNervousProfile::test_travis_nervous_low_confidence_filter PASSED [ 10%]
tests/unit/test_dj_knowledge_profiles.py::TestTravisNervousProfile::test_travis_nervous_rumor_templates PASSED [ 10%]
tests/unit/test_dj_knowledge_profiles.py::TestTravisNervousProfile::test_travis_nervous_narrative_framing_rumor PASSED [ 10%]
tests/unit/test_dj_knowledge_profiles.py::TestTravisConfidentProfile::test_travis_confident_profile_attributes PASSED [ 10%]
tests/unit/test_dj_knowledge_profiles.py::TestTravisConfidentProfile::test_travis_confident_high_confidence_filter PASSED [ 10%]
tests/unit/test_dj_knowledge_profiles.py::TestTravisConfidentProfile::test_travis_confident_medium_confidence_filter PASSED [ 10%]
tests/unit/test_dj_knowledge_profiles.py::TestTravisConfidentProfile::test_travis_confident_low_confidence_filter PASSED [ 10%]
tests/unit/test_dj_knowledge_profiles.py::TestTravisConfidentProfile::test_travis_confident_rumor_templates PASSED [ 10%]
tests/unit/test_dj_knowledge_profiles.py::TestTravisConfidentProfile::test_travis_confident_narrative_framing_rumor PASSED [ 10%]
tests/unit/test_dj_knowledge_profiles.py::TestDJProfileRegistry::test_registry_contains_all_djs PASSED [ 10%]
tests/unit/test_dj_knowledge_profiles.py::TestDJProfileRegistry::test_registry_correct_types PASSED [ 11%]
tests/unit/test_dj_knowledge_profiles.py::TestDJProfileRegistry::test_registry_size PASSED [ 11%]
tests/unit/test_dj_knowledge_profiles.py::TestGetDJProfile::test_get_julie_profile PASSED [ 11%]
tests/unit/test_dj_knowledge_profiles.py::TestGetDJProfile::test_get_mr_new_vegas_profile PASSED [ 11%]
tests/unit/test_dj_knowledge_profiles.py::TestGetDJProfile::test_get_travis_nervous_profile PASSED [ 11%]
tests/unit/test_dj_knowledge_profiles.py::TestGetDJProfile::test_get_travis_confident_profile PASSED [ 11%]
tests/unit/test_dj_knowledge_profiles.py::TestGetDJProfile::test_get_unknown_dj_raises_value_error PASSED [ 11%]
tests/unit/test_dj_knowledge_profiles.py::TestPhase6EnhancedFilters::test_freshness_filter PASSED [ 11%]
tests/unit/test_dj_knowledge_profiles.py::TestPhase6EnhancedFilters::test_tone_filter PASSED [ 11%]
tests/unit/test_dj_knowledge_profiles.py::TestPhase6EnhancedFilters::test_subject_exclusion_filter PASSED [ 12%]
tests/unit/test_dj_knowledge_profiles.py::TestPhase6EnhancedFilters::test_complexity_filter PASSED [ 12%]
tests/unit/test_dj_knowledge_profiles.py::TestPhase6EnhancedFilters::test_enhanced_filter_with_all_options PASSED [ 12%]
tests/unit/test_dj_knowledge_profiles.py::TestPhase6EnhancedFilters::test_enhanced_filter_with_no_options PASSED [ 12%]
tests/unit/test_dj_knowledge_profiles.py::TestPhase6EnhancedFilters::test_enhanced_filter_high_confidence PASSED [ 12%]
tests/unit/test_dj_knowledge_profiles.py::TestPhase6EnhancedFilters::test_enhanced_filter_low_confidence PASSED [ 12%]
tests/unit/test_dj_knowledge_profiles.py::TestTemporalConstraints::test_julie_temporal_constraint PASSED [ 12%]
tests/unit/test_dj_knowledge_profiles.py::TestTemporalConstraints::test_mr_new_vegas_temporal_constraint PASSED [ 12%]
tests/unit/test_dj_knowledge_profiles.py::TestTemporalConstraints::test_travis_temporal_constraint PASSED [ 12%]
tests/unit/test_dj_knowledge_profiles.py::TestTemporalConstraints::test_temporal_ordering PASSED [ 12%]
tests/unit/test_dj_knowledge_profiles.py::TestSpatialConstraints::test_julie_location PASSED [ 13%]
tests/unit/test_dj_knowledge_profiles.py::TestSpatialConstraints::test_mr_new_vegas_location PASSED [ 13%]
tests/unit/test_dj_knowledge_profiles.py::TestSpatialConstraints::test_travis_location PASSED [ 13%]
tests/unit/test_dj_knowledge_profiles.py::TestSpatialConstraints::test_east_coast_vs_west_coast PASSED [ 13%]
tests/unit/test_dj_knowledge_profiles.py::TestKnowledgeTierDifferences::test_julie_vs_travis_nervous_scope PASSED [ 13%]
tests/unit/test_dj_knowledge_profiles.py::TestKnowledgeTierDifferences::test_travis_nervous_vs_confident_difference PASSED [ 13%]
tests/unit/test_dj_knowledge_profiles.py::TestKnowledgeTierDifferences::test_mr_new_vegas_prewar_access PASSED [ 13%]
tests/unit/test_dj_knowledge_profiles.py::TestProfileIntegration::test_all_profiles_have_required_methods PASSED [ 13%]
tests/unit/test_dj_knowledge_profiles.py::TestProfileIntegration::test_all_profiles_have_phase6_methods PASSED [ 13%]
tests/unit/test_dj_knowledge_profiles.py::TestProfileIntegration::test_confidence_filters_return_dicts PASSED [ 14%]
tests/unit/test_dj_knowledge_profiles.py::TestProfileIntegration::test_narrative_framing_returns_strings PASSED [ 14%]
tests/unit/test_generator.py::TestScriptGeneratorInitialization::test_basic_initialization PASSED [ 14%]
tests/unit/test_generator.py::TestScriptGeneratorInitialization::test_initialization_with_custom_paths PASSED [ 14%]
tests/unit/test_generator.py::TestScriptGeneratorInitialization::test_initialization_ollama_connection_check PASSED [ 14%]
tests/unit/test_generator.py::TestScriptGeneratorRAGRetrieval::test_rag_context_retrieval PASSED [ 14%]
tests/unit/test_generator.py::TestScriptGeneratorGeneration::test_generate_script_basic PASSED [ 14%]
tests/unit/test_generator.py::TestScriptGeneratorGeneration::test_generate_with_template_vars PASSED [ 14%]
tests/unit/test_generator.py::TestScriptGeneratorTemplateRendering::test_template_environment_setup PASSED [ 14%]
tests/unit/test_generator.py::TestScriptGeneratorRAGCache::test_rag_cache_initialization PASSED [ 14%]
tests/unit/test_generator.py::TestScriptGeneratorErrorHandling::test_ollama_generation_failure PASSED [ 15%]
tests/unit/test_generator.py::TestScriptGeneratorValidation::test_validation_integration PASSED [ 15%]
tests/unit/test_generator.py::TestScriptGeneratorSessionState::test_session_memory_initialization PASSED [ 15%]
tests/unit/test_generator.py::TestScriptGeneratorIntegration::test_complete_generation_workflow PASSED [ 15%]
tests/unit/test_llm_pipeline.py::TestGenerationResultDataClass::test_generation_result_creation PASSED [ 15%]
tests/unit/test_llm_pipeline.py::TestGenerationResultDataClass::test_generation_result_to_dict PASSED [ 15%]
tests/unit/test_llm_pipeline.py::TestLLMPipelineInitialization::test_initialization_with_ollama_client PASSED [ 15%]
tests/unit/test_llm_pipeline.py::TestLLMPipelineInitialization::test_initialization_with_rag_cache PASSED [ 15%]
tests/unit/test_llm_pipeline.py::TestLLMPipelineInitialization::test_initialization_metrics_start_at_zero PASSED [ 15%]
tests/unit/test_llm_pipeline.py::TestLLMPipelineConstraintEmbedding::test_build_constraint_embedded_prompt PASSED [ 16%]
tests/unit/test_llm_pipeline.py::TestLLMPipelineConstraintEmbedding::test_build_constraint_embedded_prompt_no_constraints PASSED [ 16%]
tests/unit/test_llm_pipeline.py::TestLLMPipelineConstraintEmbedding::test_build_user_prompt PASSED [ 16%]
tests/unit/test_llm_pipeline.py::TestLLMPipelineGeneration::test_generate_with_validation_basic PASSED [ 16%]
tests/unit/test_llm_pipeline.py::TestLLMPipelineGeneration::test_generate_with_validation_updates_metrics FAILED [ 16%]
tests/unit/test_llm_pipeline.py::TestLLMPipelineGeneration::test_generate_with_validation_error_handling PASSED [ 16%]
tests/unit/test_llm_pipeline.py::TestLLMPipelineGeneration::test_generate_with_validation_with_topic PASSED [ 16%]
tests/unit/test_llm_pipeline.py::TestLLMPipelineSegmentPlanIntegration::test_generate_from_plan FAILED [ 16%]
tests/unit/test_llm_pipeline.py::TestLLMPipelineSegmentPlanIntegration::test_generate_from_plan_with_custom_lore FAILED [ 16%]
tests/unit/test_llm_pipeline.py::TestLLMPipelineMetrics::test_metrics_tracking FAILED [ 16%]
tests/unit/test_llm_pipeline.py::TestLLMPipelineMetrics::test_metrics_reset FAILED [ 17%]
tests/unit/test_llm_pipeline.py::TestLLMPipelineMetrics::test_get_metrics_expected_improvements PASSED [ 17%]
tests/unit/test_llm_pipeline.py::TestLLMPipelineMetrics::test_print_metrics_report FAILED [ 17%]
tests/unit/test_llm_pipeline.py::TestLLMPipelineRetryLogic::test_single_call_success FAILED [ 17%]
tests/unit/test_llm_pipeline.py::TestLLMPipelineRetryLogic::test_generation_failure_returns_error_result PASSED [ 17%]
tests/unit/test_llm_pipeline.py::TestLLMPipelineCacheIntegration::test_cache_hit_tracking FAILED [ 17%]
tests/unit/test_llm_pipeline.py::TestLLMPipelineCacheIntegration::test_cache_miss_tracking FAILED [ 17%]
tests/unit/test_llm_pipeline.py::TestLLMPipelineCacheIntegration::test_no_cache_tracking_without_cache FAILED [ 17%]
tests/unit/test_llm_pipeline.py::TestLLMPipelineValidationGuided::test_validation_guided_percentage FAILED [ 17%]
tests/unit/test_llm_pipeline.py::TestLLMPipelineValidationGuided::test_embedded_constraints_in_prompt FAILED [ 18%]
tests/unit/test_llm_validator.py::TestValidationDataClasses::test_validation_issue_creation PASSED [ 18%]
tests/unit/test_llm_validator.py::TestValidationDataClasses::test_validation_result_creation PASSED [ 18%]
tests/unit/test_llm_validator.py::TestValidationDataClasses::test_validation_result_auto_invalid_on_critical PASSED [ 18%]
tests/unit/test_llm_validator.py::TestValidationDataClasses::test_validation_result_get_issues_by_severity PASSED [ 18%]
tests/unit/test_llm_validator.py::TestValidationDataClasses::test_validation_result_to_dict PASSED [ 18%]
tests/unit/test_llm_validator.py::TestLLMValidatorInitialization::test_initialization_with_mock_client PASSED [ 18%]
tests/unit/test_llm_validator.py::TestLLMValidatorInitialization::test_initialization_validates_connection PASSED [ 18%]
tests/unit/test_llm_validator.py::TestLLMValidatorInitialization::test_initialization_fails_on_bad_connection PASSED [ 18%]
tests/unit/test_llm_validator.py::TestLLMValidatorInitialization::test_initialization_without_connection_check PASSED [ 18%]
tests/unit/test_llm_validator.py::TestLLMValidatorPromptBuilding::test_build_validation_prompt_basic PASSED [ 19%]
tests/unit/test_llm_validator.py::TestLLMValidatorPromptBuilding::test_build_validation_prompt_minimal PASSED [ 19%]
tests/unit/test_llm_validator.py::TestLLMValidatorValidation::test_validate_with_json_response FAILED [ 19%]
tests/unit/test_llm_validator.py::TestLLMValidatorValidation::test_validate_with_critical_issues FAILED [ 19%]
tests/unit/test_llm_validator.py::TestLLMValidatorValidation::test_validate_with_malformed_json FAILED [ 19%]
tests/unit/test_llm_validator.py::TestLLMValidatorValidation::test_validate_llm_failure PASSED [ 19%]
tests/unit/test_llm_validator.py::TestLLMValidatorValidation::test_validate_with_specific_aspects FAILED [ 19%]
tests/unit/test_llm_validator.py::TestLLMValidatorQuickValidate::test_quick_validate_valid_script FAILED [ 19%]
tests/unit/test_llm_validator.py::TestLLMValidatorQuickValidate::test_quick_validate_with_issues FAILED [ 19%]
tests/unit/test_llm_validator.py::TestHybridValidatorInitialization::test_initialization_default PASSED [ 20%]
tests/unit/test_llm_validator.py::TestHybridValidatorInitialization::test_initialization_llm_only PASSED [ 20%]
tests/unit/test_llm_validator.py::TestHybridValidatorInitialization::test_initialization_rules_only PASSED [ 20%]
tests/unit/test_llm_validator.py::TestHybridValidatorValidation::test_hybrid_validation_both_modes FAILED [ 20%]
tests/unit/test_llm_validator.py::TestHybridValidatorValidation::test_hybrid_validation_llm_only_mode FAILED [ 20%]
tests/unit/test_llm_validator.py::TestHybridValidatorValidation::test_hybrid_validation_rules_only_mode PASSED [ 20%]
tests/unit/test_llm_validator.py::TestHybridValidatorValidation::test_hybrid_validation_combines_issues FAILED [ 20%]
tests/unit/test_llm_validator.py::TestValidateScriptConvenienceFunction::test_validate_script_llm_strategy FAILED [ 20%]
tests/unit/test_llm_validator.py::TestValidateScriptConvenienceFunction::test_validate_script_hybrid_strategy FAILED [ 20%]
tests/unit/test_llm_validator.py::TestValidationModes::test_validation_mode_all_aspects FAILED [ 20%]
tests/unit/test_llm_validator.py::TestValidationModes::test_validation_mode_subset_aspects FAILED [ 21%]
tests/unit/test_llm_validator.py::TestValidationModes::test_fallback_to_rules_when_llm_unavailable PASSED [ 21%]
tests/unit/test_logging_config.py::TestSetupLogger::test_basic_logger_creation PASSED [ 21%]
tests/unit/test_logging_config.py::TestSetupLogger::test_logger_with_custom_level PASSED [ 21%]
tests/unit/test_logging_config.py::TestSetupLogger::test_logger_file_creation PASSED [ 21%]
tests/unit/test_logging_config.py::TestSetupLogger::test_structured_logging PASSED [ 21%]
tests/unit/test_logging_config.py::TestSetupLogger::test_logger_singleton PASSED [ 21%]
tests/unit/test_logging_config.py::TestTerminalCapture::test_capture_print_statements PASSED [ 21%]
tests/unit/test_logging_config.py::TestTerminalCapture::test_capture_multiple_writes PASSED [ 21%]
tests/unit/test_logging_config.py::TestSessionLogger::test_session_creation PASSED [ 22%]
tests/unit/test_logging_config.py::TestSessionLogger::test_session_metadata PASSED [ 22%]
tests/unit/test_logging_config.py::TestSessionLogger::test_log_event PASSED [ 22%]
tests/unit/test_logging_config.py::TestSessionLogger::test_log_exception PASSED [ 22%]
tests/unit/test_logging_config.py::TestSessionLogger::test_session_close PASSED [ 22%]
tests/unit/test_logging_config.py::TestCaptureOutput::test_basic_capture PASSED [ 22%]
tests/unit/test_logging_config.py::TestCaptureOutput::test_capture_with_events PASSED [ 22%]
tests/unit/test_logging_config.py::TestCaptureOutput::test_capture_exception_handling PASSED [ 22%]
tests/unit/test_logging_config.py::TestCaptureOutput::test_stream_restoration PASSED [ 22%]
tests/unit/test_logging_config.py::TestCaptureOutput::test_capture_both_stdout_and_stderr PASSED [ 22%]
tests/unit/test_logging_config.py::TestCleanupOldLogs::test_cleanup_old_files PASSED [ 23%]
tests/unit/test_logging_config.py::TestLoggingIntegration::test_complete_workflow PASSED [ 23%]
tests/unit/test_ollama_client.py::TestOllamaClientMocked::test_successful_generation PASSED [ 23%]
tests/unit/test_ollama_client.py::TestOllamaClientMocked::test_connection_error FAILED [ 23%]
tests/unit/test_ollama_client.py::TestOllamaClientMocked::test_timeout_with_retry PASSED [ 23%]
tests/unit/test_ollama_client.py::TestOllamaClientMocked::test_max_retries_exhausted PASSED [ 23%]
tests/unit/test_ollama_client.py::TestOllamaClientMocked::test_http_error_no_retry PASSED [ 23%]
tests/unit/test_ollama_client.py::TestOllamaClientMocked::test_empty_response_handling PASSED [ 23%]
tests/unit/test_ollama_client.py::TestOllamaClientMocked::test_model_unloading PASSED [ 23%]
tests/unit/test_ollama_client.py::TestOllamaClientMocked::test_check_connection_server_only PASSED [ 24%]
tests/unit/test_ollama_client.py::TestOllamaClientMocked::test_check_connection_with_model PASSED [ 24%]
tests/unit/test_ollama_client.py::TestOllamaClientMocked::test_custom_options PASSED [ 24%]
tests/unit/test_ollama_client.py::TestMockOllamaClient::test_basic_generation PASSED [ 24%]
tests/unit/test_ollama_client.py::TestMockOllamaClient::test_preconfigured_responses PASSED [ 24%]
tests/unit/test_ollama_client.py::TestMockOllamaClient::test_partial_match PASSED [ 24%]
tests/unit/test_ollama_client.py::TestMockOllamaClient::test_smart_weather_response PASSED [ 24%]
tests/unit/test_ollama_client.py::TestMockOllamaClient::test_smart_news_response PASSED [ 24%]
tests/unit/test_ollama_client.py::TestMockOllamaClient::test_call_tracking PASSED [ 24%]
tests/unit/test_ollama_client.py::TestMockOllamaClient::test_model_unloading PASSED [ 24%]
tests/unit/test_ollama_client.py::TestMockOllamaClient::test_connection_check PASSED [ 25%]
tests/unit/test_ollama_client.py::TestMockOllamaClient::test_simulated_failure PASSED [ 25%]
tests/unit/test_ollama_client.py::TestMockOllamaClient::test_simulated_connection_error PASSED [ 25%]
tests/unit/test_ollama_client.py::TestMockOllamaClient::test_reset PASSED [ 25%]
tests/unit/test_ollama_client.py::TestMockOllamaScenarios::test_broadcast_scenario PASSED [ 25%]
tests/unit/test_ollama_client.py::TestMockOllamaScenarios::test_flaky_scenario PASSED [ 25%]
tests/unit/test_ollama_client.py::TestMockOllamaScenarios::test_no_connection_scenario PASSED [ 25%]
tests/unit/test_ollama_client.py::TestOllamaClientCompatibility::test_interface_compatibility PASSED [ 25%]
tests/unit/test_ollama_client.py::TestOllamaClientCompatibility::test_generate_signature_compatibility PASSED [ 25%]
tests/unit/test_personality_loader.py::TestDJFolderMap::test_folder_map_contains_all_djs PASSED [ 26%]
tests/unit/test_personality_loader.py::TestDJFolderMap::test_folder_map_correct_mappings PASSED [ 26%]
tests/unit/test_personality_loader.py::TestDJFolderMap::test_folder_map_size PASSED [ 26%]
tests/unit/test_personality_loader.py::TestGetAvailableDJs::test_returns_list PASSED [ 26%]
tests/unit/test_personality_loader.py::TestGetAvailableDJs::test_returns_all_djs PASSED [ 26%]
tests/unit/test_personality_loader.py::TestGetAvailableDJs::test_returns_correct_count PASSED [ 26%]
tests/unit/test_personality_loader.py::TestClearCache::test_clear_cache_empties_cache PASSED [ 26%]
tests/unit/test_personality_loader.py::TestClearCache::test_clear_cache_on_empty_cache PASSED [ 26%]
tests/unit/test_personality_loader.py::TestLoadPersonalitySuccess::test_load_julie_personality PASSED [ 26%]
tests/unit/test_personality_loader.py::TestLoadPersonalitySuccess::test_load_mr_new_vegas_personality PASSED [ 26%]
tests/unit/test_personality_loader.py::TestLoadPersonalitySuccess::test_load_travis_nervous_personality PASSED [ 27%]
tests/unit/test_personality_loader.py::TestLoadPersonalitySuccess::test_load_travis_confident_personality PASSED [ 27%]
tests/unit/test_personality_loader.py::TestLoadPersonalitySuccess::test_personality_has_required_fields PASSED [ 27%]
tests/unit/test_personality_loader.py::TestLoadPersonalitySuccess::test_personality_structure PASSED [ 27%]
tests/unit/test_personality_loader.py::TestLoadPersonalitySuccess::test_load_with_custom_project_root PASSED [ 27%]
tests/unit/test_personality_loader.py::TestLoadPersonalityErrorHandling::test_load_unknown_dj_raises_value_error PASSED [ 27%]
tests/unit/test_personality_loader.py::TestLoadPersonalityErrorHandling::test_unknown_dj_error_message_includes_available_djs PASSED [ 27%]
tests/unit/test_personality_loader.py::TestLoadPersonalityErrorHandling::test_missing_character_card_raises_file_not_found PASSED [ 27%]
tests/unit/test_personality_loader.py::TestLoadPersonalityErrorHandling::test_invalid_json_raises_json_decode_error PASSED [ 27%]
tests/unit/test_personality_loader.py::TestLoadPersonalityErrorHandling::test_missing_required_field_name_raises_value_error PASSED [ 28%]
tests/unit/test_personality_loader.py::TestLoadPersonalityErrorHandling::test_missing_required_field_system_prompt_raises_value_error PASSED [ 28%]
tests/unit/test_personality_loader.py::TestLoadPersonalityErrorHandling::test_missing_both_required_fields_raises_value_error PASSED [ 28%]
tests/unit/test_personality_loader.py::TestPersonalityCaching::test_personality_cached_after_first_load PASSED [ 28%]
tests/unit/test_personality_loader.py::TestPersonalityCaching::test_second_load_uses_cache PASSED [ 28%]
tests/unit/test_personality_loader.py::TestPersonalityCaching::test_multiple_djs_cached_separately PASSED [ 28%]
tests/unit/test_personality_loader.py::TestPersonalityCaching::test_clear_cache_forces_reload PASSED [ 28%]
tests/unit/test_personality_loader.py::TestPersonalityCaching::test_cache_survives_multiple_loads PASSED [ 28%]
tests/unit/test_personality_loader.py::TestPersonalityContent::test_julie_personality_content PASSED [ 28%]
tests/unit/test_personality_loader.py::TestPersonalityContent::test_mr_new_vegas_personality_content PASSED [ 28%]
tests/unit/test_personality_loader.py::TestPersonalityContent::test_personality_system_prompt_is_string PASSED [ 29%]
tests/unit/test_personality_loader.py::TestPersonalityContent::test_personality_name_is_string PASSED [ 29%]
tests/unit/test_personality_loader.py::TestPersonalityContent::test_catchphrases_if_present_is_list PASSED [ 29%]
tests/unit/test_personality_loader.py::TestPersonalityContent::test_examples_if_present_is_list PASSED [ 29%]
tests/unit/test_personality_loader.py::TestPersonalityContent::test_voice_if_present_is_dict PASSED [ 29%]
tests/unit/test_personality_loader.py::TestPersonalityContent::test_do_list_if_present PASSED [ 29%]
tests/unit/test_personality_loader.py::TestPersonalityContent::test_dont_list_if_present PASSED [ 29%]
tests/unit/test_personality_loader.py::TestPersonalityLoaderIntegration::test_load_all_available_djs PASSED [ 29%]
tests/unit/test_personality_loader.py::TestPersonalityLoaderIntegration::test_load_same_dj_multiple_times PASSED [ 29%]
tests/unit/test_personality_loader.py::TestPersonalityLoaderIntegration::test_load_different_djs_are_different PASSED [ 30%]
tests/unit/test_personality_loader.py::TestPersonalityLoaderIntegration::test_complete_workflow PASSED [ 30%]
tests/unit/test_personality_loader.py::TestPersonalityLoaderEdgeCases::test_empty_personality_with_required_fields PASSED [ 30%]
tests/unit/test_personality_loader.py::TestPersonalityLoaderEdgeCases::test_personality_with_extra_fields PASSED [ 30%]
tests/unit/test_personality_loader.py::TestPersonalityLoaderEdgeCases::test_unicode_content_in_personality PASSED [ 30%]
tests/unit/test_regional_climate.py::TestRegionEnum::test_region_enum_values PASSED [ 30%]
tests/unit/test_regional_climate.py::TestRegionEnum::test_region_enum_membership PASSED [ 30%]
tests/unit/test_regional_climate.py::TestRegionEnum::test_region_enum_count PASSED [ 30%]
tests/unit/test_regional_climate.py::TestRegionalClimateDataclass::test_regional_climate_creation PASSED [ 30%]
tests/unit/test_regional_climate.py::TestRegionalClimateDataclass::test_regional_climate_defaults PASSED [ 30%]
tests/unit/test_regional_climate.py::TestRegionalClimateDataclass::test_regional_climate_temperature_range_format PASSED [ 31%]
tests/unit/test_regional_climate.py::TestAppalachiaClimate::test_appalachia_region_name PASSED [ 31%]
tests/unit/test_regional_climate.py::TestAppalachiaClimate::test_appalachia_temperature_range PASSED [ 31%]
tests/unit/test_regional_climate.py::TestAppalachiaClimate::test_appalachia_precipitation_frequency PASSED [ 31%]
tests/unit/test_regional_climate.py::TestAppalachiaClimate::test_appalachia_special_conditions PASSED [ 31%]
tests/unit/test_regional_climate.py::TestAppalachiaClimate::test_appalachia_post_apocalyptic_modifiers PASSED [ 31%]
tests/unit/test_regional_climate.py::TestAppalachiaClimate::test_appalachia_seasonal_patterns PASSED [ 31%]
tests/unit/test_regional_climate.py::TestAppalachiaClimate::test_appalachia_winter_season PASSED [ 31%]
tests/unit/test_regional_climate.py::TestAppalachiaClimate::test_appalachia_summer_season PASSED [ 31%]
tests/unit/test_regional_climate.py::TestAppalachiaClimate::test_appalachia_transition_matrix PASSED [ 32%]
tests/unit/test_regional_climate.py::TestAppalachiaClimate::test_appalachia_weather_durations PASSED [ 32%]
tests/unit/test_regional_climate.py::TestMojaveClimate::test_mojave_region_name PASSED [ 32%]
tests/unit/test_regional_climate.py::TestMojaveClimate::test_mojave_temperature_range PASSED [ 32%]
tests/unit/test_regional_climate.py::TestMojaveClimate::test_mojave_precipitation_frequency PASSED [ 32%]
tests/unit/test_regional_climate.py::TestMojaveClimate::test_mojave_special_conditions PASSED [ 32%]
tests/unit/test_regional_climate.py::TestMojaveClimate::test_mojave_post_apocalyptic_modifiers PASSED [ 32%]
tests/unit/test_regional_climate.py::TestMojaveClimate::test_mojave_seasonal_patterns PASSED [ 32%]
tests/unit/test_regional_climate.py::TestMojaveClimate::test_mojave_transition_matrix PASSED [ 32%]
tests/unit/test_regional_climate.py::TestMojaveClimate::test_mojave_weather_durations PASSED [ 32%]
tests/unit/test_regional_climate.py::TestCommonwealthClimate::test_commonwealth_region_name PASSED [ 33%]
tests/unit/test_regional_climate.py::TestCommonwealthClimate::test_commonwealth_temperature_range PASSED [ 33%]
tests/unit/test_regional_climate.py::TestCommonwealthClimate::test_commonwealth_precipitation_frequency PASSED [ 33%]
tests/unit/test_regional_climate.py::TestCommonwealthClimate::test_commonwealth_special_conditions PASSED [ 33%]
tests/unit/test_regional_climate.py::TestCommonwealthClimate::test_commonwealth_post_apocalyptic_modifiers PASSED [ 33%]
tests/unit/test_regional_climate.py::TestCommonwealthClimate::test_commonwealth_seasonal_patterns PASSED [ 33%]
tests/unit/test_regional_climate.py::TestCommonwealthClimate::test_commonwealth_transition_matrix PASSED [ 33%]
tests/unit/test_regional_climate.py::TestCommonwealthClimate::test_commonwealth_weather_durations PASSED [ 33%]
tests/unit/test_regional_climate.py::TestRegionalClimateRegistry::test_registry_contains_all_regions PASSED [ 33%]
tests/unit/test_regional_climate.py::TestRegionalClimateRegistry::test_registry_correct_mappings PASSED [ 34%]
tests/unit/test_regional_climate.py::TestRegionalClimateRegistry::test_registry_size PASSED [ 34%]
tests/unit/test_regional_climate.py::TestGetRegionFromDjName::test_julie_maps_to_appalachia PASSED [ 34%]
tests/unit/test_regional_climate.py::TestGetRegionFromDjName::test_appalachia_keyword_maps_to_appalachia PASSED [ 34%]
tests/unit/test_regional_climate.py::TestGetRegionFromDjName::test_mr_new_vegas_maps_to_mojave PASSED [ 34%]
tests/unit/test_regional_climate.py::TestGetRegionFromDjName::test_mojave_keyword_maps_to_mojave PASSED [ 34%]
tests/unit/test_regional_climate.py::TestGetRegionFromDjName::test_new_vegas_keyword_maps_to_mojave PASSED [ 34%]
tests/unit/test_regional_climate.py::TestGetRegionFromDjName::test_travis_maps_to_commonwealth PASSED [ 34%]
tests/unit/test_regional_climate.py::TestGetRegionFromDjName::test_commonwealth_keyword_maps_to_commonwealth PASSED [ 34%]
tests/unit/test_regional_climate.py::TestGetRegionFromDjName::test_unknown_dj_defaults_to_appalachia PASSED [ 34%]
tests/unit/test_regional_climate.py::TestGetRegionFromDjName::test_case_insensitive_matching PASSED [ 35%]
tests/unit/test_regional_climate.py::TestGetClimateForRegion::test_get_appalachia_climate PASSED [ 35%]
tests/unit/test_regional_climate.py::TestGetClimateForRegion::test_get_mojave_climate PASSED [ 35%]
tests/unit/test_regional_climate.py::TestGetClimateForRegion::test_get_commonwealth_climate PASSED [ 35%]
tests/unit/test_regional_climate.py::TestGetClimateForRegion::test_returns_regional_climate_instance PASSED [ 35%]
tests/unit/test_regional_climate.py::TestGetSeasonFromMonth::test_winter_months PASSED [ 35%]
tests/unit/test_regional_climate.py::TestGetSeasonFromMonth::test_spring_months PASSED [ 35%]
tests/unit/test_regional_climate.py::TestGetSeasonFromMonth::test_summer_months PASSED [ 35%]
tests/unit/test_regional_climate.py::TestGetSeasonFromMonth::test_fall_months PASSED [ 35%]
tests/unit/test_regional_climate.py::TestGetSeasonFromMonth::test_seasons_same_for_all_regions PASSED [ 36%]
tests/unit/test_regional_climate.py::TestClimateComparisons::test_mojave_driest_climate PASSED [ 36%]
tests/unit/test_regional_climate.py::TestClimateComparisons::test_appalachia_most_humid PASSED [ 36%]
tests/unit/test_regional_climate.py::TestClimateComparisons::test_mojave_widest_temperature_range PASSED [ 36%]
tests/unit/test_regional_climate.py::TestClimateComparisons::test_commonwealth_coldest_minimum PASSED [ 36%]
tests/unit/test_regional_climate.py::TestClimateComparisons::test_mojave_hottest_maximum PASSED [ 36%]
tests/unit/test_regional_climate.py::TestClimateComparisons::test_each_region_has_unique_special_conditions PASSED [ 36%]
tests/unit/test_regional_climate.py::TestClimateDataIntegrity::test_all_climates_have_required_fields PASSED [ 36%]
tests/unit/test_regional_climate.py::TestClimateDataIntegrity::test_precipitation_frequencies_valid PASSED [ 36%]
tests/unit/test_regional_climate.py::TestClimateDataIntegrity::test_temperature_ranges_valid PASSED [ 36%]
tests/unit/test_regional_climate.py::TestClimateDataIntegrity::test_transition_probabilities_sum_to_one PASSED [ 37%]
tests/unit/test_regional_climate.py::TestClimateDataIntegrity::test_weather_durations_valid PASSED [ 37%]
tests/unit/test_regional_climate.py::TestClimateDataIntegrity::test_all_seasonal_patterns_have_four_seasons PASSED [ 37%]
tests/unit/test_session_memory.py::TestScriptEntry::test_script_entry_creation PASSED [ 37%]
tests/unit/test_session_memory.py::TestSessionMemoryInitialization::test_initialization_defaults PASSED [ 37%]
tests/unit/test_session_memory.py::TestSessionMemoryInitialization::test_initialization_with_params PASSED [ 37%]
tests/unit/test_session_memory.py::TestSessionMemoryInitialization::test_session_start_timestamp PASSED [ 37%]
tests/unit/test_session_memory.py::TestSessionMemoryAddScript::test_add_simple_script PASSED [ 37%]
tests/unit/test_session_memory.py::TestSessionMemoryAddScript::test_add_script_with_metadata PASSED [ 37%]
tests/unit/test_session_memory.py::TestSessionMemoryAddScript::test_add_script_with_catchphrases PASSED [ 38%]
tests/unit/test_session_memory.py::TestSessionMemoryAddScript::test_add_multiple_scripts PASSED [ 38%]
tests/unit/test_session_memory.py::TestSessionMemoryAddScript::test_max_history_enforcement PASSED [ 38%]
tests/unit/test_session_memory.py::TestSessionMemoryAddScript::test_catchphrase_history_limit PASSED [ 38%]
tests/unit/test_session_memory.py::TestSessionMemoryAddScript::test_timestamp_auto_generated PASSED [ 38%]
tests/unit/test_session_memory.py::TestSessionMemoryTopicExtraction::test_extract_raiders_topic PASSED [ 38%]
tests/unit/test_session_memory.py::TestSessionMemoryTopicExtraction::test_extract_vault_topic PASSED [ 38%]
tests/unit/test_session_memory.py::TestSessionMemoryTopicExtraction::test_topic_count_increments PASSED [ 38%]
tests/unit/test_session_memory.py::TestSessionMemoryTopicExtraction::test_multiple_topics_in_one_script PASSED [ 38%]
tests/unit/test_session_memory.py::TestSessionMemoryTopicExtraction::test_get_mentioned_topics PASSED [ 38%]
tests/unit/test_session_memory.py::TestSessionMemoryContextGeneration::test_get_context_empty_memory PASSED [ 39%]
tests/unit/test_session_memory.py::TestSessionMemoryContextGeneration::test_get_context_with_scripts PASSED [ 39%]
tests/unit/test_session_memory.py::TestSessionMemoryContextGeneration::test_get_context_limits_recent PASSED [ 39%]
tests/unit/test_session_memory.py::TestSessionMemoryContextGeneration::test_get_context_includes_segment_count PASSED [ 39%]
tests/unit/test_session_memory.py::TestSessionMemoryContextGeneration::test_get_context_truncates_long_content PASSED [ 39%]
tests/unit/test_session_memory.py::TestSessionMemoryCatchphrases::test_get_recent_catchphrases_empty PASSED [ 39%]
tests/unit/test_session_memory.py::TestSessionMemoryCatchphrases::test_get_recent_catchphrases PASSED [ 39%]
tests/unit/test_session_memory.py::TestSessionMemoryCatchphrases::test_get_recent_catchphrases_limits_count PASSED [ 39%]
tests/unit/test_session_memory.py::TestSessionMemoryWeatherContinuity::test_get_weather_continuity_no_history PASSED [ 39%]
tests/unit/test_session_memory.py::TestSessionMemoryWeatherContinuity::test_get_weather_continuity_same_weather PASSED [ 40%]
tests/unit/test_session_memory.py::TestSessionMemoryWeatherContinuity::test_get_weather_continuity_changed PASSED [ 40%]
tests/unit/test_session_memory.py::TestSessionMemoryWeatherContinuity::test_weather_continuity_phrase_generation PASSED [ 40%]
tests/unit/test_session_memory.py::TestSessionMemoryWeatherContinuity::test_has_notable_history PASSED [ 40%]
tests/unit/test_session_memory.py::TestSessionMemoryStoryBeats::test_add_story_beat PASSED [ 40%]
tests/unit/test_session_memory.py::TestSessionMemoryStoryBeats::test_story_beat_max_limit PASSED [ 40%]
tests/unit/test_session_memory.py::TestSessionMemoryStoryBeats::test_get_recent_story_beats PASSED [ 40%]
tests/unit/test_session_memory.py::TestSessionMemoryPersistence::test_to_dict PASSED [ 40%]
tests/unit/test_session_memory.py::TestSessionMemoryPersistence::test_from_dict PASSED [ 40%]
tests/unit/test_session_memory.py::TestSessionMemoryPersistence::test_round_trip_serialization PASSED [ 40%]
tests/unit/test_session_memory.py::TestSessionMemoryReset::test_reset_clears_all_data PASSED [ 41%]
tests/unit/test_session_memory.py::TestSessionMemoryReset::test_reset_updates_session_start PASSED [ 41%]
tests/unit/test_weather_simulator.py::TestWeatherState::test_weather_state_creation PASSED [ 41%]
tests/unit/test_weather_simulator.py::TestWeatherState::test_weather_state_to_dict PASSED [ 41%]
tests/unit/test_weather_simulator.py::TestWeatherState::test_weather_state_from_dict PASSED [ 41%]
tests/unit/test_weather_simulator.py::TestWeatherState::test_weather_state_emergency_types PASSED [ 41%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorInitialization::test_initialization_without_seed PASSED [ 41%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorInitialization::test_initialization_with_seed PASSED [ 41%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorInitialization::test_seed_produces_reproducible_results PASSED [ 41%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorCalendarGeneration::test_generate_yearly_calendar_returns_365_days PASSED [ 42%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorCalendarGeneration::test_calendar_has_four_time_slots_per_day PASSED [ 42%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorCalendarGeneration::test_calendar_entries_are_weather_states PASSED [ 42%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorCalendarGeneration::test_calendar_dates_sequential PASSED [ 42%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorCalendarGeneration::test_calendar_cached PASSED [ 42%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorCalendarGeneration::test_different_regions_different_weather PASSED [ 42%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorCurrentWeather::test_get_current_weather_from_calendar PASSED [ 42%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorCurrentWeather::test_get_current_weather_time_slot_mapping PASSED [ 42%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorCurrentWeather::test_get_current_weather_auto_generates_calendar PASSED [ 42%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorCurrentWeather::test_get_current_weather_missing_date PASSED [ 42%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorWeatherGeneration::test_initial_weather_selection_appalachia PASSED [ 43%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorWeatherGeneration::test_initial_weather_selection_mojave PASSED [ 43%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorWeatherGeneration::test_weather_has_temperature PASSED [ 43%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorWeatherGeneration::test_weather_has_duration PASSED [ 43%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorWeatherGeneration::test_weather_has_intensity PASSED [ 43%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorClimateConsistency::test_mojave_has_more_sunny_days PASSED [ 43%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorClimateConsistency::test_appalachia_has_varied_weather PASSED [ 43%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorClimateConsistency::test_temperature_varies_by_season PASSED [ 43%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorClimateConsistency::test_mojave_has_extreme_temperatures PASSED [ 43%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorRadiationStorms::test_rad_storms_are_emergency PASSED [ 44%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorRadiationStorms::test_rad_storms_are_notable_events PASSED [ 44%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorRadiationStorms::test_appalachia_has_more_rad_storms_than_mojave PASSED [ 44%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorWeatherTransitions::test_weather_transitions_are_logical PASSED [ 44%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorWeatherTransitions::test_rainy_weather_has_reasonable_duration PASSED [ 44%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorEdgeCases::test_calendar_for_leap_year PASSED [ 44%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorEdgeCases::test_multiple_regions_independent PASSED [ 44%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorEdgeCases::test_notable_events_flagged PASSED [ 44%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorIntegration::test_complete_weather_workflow PASSED [ 44%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorIntegration::test_multi_region_simulation PASSED [ 44%]
tests/unit/test_weather_simulator.py::TestWeatherSimulatorIntegration::test_serialization_round_trip PASSED [ 45%]
tests/unit/test_world_state.py::TestWorldStateInitialization::test_initialization_default PASSED [ 45%]
tests/unit/test_world_state.py::TestWorldStateInitialization::test_initialization_creates_parent_dir PASSED [ 45%]
tests/unit/test_world_state.py::TestWorldStateInitialization::test_initialization_weather_state PASSED [ 45%]
tests/unit/test_world_state.py::TestWorldStateInitialization::test_creation_date_set PASSED [ 45%]
tests/unit/test_world_state.py::TestWorldStateStorylines::test_add_storyline PASSED [ 45%]
tests/unit/test_world_state.py::TestWorldStateStorylines::test_storyline_id_generation PASSED [ 45%]
tests/unit/test_world_state.py::TestWorldStateStorylines::test_storyline_created_date PASSED [ 45%]
tests/unit/test_world_state.py::TestWorldStateStorylines::test_continue_storyline PASSED [ 45%]
tests/unit/test_world_state.py::TestWorldStateStorylines::test_continue_nonexistent_storyline PASSED [ 46%]
tests/unit/test_world_state.py::TestWorldStateStorylines::test_resolve_storyline PASSED [ 46%]
tests/unit/test_world_state.py::TestWorldStateStorylines::test_resolve_nonexistent_storyline PASSED [ 46%]
tests/unit/test_world_state.py::TestWorldStateStorylines::test_get_storylines_for_context PASSED [ 46%]
tests/unit/test_world_state.py::TestWorldStateStorylines::test_get_storylines_empty PASSED [ 46%]
tests/unit/test_world_state.py::TestWorldStateMajorEvents::test_add_major_event PASSED [ 46%]
tests/unit/test_world_state.py::TestWorldStateMajorEvents::test_major_event_id_generation PASSED [ 46%]
tests/unit/test_world_state.py::TestWorldStateMajorEvents::test_major_event_without_factions PASSED [ 46%]
tests/unit/test_world_state.py::TestWorldStateBroadcastStats::test_update_broadcast_stats PASSED [ 46%]
tests/unit/test_world_state.py::TestWorldStateBroadcastStats::test_update_broadcast_stats_accumulates PASSED [ 46%]
tests/unit/test_world_state.py::TestWorldStateBroadcastStats::test_last_broadcast_timestamp PASSED [ 47%]
tests/unit/test_world_state.py::TestWorldStateWeatherSystem::test_get_current_weather_none PASSED [ 47%]
tests/unit/test_world_state.py::TestWorldStateWeatherSystem::test_update_weather_state PASSED [ 47%]
tests/unit/test_world_state.py::TestWorldStateWeatherSystem::test_manual_weather_override PASSED [ 47%]
tests/unit/test_world_state.py::TestWorldStateWeatherSystem::test_clear_manual_override PASSED [ 47%]
tests/unit/test_world_state.py::TestWorldStateWeatherSystem::test_log_weather_history PASSED [ 47%]
tests/unit/test_world_state.py::TestWorldStateWeatherSystem::test_get_weather_history PASSED [ 47%]
tests/unit/test_world_state.py::TestWorldStateWeatherSystem::test_get_weather_history_with_date_filter PASSED [ 47%]
tests/unit/test_world_state.py::TestWorldStateWeatherSystem::test_get_notable_weather_events PASSED [ 47%]
tests/unit/test_world_state.py::TestWorldStateWeatherSystem::test_get_calendar_for_region PASSED [ 48%]
tests/unit/test_world_state.py::TestWorldStatePersistence::test_save_creates_file PASSED [ 48%]
tests/unit/test_world_state.py::TestWorldStatePersistence::test_save_valid_json PASSED [ 48%]
tests/unit/test_world_state.py::TestWorldStatePersistence::test_save_contains_all_fields PASSED [ 48%]
tests/unit/test_world_state.py::TestWorldStatePersistence::test_load_nonexistent_file PASSED [ 48%]
tests/unit/test_world_state.py::TestWorldStatePersistence::test_load_existing_file PASSED [ 48%]
tests/unit/test_world_state.py::TestWorldStatePersistence::test_load_corrupted_json PASSED [ 48%]
tests/unit/test_world_state.py::TestWorldStatePersistence::test_round_trip_persistence PASSED [ 48%]
tests/unit/test_world_state.py::TestWorldStateSerialization::test_to_dict_complete PASSED [ 48%]
tests/unit/test_world_state.py::TestWorldStateSerialization::test_to_dict_matches_save_format PASSED [ 48%]
tests/unit/test_world_state.py::TestWorldStateIntegration::test_complete_storyline_workflow PASSED [ 49%]
tests/unit/test_world_state.py::TestWorldStateIntegration::test_weather_tracking_workflow PASSED [ 49%]
tests/unit/test_world_state.py::TestWorldStateIntegration::test_persistence_across_instances PASSED [ 49%]
tools/wiki_to_chromadb/tests/integration/test_full_pipeline.py::TestFullPipeline::test_vault_101_full_pipeline PASSED [ 49%]
tools/wiki_to_chromadb/tests/integration/test_full_pipeline.py::TestFullPipeline::test_ncr_full_pipeline PASSED [ 49%]
tools/wiki_to_chromadb/tests/integration/test_full_pipeline.py::TestFullPipeline::test_multi_page_pipeline PASSED [ 49%]
tools/wiki_to_chromadb/tests/integration/test_full_pipeline.py::TestChromaDBQueries::test_query_by_location PASSED [ 49%]
tools/wiki_to_chromadb/tests/integration/test_full_pipeline.py::TestChromaDBQueries::test_query_by_content_type PASSED [ 49%]
tools/wiki_to_chromadb/tests/integration/test_full_pipeline.py::TestChromaDBQueries::test_query_pre_war_content PASSED [ 49%]
tools/wiki_to_chromadb/tests/integration/test_full_pipeline.py::TestChromaDBQueries::test_query_post_war_content PASSED [ 50%]
tools/wiki_to_chromadb/tests/integration/test_full_pipeline.py::TestMetadataPreservation::test_structural_metadata_preserved PASSED [ 50%]
tools/wiki_to_chromadb/tests/integration/test_full_pipeline.py::TestMetadataPreservation::test_enrichment_metadata_added PASSED [ 50%]
tools/wiki_to_chromadb/tests/integration/test_full_pipeline.py::TestMetadataPreservation::test_chunk_metadata_complete PASSED [ 50%]
tools/wiki_to_chromadb/tests/integration/test_full_pipeline.py::TestPipelineEdgeCases::test_empty_page PASSED [ 50%]
tools/wiki_to_chromadb/tests/integration/test_full_pipeline.py::TestPipelineEdgeCases::test_redirect_page PASSED [ 50%]
tools/wiki_to_chromadb/tests/integration/test_full_pipeline.py::TestPipelineEdgeCases::test_very_short_page PASSED [ 50%]
tools/wiki_to_chromadb/tests/integration/test_full_pipeline.py::TestPipelineEdgeCases::test_page_without_categories PASSED [ 50%]
tools/wiki_to_chromadb/tests/integration/test_full_pipeline.py::TestPipelinePerformance::test_processing_speed PASSED [ 50%]
tools/wiki_to_chromadb/tests/integration/test_full_pipeline.py::TestPipelinePerformance::test_memory_efficiency PASSED [ 50%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestEmotionalToneClassification::test_hopeful_tone PASSED [ 51%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestEmotionalToneClassification::test_tragic_tone PASSED [ 51%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestEmotionalToneClassification::test_mysterious_tone PASSED [ 51%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestEmotionalToneClassification::test_tense_tone PASSED [ 51%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestEmotionalToneClassification::test_neutral_tone PASSED [ 51%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestEmotionalToneClassification::test_requires_multiple_keywords PASSED [ 51%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestComplexityTierClassification::test_simple_tier_short_text PASSED [ 51%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestComplexityTierClassification::test_complex_tier_long_text FAILED [ 51%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestComplexityTierClassification::test_moderate_tier FAILED [ 51%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestPrimarySubjectExtraction::test_extract_water_subject PASSED [ 52%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestPrimarySubjectExtraction::test_extract_radiation_subject PASSED [ 52%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestPrimarySubjectExtraction::test_extract_multiple_subjects PASSED [ 52%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestPrimarySubjectExtraction::test_limit_to_five_subjects PASSED [ 52%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestPrimarySubjectExtraction::test_no_subjects PASSED [ 52%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestThemeExtraction::test_extract_humanity_theme PASSED [ 52%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestThemeExtraction::test_extract_war_theme PASSED [ 52%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestThemeExtraction::test_extract_survival_theme PASSED [ 52%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestThemeExtraction::test_content_type_boosting PASSED [ 52%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestThemeExtraction::test_limit_to_three_themes PASSED [ 52%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestControversyLevelDetection::test_controversial_content PASSED [ 53%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestControversyLevelDetection::test_sensitive_content PASSED [ 53%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestControversyLevelDetection::test_neutral_content PASSED [ 53%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestBroadcastMetadataIntegration::test_enrich_chunk_with_broadcast_metadata PASSED [ 53%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestBroadcastMetadataIntegration::test_enriched_metadata_values PASSED [ 53%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestModelFlattening::test_flatten_primary_subjects PASSED [ 53%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestModelFlattening::test_flatten_themes PASSED [ 53%]
tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestModelFlattening::test_flatten_broadcast_fields PASSED [ 53%]
tools/wiki_to_chromadb/tests/unit/test_chunker_v2.py::TestMarkupStripping::test_strip_wikilinks PASSED [ 53%]
tools/wiki_to_chromadb/tests/unit/test_chunker_v2.py::TestMarkupStripping::test_strip_categories PASSED [ 54%]
tools/wiki_to_chromadb/tests/unit/test_chunker_v2.py::TestMarkupStripping::test_strip_images PASSED [ 54%]
tools/wiki_to_chromadb/tests/unit/test_chunker_v2.py::TestTokenSplitting::test_split_short_text PASSED [ 54%]
tools/wiki_to_chromadb/tests/unit/test_chunker_v2.py::TestTokenSplitting::test_split_long_text PASSED [ 54%]
tools/wiki_to_chromadb/tests/unit/test_chunker_v2.py::TestTokenSplitting::test_overlap_preservation PASSED [ 54%]
tools/wiki_to_chromadb/tests/unit/test_chunker_v2.py::TestChunkCreation::test_create_chunks_single_section PASSED [ 54%]
tools/wiki_to_chromadb/tests/unit/test_chunker_v2.py::TestChunkCreation::test_create_chunks_multiple_sections PASSED [ 54%]
tools/wiki_to_chromadb/tests/unit/test_chunker_v2.py::TestChunkCreation::test_chunk_metadata_completeness PASSED [ 54%]
tools/wiki_to_chromadb/tests/unit/test_chunker_v2.py::TestChunkCreation::test_chunk_text_cleaned PASSED [ 54%]
tools/wiki_to_chromadb/tests/unit/test_chunker_v2.py::TestChunkIndexing::test_chunk_indices_sequential PASSED [ 54%]
tools/wiki_to_chromadb/tests/unit/test_chunker_v2.py::TestChunkIndexing::test_total_chunks_consistent PASSED [ 55%]
tools/wiki_to_chromadb/tests/unit/test_extractors.py::TestCategoryExtraction::test_extract_multiple_categories PASSED [ 55%]
tools/wiki_to_chromadb/tests/unit/test_extractors.py::TestCategoryExtraction::test_extract_single_category PASSED [ 55%]
tools/wiki_to_chromadb/tests/unit/test_extractors.py::TestCategoryExtraction::test_no_categories PASSED [ 55%]
tools/wiki_to_chromadb/tests/unit/test_extractors.py::TestWikilinkExtraction::test_extract_wikilinks PASSED [ 55%]
tools/wiki_to_chromadb/tests/unit/test_extractors.py::TestWikilinkExtraction::test_wikilink_types PASSED [ 55%]
tools/wiki_to_chromadb/tests/unit/test_extractors.py::TestWikilinkExtraction::test_piped_links PASSED [ 55%]
tools/wiki_to_chromadb/tests/unit/test_extractors.py::TestSectionExtraction::test_extract_sections PASSED [ 55%]
tools/wiki_to_chromadb/tests/unit/test_extractors.py::TestSectionExtraction::test_section_levels PASSED [ 55%]
tools/wiki_to_chromadb/tests/unit/test_extractors.py::TestSectionExtraction::test_section_path_building PASSED [ 56%]
tools/wiki_to_chromadb/tests/unit/test_extractors.py::TestTemplateExtraction::test_extract_infobox PASSED [ 56%]
tools/wiki_to_chromadb/tests/unit/test_extractors.py::TestTemplateExtraction::test_extract_game_template PASSED [ 56%]
tools/wiki_to_chromadb/tests/unit/test_extractors.py::TestTemplateExtraction::test_game_references PASSED [ 56%]
tools/wiki_to_chromadb/tests/unit/test_extractors.py::TestTemplateExtraction::test_multiple_games PASSED [ 56%]
tools/wiki_to_chromadb/tests/unit/test_extractors.py::TestCompleteExtraction::test_extract_all PASSED [ 56%]
tools/wiki_to_chromadb/tests/unit/test_extractors.py::TestCompleteExtraction::test_extract_all_simple PASSED [ 56%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestTimeClassification::test_pre_war_classification PASSED [ 56%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestTimeClassification::test_post_war_classification PASSED [ 56%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestTimeClassification::test_unknown_time_period PASSED [ 56%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestTimeClassification::test_year_extraction_explicit PASSED [ 57%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestTimeClassification::test_year_extraction_decade PASSED [ 57%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestTimeClassification::test_year_extraction_century PASSED [ 57%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestTimeClassification::test_no_years_found PASSED [ 57%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestLocationClassification::test_west_coast_classification PASSED [ 57%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestLocationClassification::test_capital_wasteland_classification PASSED [ 57%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestLocationClassification::test_general_location_default PASSED [ 57%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestContentTypeClassification::test_character_classification PASSED [ 57%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestContentTypeClassification::test_location_classification PASSED [ 57%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestContentTypeClassification::test_faction_classification PASSED [ 58%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestContentTypeClassification::test_item_classification PASSED [ 58%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestContentTypeClassification::test_lore_default PASSED [ 58%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestKnowledgeTier::test_classified_tier PASSED [ 58%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestKnowledgeTier::test_restricted_tier PASSED [ 58%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestKnowledgeTier::test_regional_tier PASSED [ 58%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestKnowledgeTier::test_common_tier PASSED [ 58%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestInfoSource::test_vault_tec_source PASSED [ 58%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestInfoSource::test_military_source PASSED [ 58%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestInfoSource::test_corporate_source PASSED [ 58%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestInfoSource::test_public_source PASSED [ 59%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestEnrichmentIntegration::test_enrich_dict_chunk PASSED [ 59%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestEnrichmentIntegration::test_enrich_pydantic_chunk PASSED [ 59%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestEnrichmentIntegration::test_enrich_multiple_chunks PASSED [ 59%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestEnrichmentIntegration::test_chunk_quality_stub PASSED [ 59%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestEnrichmentIntegration::test_chunk_quality_rich PASSED [ 59%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestPrePostWarFlags::test_pre_war_by_year PASSED [ 59%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestPrePostWarFlags::test_post_war_by_year PASSED [ 59%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment.py::TestPrePostWarFlags::test_spanning_both_eras PASSED [ 59%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestEnhancedYearExtraction::test_excludes_character_id_patterns PASSED [ 60%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestEnhancedYearExtraction::test_excludes_vault_numbers_without_context PASSED [ 60%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestEnhancedYearExtraction::test_includes_vault_numbers_with_year_context PASSED [ 60%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestEnhancedYearExtraction::test_filters_developer_dates PASSED [ 60%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestEnhancedYearExtraction::test_valid_fallout_timeline_range PASSED [ 60%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestEnhancedYearExtraction::test_decade_expressions PASSED [ 60%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestEnhancedYearExtraction::test_century_expressions FAILED [ 60%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestEnhancedYearExtraction::test_mixed_valid_and_invalid_years PASSED [ 60%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestEnhancedLocationClassification::test_vault_tec_not_location PASSED [ 60%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestEnhancedLocationClassification::test_vault_tec_headquarters_is_location PASSED [ 60%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestEnhancedLocationClassification::test_specific_location_classification FAILED [ 61%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestEnhancedContentTypeClassification::test_brotherhood_of_steel_detected PASSED [ 61%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestEnhancedContentTypeClassification::test_enclave_detected PASSED [ 61%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestEnhancedContentTypeClassification::test_ncr_detected PASSED [ 61%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestEnhancedContentTypeClassification::test_faction_in_title PASSED [ 61%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestEnhancedContentTypeClassification::test_faction_in_text PASSED [ 61%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestDeveloperContentDetection::test_detects_developer_content PASSED [ 61%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestDeveloperContentDetection::test_normal_content_not_flagged PASSED [ 61%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestYearExtractionHelper::test_extract_valid_years PASSED [ 61%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestYearExtractionHelper::test_exclude_character_ids PASSED [ 62%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestYearExtractionHelper::test_exclude_vault_numbers PASSED [ 62%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestYearExtractionHelper::test_exclude_out_of_range PASSED [ 62%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestEnrichChunk::test_enrich_faction_chunk FAILED [ 62%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestEnrichChunk::test_enrich_location_chunk FAILED [ 62%]
tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestEnrichChunk::test_knowledge_tier_assignment FAILED [ 62%]
tools/wiki_to_chromadb/tests/unit/test_phase6_audit.py::TestMetadataAuditor::test_auditor_init_without_db PASSED [ 62%]
tools/wiki_to_chromadb/tests/unit/test_phase6_audit.py::TestMetadataAuditor::test_sample_year_audit PASSED [ 62%]
tools/wiki_to_chromadb/tests/unit/test_phase6_audit.py::TestMetadataAuditor::test_sample_location_audit PASSED [ 62%]
tools/wiki_to_chromadb/tests/unit/test_phase6_audit.py::TestMetadataAuditor::test_sample_content_type_audit PASSED [ 62%]
tools/wiki_to_chromadb/tests/unit/test_phase6_audit.py::TestMetadataAuditor::test_generate_summary_stats_empty PASSED [ 63%]
tools/wiki_to_chromadb/tests/unit/test_phase6_audit.py::TestMetadataAuditor::test_generate_summary_stats_with_data PASSED [ 63%]
tools/wiki_to_chromadb/tests/unit/test_phase6_audit.py::TestMetadataAuditor::test_audit_year_extraction_without_db PASSED [ 63%]
tools/wiki_to_chromadb/tests/unit/test_phase6_audit.py::TestMetadataAuditor::test_audit_location_classification_without_db PASSED [ 63%]
tools/wiki_to_chromadb/tests/unit/test_phase6_audit.py::TestMetadataAuditor::test_audit_content_type_without_db PASSED [ 63%]
tools/wiki_to_chromadb/tests/unit/test_phase6_audit.py::TestMetadataAuditor::test_audit_knowledge_tier_without_db PASSED [ 63%]
tools/wiki_to_chromadb/tests/unit/test_phase6_audit.py::TestMetadataAuditor::test_generate_audit_reports_without_db FAILED [ 63%]
tools/wiki_to_chromadb/tests/unit/test_phase6_audit.py::TestMetadataAuditor::test_markdown_report_generation FAILED [ 63%]
tools/wiki_to_chromadb/tests/unit/test_re_enrich_phase6.py::TestPhase6ReEnricher::test_init_without_db PASSED [ 63%]
tools/wiki_to_chromadb/tests/unit/test_re_enrich_phase6.py::TestPhase6ReEnricher::test_stats_initialization PASSED [ 64%]
tools/wiki_to_chromadb/tests/unit/test_re_enrich_phase6.py::TestPhase6ReEnricher::test_dry_run_mode PASSED [ 64%]
tools/wiki_to_chromadb/tests/unit/test_re_enrich_phase6.py::TestValidation::test_validation_structure PASSED [ 64%]
tools/wiki_to_chromadb/tests/unit/test_re_enrich_phase6.py::TestReportGeneration::test_generate_report_structure PASSED [ 64%]
tools/wiki_to_chromadb/tests/unit/test_re_enrich_phase6.py::TestBatchProcessing::test_batch_size_parameter PASSED [ 64%]
tools/wiki_to_chromadb/tests/unit/test_re_enrich_phase6.py::TestBatchProcessing::test_offset_parameter PASSED [ 64%]
tools/wiki_to_chromadb/tests/unit/test_re_enrich_phase6.py::TestBatchProcessing::test_limit_parameter PASSED [ 64%]
tools/wiki_to_chromadb/tests/unit/test_re_enrich_phase6.py::TestErrorHandling::test_error_tracking PASSED [ 64%]
tools/wiki_to_chromadb/tests/unit/test_re_enrich_phase6.py::TestErrorHandling::test_graceful_failure PASSED [ 64%]
tools/wiki_to_chromadb/tests/unit/test_re_enrich_phase6.py::TestMetadataUpdates::test_temporal_fields_included PASSED [ 64%]
tools/wiki_to_chromadb/tests/unit/test_re_enrich_phase6.py::TestMetadataUpdates::test_broadcast_fields_included PASSED [ 65%]
tools/wiki_to_chromadb/tests/unit/test_re_enrich_phase6.py::TestMetadataUpdates::test_freshness_fields_initialized PASSED [ 65%]
tools/wiki_to_chromadb/tests/unit/test_re_enrich_phase6.py::TestProgressTracking::test_elapsed_time_calculated PASSED [ 65%]
tools/wiki_to_chromadb/tests/unit/test_re_enrich_phase6.py::TestProgressTracking::test_rate_calculation PASSED [ 65%]
tools/wiki_to_chromadb/tests/unit/test_section_fixes.py::TestDecorativeSeparatorFiltering::test_filter_equals_only_sections PASSED [ 65%]
tools/wiki_to_chromadb/tests/unit/test_section_fixes.py::TestDecorativeSeparatorFiltering::test_mixed_decorators PASSED [ 65%]
tools/wiki_to_chromadb/tests/unit/test_section_fixes.py::TestSectionTitleMarkupStripping::test_strip_wikilinks PASSED [ 65%]
tools/wiki_to_chromadb/tests/unit/test_section_fixes.py::TestSectionTitleMarkupStripping::test_strip_piped_wikilinks PASSED [ 65%]
tools/wiki_to_chromadb/tests/unit/test_section_fixes.py::TestSectionTitleMarkupStripping::test_strip_templates PASSED [ 65%]
tools/wiki_to_chromadb/tests/unit/test_section_fixes.py::TestSectionTitleMarkupStripping::test_wikilink_with_possessive PASSED [ 66%]
tools/wiki_to_chromadb/tests/unit/test_section_fixes.py::TestSectionTitleMarkupStripping::test_complex_section_title PASSED [ 66%]
tools/wiki_to_chromadb/tests/unit/test_section_fixes.py::TestSectionTitleMarkupStripping::test_quote_prefix PASSED [ 66%]
tools/wiki_to_chromadb/tests/unit/test_section_fixes.py::TestEmptySectionHandling::test_section_with_only_links PASSED [ 66%]
tools/wiki_to_chromadb/tests/unit/test_section_fixes.py::TestRealWorldCases::test_community_center_decorators PASSED [ 66%]
tools/wiki_to_chromadb/tests/unit/test_section_fixes.py::TestRealWorldCases::test_courier_stash_wikilinks PASSED [ 66%]
tools/wiki_to_chromadb/tests/unit/test_section_fixes.py::TestRealWorldCases::test_cooper_howard_episode_links PASSED [ 66%]
tools/script-generator/tests/e2e/test_ollama_setup.py::test_ollama_server SKIPPED [ 66%]
tools/script-generator/tests/e2e/test_ollama_setup.py::test_model SKIPPED [ 66%]
tools/script-generator/tests/e2e/test_single_segments.py::test_segment SKIPPED [ 66%]
tools/script-generator/tests/test_broadcast_freshness.py::TestFreshnessCalculation::test_never_used_is_fresh PASSED [ 67%]
tools/script-generator/tests/test_broadcast_freshness.py::TestFreshnessCalculation::test_just_used_is_stale PASSED [ 67%]
tools/script-generator/tests/test_broadcast_freshness.py::TestFreshnessCalculation::test_one_hour_ago PASSED [ 67%]
tools/script-generator/tests/test_broadcast_freshness.py::TestFreshnessCalculation::test_half_decay_period PASSED [ 67%]
tools/script-generator/tests/test_broadcast_freshness.py::TestFreshnessCalculation::test_full_decay_period PASSED [ 67%]
tools/script-generator/tests/test_broadcast_freshness.py::TestFreshnessCalculation::test_beyond_decay_period PASSED [ 67%]
tools/script-generator/tests/test_broadcast_freshness.py::TestFreshnessCalculation::test_linear_decay PASSED [ 67%]
tools/script-generator/tests/test_broadcast_freshness.py::TestFreshContentFilter::test_default_filter PASSED [ 67%]
tools/script-generator/tests/test_broadcast_freshness.py::TestFreshContentFilter::test_custom_filter PASSED [ 67%]
tools/script-generator/tests/test_broadcast_freshness.py::TestFreshContentFilter::test_filter_very_fresh PASSED [ 68%]
tools/script-generator/tests/test_broadcast_freshness.py::TestTrackerInitialization::test_init_with_default_path PASSED [ 68%]
tools/script-generator/tests/test_broadcast_freshness.py::TestTrackerInitialization::test_init_with_custom_path PASSED [ 68%]
tools/script-generator/tests/test_broadcast_freshness.py::TestTrackerInitialization::test_decay_parameters PASSED [ 68%]
tools/script-generator/tests/test_broadcast_freshness.py::TestMarkBroadcast::test_mark_broadcast_without_db PASSED [ 68%]
tools/script-generator/tests/test_broadcast_freshness.py::TestMarkBroadcast::test_mark_broadcast_empty_list PASSED [ 68%]
tools/script-generator/tests/test_broadcast_freshness.py::TestMarkBroadcast::test_mark_broadcast_with_timestamp PASSED [ 68%]
tools/script-generator/tests/test_broadcast_freshness.py::TestDecayFreshnessScores::test_decay_without_db PASSED [ 68%]
tools/script-generator/tests/test_broadcast_freshness.py::TestDecayFreshnessScores::test_decay_with_custom_time PASSED [ 68%]
tools/script-generator/tests/test_broadcast_freshness.py::TestFreshnessStats::test_stats_without_db PASSED [ 68%]
tools/script-generator/tests/test_broadcast_freshness.py::TestFreshnessScenarios::test_daily_broadcast_scenario PASSED [ 69%]
tools/script-generator/tests/test_broadcast_freshness.py::TestFreshnessScenarios::test_weekly_broadcast_scenario PASSED [ 69%]
tools/script-generator/tests/test_broadcast_freshness.py::TestFreshnessScenarios::test_immediate_reuse_prevention PASSED [ 69%]
tools/script-generator/tests/test_broadcast_freshness.py::TestFreshnessScenarios::test_content_becomes_fresh_again PASSED [ 69%]
tools/script-generator/tests/test_broadcast_freshness.py::TestFreshnessScenarios::test_gradual_decay_over_week PASSED [ 69%]
tools/script-generator/tests/test_broadcast_freshness.py::TestFreshnessFiltering::test_fresh_filter_includes_never_used PASSED [ 69%]
tools/script-generator/tests/test_broadcast_freshness.py::TestFreshnessFiltering::test_fresh_filter_excludes_just_used PASSED [ 69%]
tools/script-generator/tests/test_broadcast_freshness.py::TestFreshnessFiltering::test_filter_threshold_interpretation PASSED [ 69%]
tools/script-generator/tests/test_broadcast_scheduler_v2.py::TestSchedulerPrioritySystem::test_emergency_weather_has_highest_priority PASSED [ 69%]
tools/script-generator/tests/test_broadcast_scheduler_v2.py::TestSchedulerPrioritySystem::test_time_check_priority_over_filler PASSED [ 70%]
tools/script-generator/tests/test_broadcast_scheduler_v2.py::TestSchedulerPrioritySystem::test_weather_priority_at_scheduled_time PASSED [ 70%]
tools/script-generator/tests/test_broadcast_scheduler_v2.py::TestSchedulerPrioritySystem::test_news_priority_at_scheduled_time PASSED [ 70%]
tools/script-generator/tests/test_broadcast_scheduler_v2.py::TestSchedulerPrioritySystem::test_gossip_as_default_filler PASSED [ 70%]
tools/script-generator/tests/test_broadcast_scheduler_v2.py::TestConstraintGeneration::test_time_check_constraints PASSED [ 70%]
tools/script-generator/tests/test_broadcast_scheduler_v2.py::TestConstraintGeneration::test_weather_constraints_include_dj_limits PASSED [ 70%]
tools/script-generator/tests/test_broadcast_scheduler_v2.py::TestConstraintGeneration::test_news_constraints_include_category PASSED [ 70%]
tools/script-generator/tests/test_broadcast_scheduler_v2.py::TestConstraintGeneration::test_constraints_to_prompt_text PASSED [ 70%]
tools/script-generator/tests/test_broadcast_scheduler_v2.py::TestSchedulingLogic::test_time_check_only_once_per_hour PASSED [ 70%]
tools/script-generator/tests/test_broadcast_scheduler_v2.py::TestSchedulingLogic::test_weather_only_at_fixed_hours PASSED [ 70%]
tools/script-generator/tests/test_broadcast_scheduler_v2.py::TestSchedulingLogic::test_news_category_variety PASSED [ 71%]
tools/script-generator/tests/test_broadcast_scheduler_v2.py::TestSchedulingLogic::test_state_reset PASSED [ 71%]
tools/script-generator/tests/test_broadcast_scheduler_v2.py::TestSegmentPlan::test_segment_plan_rag_topic_mapping PASSED [ 71%]
tools/script-generator/tests/test_broadcast_scheduler_v2.py::TestSegmentPlan::test_segment_plan_is_required PASSED [ 71%]
tools/script-generator/tests/test_broadcast_scheduler_v2.py::TestSegmentPlan::test_segment_plan_to_dict PASSED [ 71%]
tools/script-generator/tests/test_broadcast_scheduler_v2.py::TestBackwardsCompatibility::test_legacy_get_required_segment_for_hour PASSED [ 71%]
tools/script-generator/tests/test_broadcast_scheduler_v2.py::TestBackwardsCompatibility::test_legacy_mark_segment_done PASSED [ 71%]
tools/script-generator/tests/test_broadcast_scheduler_v2.py::TestBackwardsCompatibility::test_legacy_get_segments_status PASSED [ 71%]
tools/script-generator/tests/test_broadcast_scheduler_v2.py::TestTimeOfDay::test_time_of_day_morning PASSED [ 71%]
tools/script-generator/tests/test_broadcast_scheduler_v2.py::TestTimeOfDay::test_time_of_day_midday PASSED [ 72%]
tools/script-generator/tests/test_broadcast_scheduler_v2.py::TestTimeOfDay::test_time_of_day_afternoon PASSED [ 72%]
tools/script-generator/tests/test_broadcast_scheduler_v2.py::TestTimeOfDay::test_time_of_day_evening PASSED [ 72%]
tools/script-generator/tests/test_broadcast_scheduler_v2.py::TestTimeOfDay::test_time_of_day_night PASSED [ 72%]
tools/script-generator/tests/test_enhanced_generator.py::test_enhanced_generator FAILED [ 72%]
tools/script-generator/tests/test_enhanced_queries.py::TestFreshnessFilter::test_default_freshness_filter PASSED [ 72%]
tools/script-generator/tests/test_enhanced_queries.py::TestFreshnessFilter::test_custom_freshness_filter PASSED [ 72%]
tools/script-generator/tests/test_enhanced_queries.py::TestFreshnessFilter::test_freshness_prevents_recent_content PASSED [ 72%]
tools/script-generator/tests/test_enhanced_queries.py::TestToneFilter::test_single_tone_filter PASSED [ 72%]
tools/script-generator/tests/test_enhanced_queries.py::TestToneFilter::test_multiple_tones_filter PASSED [ 72%]
tools/script-generator/tests/test_enhanced_queries.py::TestToneFilter::test_all_valid_tones PASSED [ 73%]
tools/script-generator/tests/test_enhanced_queries.py::TestSubjectExclusionFilter::test_exclude_single_subject PASSED [ 73%]
tools/script-generator/tests/test_enhanced_queries.py::TestSubjectExclusionFilter::test_exclude_multiple_subjects PASSED [ 73%]
tools/script-generator/tests/test_enhanced_queries.py::TestSubjectExclusionFilter::test_subject_diversity PASSED [ 73%]
tools/script-generator/tests/test_enhanced_queries.py::TestComplexityFilter::test_simple_complexity_filter PASSED [ 73%]
tools/script-generator/tests/test_enhanced_queries.py::TestComplexityFilter::test_moderate_complexity_filter PASSED [ 73%]
tools/script-generator/tests/test_enhanced_queries.py::TestComplexityFilter::test_complex_complexity_filter PASSED [ 73%]
tools/script-generator/tests/test_enhanced_queries.py::TestEnhancedFilter::test_filter_with_all_enhancements PASSED [ 73%]
tools/script-generator/tests/test_enhanced_queries.py::TestEnhancedFilter::test_filter_with_partial_enhancements PASSED [ 73%]
tools/script-generator/tests/test_enhanced_queries.py::TestEnhancedFilter::test_filter_without_enhancements PASSED [ 74%]
tools/script-generator/tests/test_enhanced_queries.py::TestComplexitySequencer::test_sequencer_initialization PASSED [ 74%]
tools/script-generator/tests/test_enhanced_queries.py::TestComplexitySequencer::test_sequencer_rotation PASSED [ 74%]
tools/script-generator/tests/test_enhanced_queries.py::TestComplexitySequencer::test_sequencer_current_tier PASSED [ 74%]
tools/script-generator/tests/test_enhanced_queries.py::TestComplexitySequencer::test_sequencer_reset PASSED [ 74%]
tools/script-generator/tests/test_enhanced_queries.py::TestSubjectTracker::test_tracker_initialization PASSED [ 74%]
tools/script-generator/tests/test_enhanced_queries.py::TestSubjectTracker::test_tracker_adds_subjects PASSED [ 74%]
tools/script-generator/tests/test_enhanced_queries.py::TestSubjectTracker::test_tracker_max_history PASSED [ 74%]
tools/script-generator/tests/test_enhanced_queries.py::TestSubjectTracker::test_tracker_deduplication PASSED [ 74%]
tools/script-generator/tests/test_enhanced_queries.py::TestSubjectTracker::test_tracker_clear PASSED [ 74%]
tools/script-generator/tests/test_enhanced_queries.py::TestWeatherToneMapping::test_sunny_weather_tones PASSED [ 75%]
tools/script-generator/tests/test_enhanced_queries.py::TestWeatherToneMapping::test_rad_storm_tones PASSED [ 75%]
tools/script-generator/tests/test_enhanced_queries.py::TestWeatherToneMapping::test_rainy_weather_tones PASSED [ 75%]
tools/script-generator/tests/test_enhanced_queries.py::TestWeatherToneMapping::test_cloudy_weather_tones PASSED [ 75%]
tools/script-generator/tests/test_enhanced_queries.py::TestTimeToneMapping::test_night_time_tones PASSED [ 75%]
tools/script-generator/tests/test_enhanced_queries.py::TestTimeToneMapping::test_morning_time_tones PASSED [ 75%]
tools/script-generator/tests/test_enhanced_queries.py::TestTimeToneMapping::test_afternoon_time_tones PASSED [ 75%]
tools/script-generator/tests/test_enhanced_queries.py::TestTimeToneMapping::test_evening_time_tones PASSED [ 75%]
tools/script-generator/tests/test_enhanced_queries.py::TestContextToneMapping::test_sunny_morning_tones PASSED [ 75%]
tools/script-generator/tests/test_enhanced_queries.py::TestContextToneMapping::test_rad_storm_night_tones PASSED [ 76%]
tools/script-generator/tests/test_enhanced_queries.py::TestContextToneMapping::test_no_context_default PASSED [ 76%]
tools/script-generator/tests/test_enhanced_queries.py::TestComplexitySequencePattern::test_pattern_generation PASSED [ 76%]
tools/script-generator/tests/test_enhanced_queries.py::TestComplexitySequencePattern::test_pattern_with_start PASSED [ 76%]
tools/script-generator/tests/test_enhanced_queries.py::TestComplexitySequencePattern::test_pattern_cycles PASSED [ 76%]
tools/script-generator/tests/test_generator.py::TestPersonalityLoader::test_caching PASSED [ 76%]
tools/script-generator/tests/test_generator.py::TestPersonalityLoader::test_invalid_dj_name PASSED [ 76%]
tools/script-generator/tests/test_generator.py::TestPersonalityLoader::test_load_all_djs PASSED [ 76%]
tools/script-generator/tests/test_generator.py::TestPersonalityLoader::test_load_julie PASSED [ 76%]
tools/script-generator/tests/test_generator.py::TestOllamaClient::test_connection PASSED [ 76%]
tools/script-generator/tests/test_generator.py::TestOllamaClient::test_model_unload PASSED [ 77%]
tools/script-generator/tests/test_generator.py::TestOllamaClient::test_simple_generation PASSED [ 77%]
tools/script-generator/tests/test_generator.py::TestTemplateRendering::test_all_templates_exist PASSED [ 77%]
tools/script-generator/tests/test_generator.py::TestTemplateRendering::test_template_missing_variable PASSED [ 77%]
tools/script-generator/tests/test_generator.py::TestTemplateRendering::test_weather_template_exists PASSED [ 77%]
tools/script-generator/tests/test_generator.py::TestRAGIntegration::test_rag_query_for_all_script_types PASSED [ 77%]
tools/script-generator/tests/test_generator.py::TestRAGIntegration::test_rag_query_returns_results PASSED [ 77%]
tools/script-generator/tests/test_generator.py::TestFullPipeline::test_error_handling_invalid_dj PASSED [ 77%]
tools/script-generator/tests/test_generator.py::TestFullPipeline::test_error_handling_invalid_template PASSED [ 77%]
tools/script-generator/tests/test_generator.py::TestFullPipeline::test_generate_news_script PASSED [ 78%]
tools/script-generator/tests/test_generator.py::TestFullPipeline::test_generate_time_announcement PASSED [ 78%]
tools/script-generator/tests/test_generator.py::TestFullPipeline::test_generate_weather_script FAILED [ 78%]
tools/script-generator/tests/test_generator.py::TestFullPipeline::test_save_script FAILED [ 78%]
tools/script-generator/tests/test_generator_cache_integration.py::TestGeneratorCacheIntegration::test_generator_initializes_cache PASSED [ 78%]
tools/script-generator/tests/test_generator_cache_integration.py::TestGeneratorCacheIntegration::test_generator_uses_cache_for_queries PASSED [ 78%]
tools/script-generator/tests/test_generator_cache_integration.py::TestGeneratorCacheIntegration::test_cache_statistics_method PASSED [ 78%]
tools/script-generator/tests/test_generator_cache_integration.py::TestGeneratorCacheIntegration::test_cache_invalidation_method PASSED [ 78%]
tools/script-generator/tests/test_generator_cache_integration.py::TestGeneratorCacheIntegration::test_topic_mapping_for_content_types PASSED [ 78%]
tools/script-generator/tests/test_generator_cache_integration.py::TestGeneratorCacheIntegration::test_cache_report_prints FAILED [ 78%]
tools/script-generator/tests/test_llm_pipeline.py::TestConstraintEmbedding::test_constraint_embedding_in_prompt FAILED [ 79%]
tools/script-generator/tests/test_llm_pipeline.py::TestConstraintEmbedding::test_empty_constraints_handling PASSED [ 79%]
tools/script-generator/tests/test_llm_pipeline.py::TestConstraintEmbedding::test_user_prompt_generation PASSED [ 79%]
tools/script-generator/tests/test_llm_pipeline.py::TestValidationGuidedGeneration::test_error_handling PASSED [ 79%]
tools/script-generator/tests/test_llm_pipeline.py::TestValidationGuidedGeneration::test_generation_result_structure PASSED [ 79%]
tools/script-generator/tests/test_llm_pipeline.py::TestValidationGuidedGeneration::test_single_llm_call_generation FAILED [ 79%]
tools/script-generator/tests/test_llm_pipeline.py::TestRAGCacheIntegration::test_cache_hit_tracking PASSED [ 79%]
tools/script-generator/tests/test_llm_pipeline.py::TestRAGCacheIntegration::test_topic_parameter_for_cache PASSED [ 79%]
tools/script-generator/tests/test_llm_pipeline.py::TestSchedulerIntegration::test_generate_from_segment_plan FAILED [ 79%]
tools/script-generator/tests/test_llm_pipeline.py::TestSchedulerIntegration::test_plan_constraint_extraction PASSED [ 80%]
tools/script-generator/tests/test_llm_pipeline.py::TestMetricsTracking::test_average_calculations FAILED [ 80%]
tools/script-generator/tests/test_llm_pipeline.py::TestMetricsTracking::test_metrics_incrementation PASSED [ 80%]
tools/script-generator/tests/test_llm_pipeline.py::TestMetricsTracking::test_metrics_initialization PASSED [ 80%]
tools/script-generator/tests/test_llm_pipeline.py::TestMetricsTracking::test_metrics_reset PASSED [ 80%]
tools/script-generator/tests/test_llm_pipeline.py::TestEdgeCases::test_empty_lore_chunks PASSED [ 80%]
tools/script-generator/tests/test_llm_pipeline.py::TestEdgeCases::test_missing_dj_context_fields PASSED [ 80%]
tools/script-generator/tests/test_llm_pipeline.py::TestEdgeCases::test_result_to_dict_conversion PASSED [ 80%]
tools/script-generator/tests/test_llm_validator.py::test_validation_issue_creation PASSED [ 80%]
tools/script-generator/tests/test_llm_validator.py::test_validation_result PASSED [ 80%]
tools/script-generator/tests/test_llm_validator.py::test_llm_validator_init PASSED [ 81%]
tools/script-generator/tests/test_llm_validator.py::test_validation_prompt_building PASSED [ 81%]
tools/script-generator/tests/test_llm_validator.py::test_json_response_parsing PASSED [ 81%]
tools/script-generator/tests/test_llm_validator.py::test_text_fallback_parsing PASSED [ 81%]
tools/script-generator/tests/test_llm_validator.py::test_hybrid_validator PASSED [ 81%]
tools/script-generator/tests/test_llm_validator.py::test_convenience_function PASSED [ 81%]
tools/script-generator/tests/test_llm_validator.py::test_with_real_ollama PASSED [ 81%]
tools/script-generator/tests/test_phase1_session_state.py::TestSessionMemory::test_session_memory_init PASSED [ 81%]
tools/script-generator/tests/test_phase1_session_state.py::TestSessionMemory::test_add_script_basic PASSED [ 81%]
tools/script-generator/tests/test_phase1_session_state.py::TestSessionMemory::test_add_script_respects_max_history PASSED [ 82%]
tools/script-generator/tests/test_phase1_session_state.py::TestSessionMemory::test_catchphrase_tracking PASSED [ 82%]
tools/script-generator/tests/test_phase1_session_state.py::TestSessionMemory::test_topic_extraction PASSED [ 82%]
tools/script-generator/tests/test_phase1_session_state.py::TestSessionMemory::test_topic_deduplication PASSED [ 82%]
tools/script-generator/tests/test_phase1_session_state.py::TestSessionMemory::test_context_for_prompt PASSED [ 82%]
tools/script-generator/tests/test_phase1_session_state.py::TestSessionMemory::test_session_duration_tracking PASSED [ 82%]
tools/script-generator/tests/test_phase1_session_state.py::TestSessionMemory::test_serialization PASSED [ 82%]
tools/script-generator/tests/test_phase1_session_state.py::TestSessionMemory::test_reset PASSED [ 82%]
tools/script-generator/tests/test_phase1_session_state.py::TestWorldState::test_world_state_init PASSED [ 82%]
tools/script-generator/tests/test_phase1_session_state.py::TestWorldState::test_add_storyline PASSED [ 82%]
tools/script-generator/tests/test_phase1_session_state.py::TestWorldState::test_continue_storyline PASSED [ 83%]
tools/script-generator/tests/test_phase1_session_state.py::TestWorldState::test_resolve_storyline PASSED [ 83%]
tools/script-generator/tests/test_phase1_session_state.py::TestWorldState::test_broadcast_stats_update PASSED [ 83%]
tools/script-generator/tests/test_phase1_session_state.py::TestWorldState::test_persistence_save_load PASSED [ 83%]
tools/script-generator/tests/test_phase1_session_state.py::TestWorldState::test_get_storylines_for_context PASSED [ 83%]
tools/script-generator/tests/test_phase1_session_state.py::TestBroadcastScheduler::test_scheduler_init FAILED [ 83%]
tools/script-generator/tests/test_phase1_session_state.py::TestBroadcastScheduler::test_time_of_day_detection_morning PASSED [ 83%]
tools/script-generator/tests/test_phase1_session_state.py::TestBroadcastScheduler::test_time_of_day_detection_afternoon PASSED [ 83%]
tools/script-generator/tests/test_phase1_session_state.py::TestBroadcastScheduler::test_time_of_day_detection_night PASSED [ 83%]
tools/script-generator/tests/test_phase1_session_state.py::TestBroadcastScheduler::test_segment_ready_on_first_call PASSED [ 84%]
tools/script-generator/tests/test_phase1_session_state.py::TestBroadcastScheduler::test_segment_interval_enforcement FAILED [ 84%]
tools/script-generator/tests/test_phase1_session_state.py::TestBroadcastScheduler::test_next_priority_segment FAILED [ 84%]
tools/script-generator/tests/test_phase1_session_state.py::TestBroadcastScheduler::test_segments_status FAILED [ 84%]
tools/script-generator/tests/test_phase1_session_state.py::TestBroadcastScheduler::test_scheduler_reset FAILED [ 84%]
tools/script-generator/tests/test_phase1_session_state.py::TestBroadcastScheduler::test_time_priority_variation FAILED [ 84%]
tools/script-generator/tests/test_phase1_session_state.py::TestPhase1Integration::test_session_and_world_state_together PASSED [ 84%]
tools/script-generator/tests/test_phase1_session_state.py::TestPhase1Integration::test_end_to_end_broadcast_session PASSED [ 84%]
tools/script-generator/tests/test_phase2_consistency_validator.py::TestTemporalViolations::test_julie_cannot_know_future_events PASSED [ 84%]
tools/script-generator/tests/test_phase2_consistency_validator.py::TestTemporalViolations::test_mr_new_vegas_2281_constraint PASSED [ 84%]
tools/script-generator/tests/test_phase2_consistency_validator.py::TestTemporalViolations::test_valid_temporal_reference PASSED [ 85%]
tools/script-generator/tests/test_phase2_consistency_validator.py::TestTemporalViolations::test_no_year_reference PASSED [ 85%]
tools/script-generator/tests/test_phase2_consistency_validator.py::TestForbiddenKnowledge::test_julie_cannot_mention_ncr PASSED [ 85%]
tools/script-generator/tests/test_phase2_consistency_validator.py::TestForbiddenKnowledge::test_julie_cannot_mention_institute PASSED [ 85%]
tools/script-generator/tests/test_phase2_consistency_validator.py::TestForbiddenKnowledge::test_forbidden_topic_detection PASSED [ 85%]
tools/script-generator/tests/test_phase2_consistency_validator.py::TestForbiddenKnowledge::test_known_factions_allowed PASSED [ 85%]
tools/script-generator/tests/test_phase2_consistency_validator.py::TestForbiddenKnowledge::test_case_insensitive_faction_matching PASSED [ 85%]
tools/script-generator/tests/test_phase2_consistency_validator.py::TestToneConsistency::test_hopeful_tone_validation PASSED [ 85%]
tools/script-generator/tests/test_phase2_consistency_validator.py::TestToneConsistency::test_cynical_tone_violation PASSED [ 85%]
tools/script-generator/tests/test_phase2_consistency_validator.py::TestVoicePatterns::test_filler_words_detection PASSED [ 86%]
tools/script-generator/tests/test_phase2_consistency_validator.py::TestVoicePatterns::test_missing_filler_words_warning PASSED [ 86%]
tools/script-generator/tests/test_phase2_consistency_validator.py::TestVoicePatterns::test_catchphrase_detection PASSED [ 86%]
tools/script-generator/tests/test_phase2_consistency_validator.py::TestVoicePatterns::test_no_catchphrase_warning PASSED [ 86%]
tools/script-generator/tests/test_phase2_consistency_validator.py::TestConsistencyValidatorIntegration::test_valid_julie_script PASSED [ 86%]
tools/script-generator/tests/test_phase2_consistency_validator.py::TestConsistencyValidatorIntegration::test_invalid_julie_script_temporal PASSED [ 86%]
tools/script-generator/tests/test_phase2_consistency_validator.py::TestConsistencyValidatorIntegration::test_invalid_julie_script_forbidden_knowledge PASSED [ 86%]
tools/script-generator/tests/test_phase2_consistency_validator.py::TestConsistencyValidatorIntegration::test_travis_confidence_arc PASSED [ 86%]
tools/script-generator/tests/test_phase2_consistency_validator.py::TestReportGeneration::test_no_violations_report PASSED [ 86%]
tools/script-generator/tests/test_phase2_consistency_validator.py::TestReportGeneration::test_violations_report PASSED [ 86%]
tools/script-generator/tests/test_phase2_consistency_validator.py::TestReportGeneration::test_convenience_function PASSED [ 87%]
tools/script-generator/tests/test_phase2_integration.py::TestBroadcastEngineWeatherIntegration::test_region_detection_in_broadcast_engine PASSED [ 87%]
tools/script-generator/tests/test_phase2_integration.py::TestBroadcastEngineWeatherIntegration::test_weather_calendar_initialization PASSED [ 87%]
tools/script-generator/tests/test_phase2_integration.py::TestBroadcastEngineWeatherIntegration::test_weather_state_dict_conversion PASSED [ 87%]
tools/script-generator/tests/test_phase2_integration.py::TestBroadcastEngineWeatherIntegration::test_weather_logging_to_history PASSED [ 87%]
tools/script-generator/tests/test_phase2_integration.py::TestBroadcastEngineWeatherIntegration::test_weather_query_by_time_slot PASSED [ 87%]
tools/script-generator/tests/test_phase2_integration.py::TestBroadcastEngineWeatherIntegration::test_multi_region_independence PASSED [ 87%]
tools/script-generator/tests/test_phase2_integration.py::TestBroadcastEngineWeatherIntegration::test_emergency_weather_detection PASSED [ 87%]
tools/script-generator/tests/test_phase3_content_types.py::TestWeatherModule::test_weather_types_defined PASSED [ 87%]
tools/script-generator/tests/test_phase3_content_types.py::TestWeatherModule::test_weather_rad_levels PASSED [ 88%]
tools/script-generator/tests/test_phase3_content_types.py::TestWeatherModule::test_get_weather_rag_query PASSED [ 88%]
tools/script-generator/tests/test_phase3_content_types.py::TestWeatherModule::test_get_weather_survival_tips PASSED [ 88%]
tools/script-generator/tests/test_phase3_content_types.py::TestWeatherModule::test_select_weather PASSED [ 88%]
tools/script-generator/tests/test_phase3_content_types.py::TestWeatherModule::test_get_weather_template_vars PASSED [ 88%]
tools/script-generator/tests/test_phase3_content_types.py::TestWeatherModule::test_weather_invalid_type PASSED [ 88%]
tools/script-generator/tests/test_phase3_content_types.py::TestGossipModule::test_gossip_tracker_create PASSED [ 88%]
tools/script-generator/tests/test_phase3_content_types.py::TestGossipModule::test_add_gossip PASSED [ 88%]
tools/script-generator/tests/test_phase3_content_types.py::TestGossipModule::test_continue_gossip PASSED [ 88%]
tools/script-generator/tests/test_phase3_content_types.py::TestGossipModule::test_resolve_gossip PASSED [ 88%]
tools/script-generator/tests/test_phase3_content_types.py::TestGossipModule::test_get_gossip PASSED [ 89%]
tools/script-generator/tests/test_phase3_content_types.py::TestGossipModule::test_record_mention PASSED [ 89%]
tools/script-generator/tests/test_phase3_content_types.py::TestGossipModule::test_gossip_persistence PASSED [ 89%]
tools/script-generator/tests/test_phase3_content_types.py::TestGossipModule::test_suggest_follow_up PASSED [ 89%]
tools/script-generator/tests/test_phase3_content_types.py::TestGossipModule::test_gossip_categories PASSED [ 89%]
tools/script-generator/tests/test_phase3_content_types.py::TestNewsModule::test_news_categories_defined PASSED [ 89%]
tools/script-generator/tests/test_phase3_content_types.py::TestNewsModule::test_get_news_rag_query PASSED [ 89%]
tools/script-generator/tests/test_phase3_content_types.py::TestNewsModule::test_news_with_dj_constraints PASSED [ 89%]
tools/script-generator/tests/test_phase3_content_types.py::TestNewsModule::test_filter_news_by_constraints PASSED [ 89%]
tools/script-generator/tests/test_phase3_content_types.py::TestNewsModule::test_select_news_category PASSED [ 90%]
tools/script-generator/tests/test_phase3_content_types.py::TestNewsModule::test_news_confidence_levels PASSED [ 90%]
tools/script-generator/tests/test_phase3_content_types.py::TestNewsModule::test_news_transitions PASSED [ 90%]
tools/script-generator/tests/test_phase3_content_types.py::TestTimeCheckModule::test_time_templates_defined PASSED [ 90%]
tools/script-generator/tests/test_phase3_content_types.py::TestTimeCheckModule::test_get_current_time_of_day PASSED [ 90%]
tools/script-generator/tests/test_phase3_content_types.py::TestTimeCheckModule::test_format_time PASSED [ 90%]
tools/script-generator/tests/test_phase3_content_types.py::TestTimeCheckModule::test_get_time_announcement PASSED [ 90%]
tools/script-generator/tests/test_phase3_content_types.py::TestTimeCheckModule::test_time_announcement_with_location PASSED [ 90%]
tools/script-generator/tests/test_phase3_content_types.py::TestTimeCheckModule::test_time_announcement_with_custom_text PASSED [ 90%]
tools/script-generator/tests/test_phase3_content_types.py::TestTimeCheckModule::test_get_time_check_template_vars PASSED [ 90%]
tools/script-generator/tests/test_phase3_content_types.py::TestTimeCheckModule::test_all_dj_styles_distinct PASSED [ 91%]
tools/script-generator/tests/test_phase3_content_types.py::TestPhase3Integration::test_weather_gossip_news_together PASSED [ 91%]
tools/script-generator/tests/test_phase3_content_types.py::TestPhase3Integration::test_content_type_with_dj_constraints PASSED [ 91%]
tools/script-generator/tests/test_phase3_content_types.py::TestPhase3Integration::test_broadcast_script_flow PASSED [ 91%]
tools/script-generator/tests/test_phase3_continuity.py::TestWeatherContinuity::test_weather_continuity_no_previous_weather PASSED [ 91%]
tools/script-generator/tests/test_phase3_continuity.py::TestWeatherContinuity::test_weather_continuity_with_change PASSED [ 91%]
tools/script-generator/tests/test_phase3_continuity.py::TestWeatherContinuity::test_weather_continuity_no_change PASSED [ 91%]
tools/script-generator/tests/test_phase3_continuity.py::TestWeatherContinuity::test_continuity_phrase_generation PASSED [ 91%]
tools/script-generator/tests/test_phase3_continuity.py::TestWeatherContinuity::test_regional_location_references PASSED [ 91%]
tools/script-generator/tests/test_phase3_continuity.py::TestWeatherContinuity::test_get_last_weather_from_memory PASSED [ 92%]
tools/script-generator/tests/test_phase3_continuity.py::TestWeatherContinuity::test_notable_history_flag PASSED [ 92%]
tools/script-generator/tests/test_phase3_continuity.py::TestWeatherContinuity::test_continuity_context_structure PASSED [ 92%]
tools/script-generator/tests/test_phase3_continuity.py::TestWeatherContinuity::test_emergency_weather_transitions PASSED [ 92%]
tools/script-generator/tests/test_phase4_emergency.py::TestEmergencyWeatherSystem::test_emergency_weather_detection PASSED [ 92%]
tools/script-generator/tests/test_phase4_emergency.py::TestEmergencyWeatherSystem::test_non_emergency_weather PASSED [ 92%]
tools/script-generator/tests/test_phase4_emergency.py::TestEmergencyWeatherSystem::test_regional_shelter_instructions PASSED [ 92%]
tools/script-generator/tests/test_phase4_emergency.py::TestEmergencyWeatherSystem::test_already_alerted_for_event PASSED [ 92%]
tools/script-generator/tests/test_phase4_emergency.py::TestEmergencyWeatherSystem::test_emergency_types_coverage PASSED [ 92%]
tools/script-generator/tests/test_phase4_emergency.py::TestEmergencyWeatherSystem::test_emergency_rag_context PASSED [ 92%]
tools/script-generator/tests/test_phase4_emergency.py::TestEmergencyWeatherSystem::test_emergency_priority_over_normal PASSED [ 93%]
tools/script-generator/tests/test_phase4_emergency.py::TestEmergencyWeatherSystem::test_emergency_severity_levels PASSED [ 93%]
tools/script-generator/tests/test_phase4_emergency.py::TestEmergencyWeatherSystem::test_emergency_duration_tracking PASSED [ 93%]
tools/script-generator/tests/test_phase5_cli_tools.py::TestSetWeatherTool::test_clear_manual_override PASSED [ 93%]
tools/script-generator/tests/test_phase5_cli_tools.py::TestSetWeatherTool::test_multiple_region_overrides PASSED [ 93%]
tools/script-generator/tests/test_phase5_cli_tools.py::TestSetWeatherTool::test_override_persists_across_saves PASSED [ 93%]
tools/script-generator/tests/test_phase5_cli_tools.py::TestSetWeatherTool::test_set_manual_override PASSED [ 93%]
tools/script-generator/tests/test_phase5_cli_tools.py::TestQueryWeatherHistory::test_date_range_filtering PASSED [ 93%]
tools/script-generator/tests/test_phase5_cli_tools.py::TestQueryWeatherHistory::test_filter_by_weather_type PASSED [ 93%]
tools/script-generator/tests/test_phase5_cli_tools.py::TestQueryWeatherHistory::test_filter_emergency_events PASSED [ 94%]
tools/script-generator/tests/test_phase5_cli_tools.py::TestQueryWeatherHistory::test_filter_notable_events PASSED [ 94%]
tools/script-generator/tests/test_phase5_cli_tools.py::TestQueryWeatherHistory::test_query_all_history PASSED [ 94%]
tools/script-generator/tests/test_phase5_cli_tools.py::TestRegenerateCalendar::test_calendar_persists_to_world_state PASSED [ 94%]
tools/script-generator/tests/test_phase5_cli_tools.py::TestRegenerateCalendar::test_different_seeds_produce_different_calendars PASSED [ 94%]
tools/script-generator/tests/test_phase5_cli_tools.py::TestRegenerateCalendar::test_regenerate_single_region PASSED [ 94%]
tools/script-generator/tests/test_phase5_cli_tools.py::TestRegenerateCalendar::test_seed_reproducibility PASSED [ 94%]
tools/script-generator/tests/test_phase5_cli_tools.py::TestCLIToolsIntegration::test_override_and_query_workflow PASSED [ 94%]
tools/script-generator/tests/test_phase5_cli_tools.py::TestCLIToolsIntegration::test_regenerate_and_override_priority PASSED [ 94%]
tools/script-generator/tests/test_phase6_validation.py::TestPhase6Validator::test_content_variety PASSED [ 94%]
tools/script-generator/tests/test_phase6_validation.py::TestPhase6Validator::test_freshness_effectiveness PASSED [ 95%]
tools/script-generator/tests/test_phase6_validation.py::TestPhase6Validator::test_generate_report PASSED [ 95%]
tools/script-generator/tests/test_phase6_validation.py::TestPhase6Validator::test_initialization PASSED [ 95%]
tools/script-generator/tests/test_phase6_validation.py::TestPhase6Validator::test_initialize_failure PASSED [ 95%]
tools/script-generator/tests/test_phase6_validation.py::TestPhase6Validator::test_initialize_success PASSED [ 95%]
tools/script-generator/tests/test_phase6_validation.py::TestPhase6Validator::test_integration_tests PASSED [ 95%]
tools/script-generator/tests/test_phase6_validation.py::TestPhase6Validator::test_overall_status_determination PASSED [ 95%]
tools/script-generator/tests/test_phase6_validation.py::TestPhase6Validator::test_query_performance FAILED [ 95%]
tools/script-generator/tests/test_phase6_validation.py::TestPhase6Validator::test_validate_metadata_accuracy PASSED [ 95%]
tools/script-generator/tests/test_rag_cache.py::TestCachedQuery::test_is_expired_false PASSED [ 96%]
tools/script-generator/tests/test_rag_cache.py::TestCachedQuery::test_is_expired_true PASSED [ 96%]
tools/script-generator/tests/test_rag_cache.py::TestCachedQuery::test_to_dict PASSED [ 96%]
tools/script-generator/tests/test_rag_cache.py::TestCacheStatistics::test_hit_rate_zero_queries PASSED [ 96%]
tools/script-generator/tests/test_rag_cache.py::TestCacheStatistics::test_hit_rate_calculation PASSED [ 96%]
tools/script-generator/tests/test_rag_cache.py::TestCacheStatistics::test_to_dict PASSED [ 96%]
tools/script-generator/tests/test_rag_cache.py::TestRAGCache::test_initialization PASSED [ 96%]
tools/script-generator/tests/test_rag_cache.py::TestRAGCache::test_cache_key_generation PASSED [ 96%]
tools/script-generator/tests/test_rag_cache.py::TestRAGCache::test_semantic_similarity_high PASSED [ 96%]
tools/script-generator/tests/test_rag_cache.py::TestRAGCache::test_semantic_similarity_low PASSED [ 96%]
tools/script-generator/tests/test_rag_cache.py::TestRAGCache::test_dj_temporal_filter PASSED [ 97%]
tools/script-generator/tests/test_rag_cache.py::TestRAGCache::test_dj_forbidden_topics_filter PASSED [ 97%]
tools/script-generator/tests/test_rag_cache.py::TestRAGCache::test_cache_miss_and_store FAILED [ 97%]
tools/script-generator/tests/test_rag_cache.py::TestRAGCache::test_cache_hit FAILED [ 97%]
tools/script-generator/tests/test_rag_cache.py::TestRAGCache::test_lru_eviction FAILED [ 97%]
tools/script-generator/tests/test_rag_cache.py::TestRAGCache::test_custom_ttl FAILED [ 97%]
tools/script-generator/tests/test_rag_cache.py::TestRAGCache::test_topic_based_caching FAILED [ 97%]
tools/script-generator/tests/test_rag_cache.py::TestRAGCache::test_cache_invalidation_all FAILED [ 97%]
tools/script-generator/tests/test_rag_cache.py::TestRAGCache::test_cache_invalidation_topic FAILED [ 97%]
tools/script-generator/tests/test_rag_cache.py::TestRAGCache::test_get_statistics PASSED [ 98%]
tools/script-generator/tests/test_rag_cache.py::TestRAGCache::test_reset_statistics PASSED [ 98%]
tools/script-generator/tests/test_weather_simulator.py::TestRegionalClimate::test_appalachia_climate_characteristics PASSED [ 98%]
tools/script-generator/tests/test_weather_simulator.py::TestRegionalClimate::test_mojave_climate_characteristics PASSED [ 98%]
tools/script-generator/tests/test_weather_simulator.py::TestRegionalClimate::test_commonwealth_climate_characteristics PASSED [ 98%]
tools/script-generator/tests/test_weather_simulator.py::TestRegionalClimate::test_region_detection_from_dj_name PASSED [ 98%]
tools/script-generator/tests/test_weather_simulator.py::TestRegionalClimate::test_season_detection PASSED [ 98%]
tools/script-generator/tests/test_weather_simulator.py::TestRegionalClimate::test_climate_for_region PASSED [ 98%]
tools/script-generator/tests/test_weather_simulator.py::TestWeatherSimulator::test_simulator_initialization PASSED [ 98%]
tools/script-generator/tests/test_weather_simulator.py::TestWeatherSimulator::test_yearly_calendar_generation PASSED [ 98%]
tools/script-generator/tests/test_weather_simulator.py::TestWeatherSimulator::test_regional_calendar_differences PASSED [ 99%]
tools/script-generator/tests/test_weather_simulator.py::TestWeatherSimulator::test_get_current_weather PASSED [ 99%]
tools/script-generator/tests/test_weather_simulator.py::TestWeatherSimulator::test_emergency_weather_flagging PASSED [ 99%]
tools/script-generator/tests/test_weather_simulator.py::TestWorldStateWeatherIntegration::test_weather_state_initialization PASSED [ 99%]
tools/script-generator/tests/test_weather_simulator.py::TestWorldStateWeatherIntegration::test_update_and_get_current_weather PASSED [ 99%]
tools/script-generator/tests/test_weather_simulator.py::TestWorldStateWeatherIntegration::test_weather_history_logging PASSED [ 99%]
tools/script-generator/tests/test_weather_simulator.py::TestWorldStateWeatherIntegration::test_manual_weather_override PASSED [ 99%]
tools/script-generator/tests/test_weather_simulator.py::TestWorldStateWeatherIntegration::test_state_persistence PASSED [ 99%]
tools/script-generator/tests/test_weather_simulator.py::TestWeatherStateDataclass::test_weather_state_creation PASSED [ 99%]
tools/script-generator/tests/test_weather_simulator.py::TestWeatherStateDataclass::test_weather_state_serialization PASSED [100%]

================================== FAILURES ===================================
_____ TestBroadcastEngineSegmentGeneration.test_generate_weather_segment ______

self = <tests.unit.test_broadcast_engine.TestBroadcastEngineSegmentGeneration object at 0x0000024D79F2A8C0>
mock_scheduler = <MagicMock name='BroadcastScheduler' id='2529842083200'>
mock_world = <MagicMock name='WorldState' id='2531806507888'>
mock_session = <MagicMock name='SessionMemory' id='2529841375568'>
mock_generator = <MagicMock name='ScriptGenerator' id='2529841367792'>

    @patch('broadcast_engine.ScriptGenerator')
    @patch('broadcast_engine.SessionMemory')
    @patch('broadcast_engine.WorldState')
    @patch('broadcast_engine.BroadcastScheduler')
    def test_generate_weather_segment(self, mock_scheduler, mock_world, mock_session, mock_generator):
        """Test generating a weather segment"""
        # Setup mocks
        mock_gen_instance = MagicMock()
        mock_gen_instance.generate_script.return_value = {
            'script': 'Good morning! The weather today is sunny with a chance of radstorms.',
            'rag_context': ['Weather patterns in Appalachia...'],
            'metadata': {'segment_type': 'weather'}
        }
        mock_generator.return_value = mock_gen_instance
    
        mock_scheduler_instance = MagicMock()
        mock_scheduler_instance.get_next_segment_type.return_value = 'weather'
        mock_scheduler_instance.get_required_segment_for_hour.return_value = None
        mock_scheduler_instance.should_include_segment_type.return_value = True
        mock_scheduler.return_value = mock_scheduler_instance
    
        # Mock WorldState completely to avoid datetime issues
        mock_world_instance = MagicMock()
        mock_world_instance.get_calendar_for_region.return_value = None
        mock_world_instance.weather_calendars = {}
        mock_world_instance.calendar_metadata = {}
        mock_world.return_value = mock_world_instance
    
        # Create engine
        engine = BroadcastEngine(
            dj_name="Julie (2102, Appalachia)",
            enable_validation=False
        )
    
        # Generate segment with required current_hour parameter
>       result = engine.generate_next_segment(current_hour=8)

tests\unit\test_broadcast_engine.py:122: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tools\script-generator\broadcast_engine.py:629: in generate_next_segment
    emergency_weather = self.check_for_emergency_weather(current_hour)
tools\script-generator\broadcast_engine.py:386: in check_for_emergency_weather
    current_weather = self._get_current_weather_from_simulator(current_hour)
tools\script-generator\broadcast_engine.py:326: in _get_current_weather_from_simulator
    return WeatherState.from_dict(override)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

cls = <class 'weather_simulator.WeatherState'>
data = <MagicMock name='WorldState().get_current_weather().copy()' id='2529836548304'>

    @classmethod
    def from_dict(cls, data: Dict) -> 'WeatherState':
        """Create from dictionary"""
        data = data.copy()
>       data['started_at'] = datetime.fromisoformat(data['started_at'])
E       TypeError: fromisoformat: argument must be str

tools\script-generator\weather_simulator.py:53: TypeError
---------------------------- Captured stdout call -----------------------------
[Weather System] Generating yearly calendar for Appalachia...
[Weather System] Calendar generated and saved for Appalachia
[Story System] Story pools already populated (6 total stories)

ðŸŽ™ï¸ BroadcastEngine initialized for Julie (2102, Appalachia)
   Session memory: 10 scripts
   Validation: disabled
   Weather System: enabled (Appalachia)
   Story System: enabled
___ TestLLMPipelineGeneration.test_generate_with_validation_updates_metrics ___

self = <tests.unit.test_llm_pipeline.TestLLMPipelineGeneration object at 0x0000024D79FF9030>
test_logger = <Logger test_logger (INFO)>

    def test_generate_with_validation_updates_metrics(self, test_logger):
        """Test that generation updates pipeline metrics"""
        from segment_plan import ValidationConstraints
    
        test_logger.info("Testing metrics tracking")
    
        constraints = ValidationConstraints(max_length=200)
        dj_context = {
            'name': 'Julie',
            'year': 2102,
            'region': 'Appalachia',
            'personality': {}
        }
    
        with patch.object(self.mock_llm, 'chat') as mock_chat:
            mock_chat.return_value = {
                'message': {'content': 'Script content'}
            }
    
            # Generate once
            self.pipeline.generate_with_validation(
                template='news',
                lore_chunks=[],
                constraints=constraints,
                dj_context=dj_context
            )
    
        metrics = self.pipeline.get_metrics()
    
        assert metrics['total_generations'] == 1
        assert metrics['total_llm_calls'] == 1
        assert metrics['validation_guided_generations'] == 1
>       assert metrics['avg_generation_time_ms'] > 0
E       assert 0 > 0

tests\unit\test_llm_pipeline.py:274: AssertionError
---------------------------- Captured stderr call -----------------------------
2026-01-20 12:29:08 - test_logger - INFO - Testing metrics tracking
------------------------------ Captured log call ------------------------------
INFO     test_logger:test_llm_pipeline.py:246 Testing metrics tracking
________ TestLLMPipelineSegmentPlanIntegration.test_generate_from_plan ________

self = <tests.unit.test_llm_pipeline.TestLLMPipelineSegmentPlanIntegration object at 0x0000024D79FF9900>
mock_llm = <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B1D6140>
test_logger = <Logger test_logger (INFO)>

    def test_generate_from_plan(self, mock_llm, test_logger):
        """Test generating from SegmentPlan"""
        from segment_plan import SegmentPlan, SegmentType, ValidationConstraints
    
        test_logger.info("Testing generation from SegmentPlan")
    
        constraints = ValidationConstraints(
            max_length=200,
            required_tone='friendly'
        )
    
        # Create mock segment plan
        plan = Mock(spec=SegmentPlan)
        plan.segment_type = Mock()
        plan.segment_type.value = 'weather'
        plan.constraints = constraints
        plan.metadata = {'lore_chunks': ['Weather is harsh']}
    
        # Mock get_rag_topic if it exists
        plan.get_rag_topic = Mock(return_value='regional_climate')
    
        pipeline = LLMPipeline(ollama_client=mock_llm)
    
        dj_context = {
            'name': 'Julie',
            'year': 2102,
            'region': 'Appalachia',
            'personality': {}
        }
    
>       with patch.object(mock_llm, 'chat') as mock_chat:

tests\unit\test_llm_pipeline.py:383: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\unittest\mock.py:1447: in __enter__
    original, local = self.get_original()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <unittest.mock._patch object at 0x0000024D0B1D6080>

    def get_original(self):
        target = self.getter()
        name = self.attribute
    
        original = DEFAULT
        local = False
    
        try:
            original = target.__dict__[name]
        except (AttributeError, KeyError):
            original = getattr(target, name, DEFAULT)
        else:
            local = True
    
        if name in _builtins and isinstance(target, ModuleType):
            self.create = True
    
        if not self.create and original is DEFAULT:
>           raise AttributeError(
                "%s does not have the attribute %r" % (target, name)
            )
E           AttributeError: <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B1D6140> does not have the attribute 'chat'

C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\unittest\mock.py:1420: AttributeError
---------------------------- Captured stderr call -----------------------------
2026-01-20 12:29:09 - test_logger - INFO - Testing generation from SegmentPlan
------------------------------ Captured log call ------------------------------
INFO     test_logger:test_llm_pipeline.py:357 Testing generation from SegmentPlan
_ TestLLMPipelineSegmentPlanIntegration.test_generate_from_plan_with_custom_lore _

self = <tests.unit.test_llm_pipeline.TestLLMPipelineSegmentPlanIntegration object at 0x0000024D79FF9BA0>
mock_llm = <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B257970>

    def test_generate_from_plan_with_custom_lore(self, mock_llm):
        """Test generating from plan with custom lore chunks"""
        from segment_plan import SegmentPlan, SegmentType, ValidationConstraints
    
        constraints = ValidationConstraints(max_length=200)
    
        plan = Mock(spec=SegmentPlan)
        plan.segment_type = Mock()
        plan.segment_type.value = 'news'
        plan.constraints = constraints
        plan.metadata = {}
        plan.get_rag_topic = Mock(return_value=None)
    
        pipeline = LLMPipeline(ollama_client=mock_llm)
    
        dj_context = {
            'name': 'Julie',
            'year': 2102,
            'region': 'Appalachia',
            'personality': {}
        }
    
        custom_lore = ['Custom lore chunk 1', 'Custom lore chunk 2']
    
>       with patch.object(mock_llm, 'chat') as mock_chat:

tests\unit\test_llm_pipeline.py:420: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\unittest\mock.py:1447: in __enter__
    original, local = self.get_original()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <unittest.mock._patch object at 0x0000024D0B2576A0>

    def get_original(self):
        target = self.getter()
        name = self.attribute
    
        original = DEFAULT
        local = False
    
        try:
            original = target.__dict__[name]
        except (AttributeError, KeyError):
            original = getattr(target, name, DEFAULT)
        else:
            local = True
    
        if name in _builtins and isinstance(target, ModuleType):
            self.create = True
    
        if not self.create and original is DEFAULT:
>           raise AttributeError(
                "%s does not have the attribute %r" % (target, name)
            )
E           AttributeError: <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B257970> does not have the attribute 'chat'

C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\unittest\mock.py:1420: AttributeError
________________ TestLLMPipelineMetrics.test_metrics_tracking _________________

self = <tests.unit.test_llm_pipeline.TestLLMPipelineMetrics object at 0x0000024D79FF9ED0>
mock_llm = <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B31E5C0>
test_logger = <Logger test_logger (INFO)>

    def test_metrics_tracking(self, mock_llm, test_logger):
        """Test comprehensive metrics tracking"""
        from segment_plan import ValidationConstraints
    
        test_logger.info("Testing comprehensive metrics tracking")
    
        pipeline = LLMPipeline(ollama_client=mock_llm)
    
        constraints = ValidationConstraints(max_length=200)
        dj_context = {
            'name': 'Julie',
            'year': 2102,
            'region': 'Appalachia',
            'personality': {}
        }
    
>       with patch.object(mock_llm, 'chat') as mock_chat:

tests\unit\test_llm_pipeline.py:454: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\unittest\mock.py:1447: in __enter__
    original, local = self.get_original()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <unittest.mock._patch object at 0x0000024D0B31EB60>

    def get_original(self):
        target = self.getter()
        name = self.attribute
    
        original = DEFAULT
        local = False
    
        try:
            original = target.__dict__[name]
        except (AttributeError, KeyError):
            original = getattr(target, name, DEFAULT)
        else:
            local = True
    
        if name in _builtins and isinstance(target, ModuleType):
            self.create = True
    
        if not self.create and original is DEFAULT:
>           raise AttributeError(
                "%s does not have the attribute %r" % (target, name)
            )
E           AttributeError: <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B31E5C0> does not have the attribute 'chat'

C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\unittest\mock.py:1420: AttributeError
---------------------------- Captured stderr call -----------------------------
2026-01-20 12:29:09 - test_logger - INFO - Testing comprehensive metrics tracking
------------------------------ Captured log call ------------------------------
INFO     test_logger:test_llm_pipeline.py:442 Testing comprehensive metrics tracking
__________________ TestLLMPipelineMetrics.test_metrics_reset __________________

self = <tests.unit.test_llm_pipeline.TestLLMPipelineMetrics object at 0x0000024D79FFA170>
mock_llm = <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B29E020>

    def test_metrics_reset(self, mock_llm):
        """Test resetting metrics"""
        from segment_plan import ValidationConstraints
    
        pipeline = LLMPipeline(ollama_client=mock_llm)
    
        constraints = ValidationConstraints(max_length=200)
        dj_context = {
            'name': 'Julie',
            'year': 2102,
            'region': 'Appalachia',
            'personality': {}
        }
    
>       with patch.object(mock_llm, 'chat') as mock_chat:

tests\unit\test_llm_pipeline.py:491: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\unittest\mock.py:1447: in __enter__
    original, local = self.get_original()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <unittest.mock._patch object at 0x0000024D0B29DD80>

    def get_original(self):
        target = self.getter()
        name = self.attribute
    
        original = DEFAULT
        local = False
    
        try:
            original = target.__dict__[name]
        except (AttributeError, KeyError):
            original = getattr(target, name, DEFAULT)
        else:
            local = True
    
        if name in _builtins and isinstance(target, ModuleType):
            self.create = True
    
        if not self.create and original is DEFAULT:
>           raise AttributeError(
                "%s does not have the attribute %r" % (target, name)
            )
E           AttributeError: <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B29E020> does not have the attribute 'chat'

C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\unittest\mock.py:1420: AttributeError
______________ TestLLMPipelineMetrics.test_print_metrics_report _______________

self = <tests.unit.test_llm_pipeline.TestLLMPipelineMetrics object at 0x0000024D79FFA6B0>
mock_llm = <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B324760>
capsys = <_pytest.capture.CaptureFixture object at 0x0000024D0B324880>

    def test_print_metrics_report(self, mock_llm, capsys):
        """Test printing metrics report"""
        from segment_plan import ValidationConstraints
    
        pipeline = LLMPipeline(ollama_client=mock_llm)
    
        constraints = ValidationConstraints(max_length=200)
        dj_context = {
            'name': 'Julie',
            'year': 2102,
            'region': 'Appalachia',
            'personality': {}
        }
    
>       with patch.object(mock_llm, 'chat') as mock_chat:

tests\unit\test_llm_pipeline.py:546: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\unittest\mock.py:1447: in __enter__
    original, local = self.get_original()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <unittest.mock._patch object at 0x0000024D0B324610>

    def get_original(self):
        target = self.getter()
        name = self.attribute
    
        original = DEFAULT
        local = False
    
        try:
            original = target.__dict__[name]
        except (AttributeError, KeyError):
            original = getattr(target, name, DEFAULT)
        else:
            local = True
    
        if name in _builtins and isinstance(target, ModuleType):
            self.create = True
    
        if not self.create and original is DEFAULT:
>           raise AttributeError(
                "%s does not have the attribute %r" % (target, name)
            )
E           AttributeError: <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B324760> does not have the attribute 'chat'

C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\unittest\mock.py:1420: AttributeError
_____________ TestLLMPipelineRetryLogic.test_single_call_success ______________

self = <tests.unit.test_llm_pipeline.TestLLMPipelineRetryLogic object at 0x0000024D79FFA9E0>
mock_llm = <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D27AD8CD0>
test_logger = <Logger test_logger (INFO)>

    def test_single_call_success(self, mock_llm, test_logger):
        """Test successful generation on first call"""
        from segment_plan import ValidationConstraints
    
        test_logger.info("Testing single-call success")
    
        pipeline = LLMPipeline(ollama_client=mock_llm)
    
        constraints = ValidationConstraints(max_length=200)
        dj_context = {
            'name': 'Julie',
            'year': 2102,
            'region': 'Appalachia',
            'personality': {}
        }
    
>       with patch.object(mock_llm, 'chat') as mock_chat:

tests\unit\test_llm_pipeline.py:590: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\unittest\mock.py:1447: in __enter__
    original, local = self.get_original()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <unittest.mock._patch object at 0x0000024D27AD8E50>

    def get_original(self):
        target = self.getter()
        name = self.attribute
    
        original = DEFAULT
        local = False
    
        try:
            original = target.__dict__[name]
        except (AttributeError, KeyError):
            original = getattr(target, name, DEFAULT)
        else:
            local = True
    
        if name in _builtins and isinstance(target, ModuleType):
            self.create = True
    
        if not self.create and original is DEFAULT:
>           raise AttributeError(
                "%s does not have the attribute %r" % (target, name)
            )
E           AttributeError: <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D27AD8CD0> does not have the attribute 'chat'

C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\unittest\mock.py:1420: AttributeError
---------------------------- Captured stderr call -----------------------------
2026-01-20 12:29:09 - test_logger - INFO - Testing single-call success
------------------------------ Captured log call ------------------------------
INFO     test_logger:test_llm_pipeline.py:578 Testing single-call success
___________ TestLLMPipelineCacheIntegration.test_cache_hit_tracking ___________

self = <tests.unit.test_llm_pipeline.TestLLMPipelineCacheIntegration object at 0x0000024D79FFAFB0>
mock_llm = <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B2CC280>
test_logger = <Logger test_logger (INFO)>

    def test_cache_hit_tracking(self, mock_llm, test_logger):
        """Test cache hit tracking"""
        from segment_plan import ValidationConstraints
    
        test_logger.info("Testing cache hit tracking")
    
        mock_rag_cache = Mock()
        mock_rag_cache.get_statistics.return_value = {
            'hit_rate': 0.8,
            'cache_hits': 8,
            'cache_misses': 2
        }
    
        pipeline = LLMPipeline(
            ollama_client=mock_llm,
            rag_cache=mock_rag_cache
        )
    
        constraints = ValidationConstraints(max_length=200)
        dj_context = {
            'name': 'Julie',
            'year': 2102,
            'region': 'Appalachia',
            'personality': {}
        }
    
>       with patch.object(mock_llm, 'chat') as mock_chat:

tests\unit\test_llm_pipeline.py:669: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\unittest\mock.py:1447: in __enter__
    original, local = self.get_original()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <unittest.mock._patch object at 0x0000024D0B2CC340>

    def get_original(self):
        target = self.getter()
        name = self.attribute
    
        original = DEFAULT
        local = False
    
        try:
            original = target.__dict__[name]
        except (AttributeError, KeyError):
            original = getattr(target, name, DEFAULT)
        else:
            local = True
    
        if name in _builtins and isinstance(target, ModuleType):
            self.create = True
    
        if not self.create and original is DEFAULT:
>           raise AttributeError(
                "%s does not have the attribute %r" % (target, name)
            )
E           AttributeError: <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B2CC280> does not have the attribute 'chat'

C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\unittest\mock.py:1420: AttributeError
---------------------------- Captured stderr call -----------------------------
2026-01-20 12:29:10 - test_logger - INFO - Testing cache hit tracking
------------------------------ Captured log call ------------------------------
INFO     test_logger:test_llm_pipeline.py:647 Testing cache hit tracking
__________ TestLLMPipelineCacheIntegration.test_cache_miss_tracking ___________

self = <tests.unit.test_llm_pipeline.TestLLMPipelineCacheIntegration object at 0x0000024D79FFB250>
mock_llm = <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D064F4790>

    def test_cache_miss_tracking(self, mock_llm):
        """Test cache miss tracking"""
        from segment_plan import ValidationConstraints
    
        mock_rag_cache = Mock()
        mock_rag_cache.get_statistics.return_value = {
            'hit_rate': 0.2,
            'cache_hits': 2,
            'cache_misses': 8
        }
    
        pipeline = LLMPipeline(
            ollama_client=mock_llm,
            rag_cache=mock_rag_cache
        )
    
        constraints = ValidationConstraints(max_length=200)
        dj_context = {
            'name': 'Julie',
            'year': 2102,
            'region': 'Appalachia',
            'personality': {}
        }
    
>       with patch.object(mock_llm, 'chat') as mock_chat:

tests\unit\test_llm_pipeline.py:710: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\unittest\mock.py:1447: in __enter__
    original, local = self.get_original()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <unittest.mock._patch object at 0x0000024D064F45E0>

    def get_original(self):
        target = self.getter()
        name = self.attribute
    
        original = DEFAULT
        local = False
    
        try:
            original = target.__dict__[name]
        except (AttributeError, KeyError):
            original = getattr(target, name, DEFAULT)
        else:
            local = True
    
        if name in _builtins and isinstance(target, ModuleType):
            self.create = True
    
        if not self.create and original is DEFAULT:
>           raise AttributeError(
                "%s does not have the attribute %r" % (target, name)
            )
E           AttributeError: <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D064F4790> does not have the attribute 'chat'

C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\unittest\mock.py:1420: AttributeError
____ TestLLMPipelineCacheIntegration.test_no_cache_tracking_without_cache _____

self = <tests.unit.test_llm_pipeline.TestLLMPipelineCacheIntegration object at 0x0000024D79FFB4F0>
mock_llm = <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B260430>

    def test_no_cache_tracking_without_cache(self, mock_llm):
        """Test that cache tracking works without RAG cache"""
        from segment_plan import ValidationConstraints
    
        pipeline = LLMPipeline(ollama_client=mock_llm)
    
        constraints = ValidationConstraints(max_length=200)
        dj_context = {
            'name': 'Julie',
            'year': 2102,
            'region': 'Appalachia',
            'personality': {}
        }
    
>       with patch.object(mock_llm, 'chat') as mock_chat:

tests\unit\test_llm_pipeline.py:740: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\unittest\mock.py:1447: in __enter__
    original, local = self.get_original()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <unittest.mock._patch object at 0x0000024D0B260340>

    def get_original(self):
        target = self.getter()
        name = self.attribute
    
        original = DEFAULT
        local = False
    
        try:
            original = target.__dict__[name]
        except (AttributeError, KeyError):
            original = getattr(target, name, DEFAULT)
        else:
            local = True
    
        if name in _builtins and isinstance(target, ModuleType):
            self.create = True
    
        if not self.create and original is DEFAULT:
>           raise AttributeError(
                "%s does not have the attribute %r" % (target, name)
            )
E           AttributeError: <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B260430> does not have the attribute 'chat'

C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\unittest\mock.py:1420: AttributeError
______ TestLLMPipelineValidationGuided.test_validation_guided_percentage ______

self = <tests.unit.test_llm_pipeline.TestLLMPipelineValidationGuided object at 0x0000024D79FFB820>
mock_llm = <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B333AC0>

    def test_validation_guided_percentage(self, mock_llm):
        """Test validation-guided percentage tracking"""
        from segment_plan import ValidationConstraints
    
        pipeline = LLMPipeline(ollama_client=mock_llm)
    
        constraints = ValidationConstraints(max_length=200)
        dj_context = {
            'name': 'Julie',
            'year': 2102,
            'region': 'Appalachia',
            'personality': {}
        }
    
>       with patch.object(mock_llm, 'chat') as mock_chat:

tests\unit\test_llm_pipeline.py:774: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\unittest\mock.py:1447: in __enter__
    original, local = self.get_original()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <unittest.mock._patch object at 0x0000024D0B332380>

    def get_original(self):
        target = self.getter()
        name = self.attribute
    
        original = DEFAULT
        local = False
    
        try:
            original = target.__dict__[name]
        except (AttributeError, KeyError):
            original = getattr(target, name, DEFAULT)
        else:
            local = True
    
        if name in _builtins and isinstance(target, ModuleType):
            self.create = True
    
        if not self.create and original is DEFAULT:
>           raise AttributeError(
                "%s does not have the attribute %r" % (target, name)
            )
E           AttributeError: <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B333AC0> does not have the attribute 'chat'

C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\unittest\mock.py:1420: AttributeError
_____ TestLLMPipelineValidationGuided.test_embedded_constraints_in_prompt _____

self = <tests.unit.test_llm_pipeline.TestLLMPipelineValidationGuided object at 0x0000024D79FFAD10>
mock_llm = <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B1F8400>
test_logger = <Logger test_logger (INFO)>

    def test_embedded_constraints_in_prompt(self, mock_llm, test_logger):
        """Test that constraints are embedded in the prompt"""
        from segment_plan import ValidationConstraints
    
        test_logger.info("Testing embedded constraints in prompt")
    
        pipeline = LLMPipeline(ollama_client=mock_llm)
    
        constraints = ValidationConstraints(
            max_length=200,
            forbidden_topics=['synths', 'Institute'],
            required_tone='friendly'
        )
    
        dj_context = {
            'name': 'Julie',
            'year': 2102,
            'region': 'Appalachia',
            'personality': {'tone': 'friendly'}
        }
    
>       with patch.object(mock_llm, 'chat') as mock_chat:

tests\unit\test_llm_pipeline.py:815: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\unittest\mock.py:1447: in __enter__
    original, local = self.get_original()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <unittest.mock._patch object at 0x0000024D0B1F8370>

    def get_original(self):
        target = self.getter()
        name = self.attribute
    
        original = DEFAULT
        local = False
    
        try:
            original = target.__dict__[name]
        except (AttributeError, KeyError):
            original = getattr(target, name, DEFAULT)
        else:
            local = True
    
        if name in _builtins and isinstance(target, ModuleType):
            self.create = True
    
        if not self.create and original is DEFAULT:
>           raise AttributeError(
                "%s does not have the attribute %r" % (target, name)
            )
E           AttributeError: <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B1F8400> does not have the attribute 'chat'

C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\unittest\mock.py:1420: AttributeError
---------------------------- Captured stderr call -----------------------------
2026-01-20 12:29:10 - test_logger - INFO - Testing embedded constraints in prompt
------------------------------ Captured log call ------------------------------
INFO     test_logger:test_llm_pipeline.py:798 Testing embedded constraints in prompt
_________ TestLLMValidatorValidation.test_validate_with_json_response _________

self = <tests.unit.test_llm_validator.TestLLMValidatorValidation object at 0x0000024D7A01C670>
mock_llm = <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B27B220>
test_logger = <Logger test_logger (INFO)>

    def test_validate_with_json_response(self, mock_llm, test_logger):
        """Test validation with proper JSON response"""
        test_logger.info("Testing LLM validation with JSON response")
    
        # Configure mock to return valid JSON
        json_response = {
            "overall_score": 0.85,
            "is_valid": True,
            "issues": [
                {
                    "severity": "warning",
                    "category": "tone",
                    "message": "Could be more upbeat",
                    "suggestion": "Add more enthusiasm",
                    "confidence": 0.7
                }
            ],
            "feedback": "Good script overall"
        }
    
>       mock_llm.set_custom_response(
            "validate",
            json.dumps(json_response)
        )
E       AttributeError: 'MockOllamaClient' object has no attribute 'set_custom_response'

tests\unit\test_llm_validator.py:296: AttributeError
---------------------------- Captured stderr call -----------------------------
2026-01-20 12:29:10 - test_logger - INFO - Testing LLM validation with JSON response
------------------------------ Captured log call ------------------------------
INFO     test_logger:test_llm_validator.py:278 Testing LLM validation with JSON response
________ TestLLMValidatorValidation.test_validate_with_critical_issues ________

self = <tests.unit.test_llm_validator.TestLLMValidatorValidation object at 0x0000024D7A01DF30>
mock_llm = <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B2122C0>

    def test_validate_with_critical_issues(self, mock_llm):
        """Test validation with critical issues"""
        json_response = {
            "overall_score": 0.4,
            "is_valid": False,
            "issues": [
                {
                    "severity": "critical",
                    "category": "lore",
                    "message": "Mentions future events",
                    "confidence": 0.95
                }
            ],
            "feedback": "Critical lore violation"
        }
    
>       mock_llm.set_custom_response(
            "validate",
            json.dumps(json_response)
        )
E       AttributeError: 'MockOllamaClient' object has no attribute 'set_custom_response'

tests\unit\test_llm_validator.py:341: AttributeError
________ TestLLMValidatorValidation.test_validate_with_malformed_json _________

self = <tests.unit.test_llm_validator.TestLLMValidatorValidation object at 0x0000024D7A01E200>
mock_llm = <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B2C7700>
test_logger = <Logger test_logger (INFO)>

    def test_validate_with_malformed_json(self, mock_llm, test_logger):
        """Test validation with malformed JSON response"""
        test_logger.info("Testing validation with malformed JSON")
    
        # Return non-JSON response
>       mock_llm.set_custom_response(
            "validate",
            "This is not valid JSON but mentions temporal issues"
        )
E       AttributeError: 'MockOllamaClient' object has no attribute 'set_custom_response'

tests\unit\test_llm_validator.py:366: AttributeError
---------------------------- Captured stderr call -----------------------------
2026-01-20 12:29:10 - test_logger - INFO - Testing validation with malformed JSON
------------------------------ Captured log call ------------------------------
INFO     test_logger:test_llm_validator.py:363 Testing validation with malformed JSON
_______ TestLLMValidatorValidation.test_validate_with_specific_aspects ________

self = <tests.unit.test_llm_validator.TestLLMValidatorValidation object at 0x0000024D7A01E6E0>
mock_llm = <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D064F7CA0>

    def test_validate_with_specific_aspects(self, mock_llm):
        """Test validation with specific validation aspects"""
        json_response = {
            "overall_score": 0.9,
            "is_valid": True,
            "issues": [],
            "feedback": "Good"
        }
    
>       mock_llm.set_custom_response(
            "validate",
            json.dumps(json_response)
        )
E       AttributeError: 'MockOllamaClient' object has no attribute 'set_custom_response'

tests\unit\test_llm_validator.py:419: AttributeError
_______ TestLLMValidatorQuickValidate.test_quick_validate_valid_script ________

self = <tests.unit.test_llm_validator.TestLLMValidatorQuickValidate object at 0x0000024D7A01EA10>
mock_llm = <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D2795BD30>

    def test_quick_validate_valid_script(self, mock_llm):
        """Test quick validation with valid script"""
        json_response = {
            "overall_score": 0.9,
            "is_valid": True,
            "issues": [],
            "feedback": "Excellent script"
        }
    
>       mock_llm.set_custom_response(
            "validate",
            json.dumps(json_response)
        )
E       AttributeError: 'MockOllamaClient' object has no attribute 'set_custom_response'

tests\unit\test_llm_validator.py:458: AttributeError
________ TestLLMValidatorQuickValidate.test_quick_validate_with_issues ________

self = <tests.unit.test_llm_validator.TestLLMValidatorQuickValidate object at 0x0000024D7A01EC80>
mock_llm = <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B251000>

    def test_quick_validate_with_issues(self, mock_llm):
        """Test quick validation with issues"""
        json_response = {
            "overall_score": 0.6,
            "is_valid": False,
            "issues": [
                {
                    "severity": "critical",
                    "category": "lore",
                    "message": "Lore issue",
                    "confidence": 0.9
                },
                {
                    "severity": "warning",
                    "category": "tone",
                    "message": "Tone issue",
                    "confidence": 0.7
                }
            ],
            "feedback": "Needs improvement"
        }
    
>       mock_llm.set_custom_response(
            "validate",
            json.dumps(json_response)
        )
E       AttributeError: 'MockOllamaClient' object has no attribute 'set_custom_response'

tests\unit\test_llm_validator.py:500: AttributeError
_______ TestHybridValidatorValidation.test_hybrid_validation_both_modes _______

self = <tests.unit.test_llm_validator.TestHybridValidatorValidation object at 0x0000024D7A01F820>
mock_llm = <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B261F90>
test_logger = <Logger test_logger (INFO)>

    def test_hybrid_validation_both_modes(self, mock_llm, test_logger):
        """Test hybrid validation with both rules and LLM"""
        test_logger.info("Testing hybrid validation with both modes")
    
        json_response = {
            "overall_score": 0.8,
            "is_valid": True,
            "issues": [
                {
                    "severity": "suggestion",
                    "category": "quality",
                    "message": "Could add more detail",
                    "confidence": 0.6
                }
            ],
            "feedback": "Good overall"
        }
    
>       mock_llm.set_custom_response(
            "validate",
            json.dumps(json_response)
        )
E       AttributeError: 'MockOllamaClient' object has no attribute 'set_custom_response'

tests\unit\test_llm_validator.py:598: AttributeError
---------------------------- Captured stderr call -----------------------------
2026-01-20 12:29:10 - test_logger - INFO - Testing hybrid validation with both modes
------------------------------ Captured log call ------------------------------
INFO     test_logger:test_llm_validator.py:582 Testing hybrid validation with both modes
_____ TestHybridValidatorValidation.test_hybrid_validation_llm_only_mode ______

self = <tests.unit.test_llm_validator.TestHybridValidatorValidation object at 0x0000024D7A01FAC0>
mock_llm = <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B26FB50>

    def test_hybrid_validation_llm_only_mode(self, mock_llm):
        """Test hybrid validator in LLM-only mode"""
        json_response = {
            "overall_score": 0.9,
            "is_valid": True,
            "issues": [],
            "feedback": "Perfect"
        }
    
>       mock_llm.set_custom_response(
            "validate",
            json.dumps(json_response)
        )
E       AttributeError: 'MockOllamaClient' object has no attribute 'set_custom_response'

tests\unit\test_llm_validator.py:642: AttributeError
____ TestHybridValidatorValidation.test_hybrid_validation_combines_issues _____

self = <tests.unit.test_llm_validator.TestHybridValidatorValidation object at 0x0000024D7A01FFD0>
mock_llm = <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D7B654DC0>
test_logger = <Logger test_logger (INFO)>

    def test_hybrid_validation_combines_issues(self, mock_llm, test_logger):
        """Test that hybrid validator combines issues from both sources"""
        test_logger.info("Testing hybrid validation combines issues")
    
        # LLM will return some issues
        json_response = {
            "overall_score": 0.7,
            "is_valid": True,
            "issues": [
                {
                    "severity": "warning",
                    "category": "quality",
                    "message": "LLM-detected issue",
                    "confidence": 0.8
                }
            ],
            "feedback": "Some improvements needed"
        }
    
>       mock_llm.set_custom_response(
            "validate",
            json.dumps(json_response)
        )
E       AttributeError: 'MockOllamaClient' object has no attribute 'set_custom_response'

tests\unit\test_llm_validator.py:719: AttributeError
---------------------------- Captured stderr call -----------------------------
2026-01-20 12:29:11 - test_logger - INFO - Testing hybrid validation combines issues
------------------------------ Captured log call ------------------------------
INFO     test_logger:test_llm_validator.py:702 Testing hybrid validation combines issues
___ TestValidateScriptConvenienceFunction.test_validate_script_llm_strategy ___

self = <tests.unit.test_llm_validator.TestValidateScriptConvenienceFunction object at 0x0000024D7A01F010>
mock_llm = <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D064DF670>

    def test_validate_script_llm_strategy(self, mock_llm):
        """Test validate_script with LLM strategy"""
        json_response = {
            "overall_score": 0.9,
            "is_valid": True,
            "issues": [],
            "feedback": "Good"
        }
    
>       mock_llm.set_custom_response(
            "validate",
            json.dumps(json_response)
        )
E       AttributeError: 'MockOllamaClient' object has no attribute 'set_custom_response'

tests\unit\test_llm_validator.py:767: AttributeError
_ TestValidateScriptConvenienceFunction.test_validate_script_hybrid_strategy __

self = <tests.unit.test_llm_validator.TestValidateScriptConvenienceFunction object at 0x0000024D7A01E290>
mock_llm = <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B4DDD50>

    def test_validate_script_hybrid_strategy(self, mock_llm):
        """Test validate_script with hybrid strategy"""
        json_response = {
            "overall_score": 0.85,
            "is_valid": True,
            "issues": [],
            "feedback": "Good"
        }
    
>       mock_llm.set_custom_response(
            "validate",
            json.dumps(json_response)
        )
E       AttributeError: 'MockOllamaClient' object has no attribute 'set_custom_response'

tests\unit\test_llm_validator.py:798: AttributeError
____________ TestValidationModes.test_validation_mode_all_aspects _____________

self = <tests.unit.test_llm_validator.TestValidationModes object at 0x0000024D79F73220>
mock_llm = <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B2122C0>

    def test_validation_mode_all_aspects(self, mock_llm):
        """Test validation with all aspects enabled"""
        json_response = {
            "overall_score": 0.8,
            "is_valid": True,
            "issues": [],
            "feedback": "Good"
        }
    
>       mock_llm.set_custom_response(
            "validate",
            json.dumps(json_response)
        )
E       AttributeError: 'MockOllamaClient' object has no attribute 'set_custom_response'

tests\unit\test_llm_validator.py:835: AttributeError
___________ TestValidationModes.test_validation_mode_subset_aspects ___________

self = <tests.unit.test_llm_validator.TestValidationModes object at 0x0000024D7A038220>
mock_llm = <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B26A350>

    def test_validation_mode_subset_aspects(self, mock_llm):
        """Test validation with subset of aspects"""
        json_response = {
            "overall_score": 0.9,
            "is_valid": True,
            "issues": [],
            "feedback": "Good"
        }
    
>       mock_llm.set_custom_response(
            "validate",
            json.dumps(json_response)
        )
E       AttributeError: 'MockOllamaClient' object has no attribute 'set_custom_response'

tests\unit\test_llm_validator.py:864: AttributeError
________________ TestOllamaClientMocked.test_connection_error _________________

self = <ollama_client.OllamaClient object at 0x0000024D064F6920>
model = 'test-model', prompt = 'test', options = None, max_retries = 3
timeout = 60

    def generate(self,
                 model: str,
                 prompt: str,
                 options: Optional[Dict[str, Any]] = None,
                 max_retries: int = 3,
                 timeout: int = 60) -> str:
        """
        Generate text using Ollama.
    
        Args:
            model: Model name (e.g., "fluffy/l3-8b-stheno-v3.2")
            prompt: Text prompt
            options: Generation options (temperature, top_p, etc.)
            max_retries: Maximum retry attempts
            timeout: Request timeout in seconds
    
        Returns:
            Generated text
    
        Raises:
            ConnectionError: If Ollama server is unreachable
            RuntimeError: If generation fails after retries
        """
        payload = {
            "model": model,
            "prompt": prompt,
            "stream": False,
            "options": options or {}
        }
    
        last_error = None
        for attempt in range(max_retries):
            try:
>               response = requests.post(
                    self.generate_url,
                    json=payload,
                    timeout=timeout
                )

tools\script-generator\ollama_client.py:58: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\unittest\mock.py:1114: in __call__
    return self._mock_call(*args, **kwargs)
C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\unittest\mock.py:1118: in _mock_call
    return self._execute_mock_call(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <MagicMock name='post' id='2529841608928'>
args = ('http://localhost:11434/api/generate',)
kwargs = {'json': {'model': 'test-model', 'options': {}, 'prompt': 'test', 'stream': False}, 'timeout': 60}
effect = ConnectionError('Connection refused')

    def _execute_mock_call(self, /, *args, **kwargs):
        # separate from _increment_mock_call so that awaited functions are
        # executed separately from their call, also AsyncMock overrides this method
    
        effect = self.side_effect
        if effect is not None:
            if _is_exception(effect):
>               raise effect
E               requests.exceptions.ConnectionError: Connection refused

C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\unittest\mock.py:1173: ConnectionError

The above exception was the direct cause of the following exception:

self = <tests.unit.test_ollama_client.TestOllamaClientMocked object at 0x0000024D7A03AC80>

    def test_connection_error(self):
        """Test connection error handling"""
        client = OllamaClient()
    
        # Patch requests.exceptions to raise ConnectionError
        from requests.exceptions import ConnectionError as RequestsConnectionError
    
        # Import and patch in the correct location
        import ollama_client
        with patch.object(ollama_client.requests, 'post', side_effect=RequestsConnectionError("Connection refused")):
            # Should raise our wrapped ConnectionError
            with pytest.raises(ConnectionError):
>               client.generate(model="test-model", prompt="test")

tests\unit\test_ollama_client.py:59: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <ollama_client.OllamaClient object at 0x0000024D064F6920>
model = 'test-model', prompt = 'test', options = None, max_retries = 3
timeout = 60

    def generate(self,
                 model: str,
                 prompt: str,
                 options: Optional[Dict[str, Any]] = None,
                 max_retries: int = 3,
                 timeout: int = 60) -> str:
        """
        Generate text using Ollama.
    
        Args:
            model: Model name (e.g., "fluffy/l3-8b-stheno-v3.2")
            prompt: Text prompt
            options: Generation options (temperature, top_p, etc.)
            max_retries: Maximum retry attempts
            timeout: Request timeout in seconds
    
        Returns:
            Generated text
    
        Raises:
            ConnectionError: If Ollama server is unreachable
            RuntimeError: If generation fails after retries
        """
        payload = {
            "model": model,
            "prompt": prompt,
            "stream": False,
            "options": options or {}
        }
    
        last_error = None
        for attempt in range(max_retries):
            try:
                response = requests.post(
                    self.generate_url,
                    json=payload,
                    timeout=timeout
                )
                response.raise_for_status()
    
                result = response.json()
                generated_text = result.get('response', '').strip()
    
                if not generated_text:
                    raise RuntimeError("Ollama returned empty response")
    
                return generated_text
    
            except requests.exceptions.ConnectionError as e:
>               raise ConnectionError(
                    f"Cannot connect to Ollama at {self.base_url}. "
                    "Is Ollama running? Start with: ollama serve"
                ) from e
E               ConnectionError: Cannot connect to Ollama at http://localhost:11434. Is Ollama running? Start with: ollama serve

tools\script-generator\ollama_client.py:74: ConnectionError
________ TestComplexityTierClassification.test_complex_tier_long_text _________

self = <tools.wiki_to_chromadb.tests.unit.test_broadcast_metadata.TestComplexityTierClassification object at 0x0000024D7A33DC90>

    def test_complex_tier_long_text(self):
        """Test complex tier for long text"""
        metadata = ChunkMetadata(
            wiki_title="Test",
            timestamp="2024-01-01",
            section="Test",
            section_level=1,
            chunk_index=0,
            total_chunks=1,
>           structural=StructuralMetadata(wikilinks=[{"target": f"link{i}"} for i in range(15)])
        )
E       pydantic_core._pydantic_core.ValidationError: 30 validation errors for StructuralMetadata
E       wikilinks.0.display
E         Field required [type=missing, input_value={'target': 'link0'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.0.type
E         Field required [type=missing, input_value={'target': 'link0'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.1.display
E         Field required [type=missing, input_value={'target': 'link1'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.1.type
E         Field required [type=missing, input_value={'target': 'link1'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.2.display
E         Field required [type=missing, input_value={'target': 'link2'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.2.type
E         Field required [type=missing, input_value={'target': 'link2'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.3.display
E         Field required [type=missing, input_value={'target': 'link3'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.3.type
E         Field required [type=missing, input_value={'target': 'link3'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.4.display
E         Field required [type=missing, input_value={'target': 'link4'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.4.type
E         Field required [type=missing, input_value={'target': 'link4'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.5.display
E         Field required [type=missing, input_value={'target': 'link5'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.5.type
E         Field required [type=missing, input_value={'target': 'link5'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.6.display
E         Field required [type=missing, input_value={'target': 'link6'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.6.type
E         Field required [type=missing, input_value={'target': 'link6'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.7.display
E         Field required [type=missing, input_value={'target': 'link7'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.7.type
E         Field required [type=missing, input_value={'target': 'link7'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.8.display
E         Field required [type=missing, input_value={'target': 'link8'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.8.type
E         Field required [type=missing, input_value={'target': 'link8'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.9.display
E         Field required [type=missing, input_value={'target': 'link9'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.9.type
E         Field required [type=missing, input_value={'target': 'link9'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.10.display
E         Field required [type=missing, input_value={'target': 'link10'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.10.type
E         Field required [type=missing, input_value={'target': 'link10'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.11.display
E         Field required [type=missing, input_value={'target': 'link11'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.11.type
E         Field required [type=missing, input_value={'target': 'link11'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.12.display
E         Field required [type=missing, input_value={'target': 'link12'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.12.type
E         Field required [type=missing, input_value={'target': 'link12'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.13.display
E         Field required [type=missing, input_value={'target': 'link13'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.13.type
E         Field required [type=missing, input_value={'target': 'link13'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.14.display
E         Field required [type=missing, input_value={'target': 'link14'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.14.type
E         Field required [type=missing, input_value={'target': 'link14'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing

tools\wiki_to_chromadb\tests\unit\test_broadcast_metadata.py:84: ValidationError
_____________ TestComplexityTierClassification.test_moderate_tier _____________

self = <tools.wiki_to_chromadb.tests.unit.test_broadcast_metadata.TestComplexityTierClassification object at 0x0000024D7A33DF30>

    def test_moderate_tier(self):
        """Test moderate tier for medium-length text"""
        metadata = ChunkMetadata(
            wiki_title="Test",
            timestamp="2024-01-01",
            section="Test",
            section_level=1,
            chunk_index=0,
            total_chunks=1,
>           structural=StructuralMetadata(wikilinks=[{"target": f"link{i}"} for i in range(5)])
        )
E       pydantic_core._pydantic_core.ValidationError: 10 validation errors for StructuralMetadata
E       wikilinks.0.display
E         Field required [type=missing, input_value={'target': 'link0'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.0.type
E         Field required [type=missing, input_value={'target': 'link0'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.1.display
E         Field required [type=missing, input_value={'target': 'link1'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.1.type
E         Field required [type=missing, input_value={'target': 'link1'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.2.display
E         Field required [type=missing, input_value={'target': 'link2'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.2.type
E         Field required [type=missing, input_value={'target': 'link2'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.3.display
E         Field required [type=missing, input_value={'target': 'link3'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.3.type
E         Field required [type=missing, input_value={'target': 'link3'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.4.display
E         Field required [type=missing, input_value={'target': 'link4'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       wikilinks.4.type
E         Field required [type=missing, input_value={'target': 'link4'}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing

tools\wiki_to_chromadb\tests\unit\test_broadcast_metadata.py:100: ValidationError
_____________ TestEnhancedYearExtraction.test_century_expressions _____________

self = <tools.wiki_to_chromadb.tests.unit.test_metadata_enrichment_v2.TestEnhancedYearExtraction object at 0x0000024D7A3AB220>

    def test_century_expressions(self):
        """Test century expressions are extracted correctly"""
        text = "In the late 23rd century, civilization rebuilt."
        year_min, year_max = self.enricher.extract_year_range(text, "Future")
    
        assert year_min == 2267
>       assert year_max == 2299
E       assert 2267 == 2299

tools\wiki_to_chromadb\tests\unit\test_metadata_enrichment_v2.py:75: AssertionError
__ TestEnhancedLocationClassification.test_specific_location_classification ___

self = <tools.wiki_to_chromadb.tests.unit.test_metadata_enrichment_v2.TestEnhancedLocationClassification object at 0x0000024D7A3ABE50>

    def test_specific_location_classification(self):
        """Test that specific locations are properly classified"""
        text = "Appalachia was devastated by the war. West Virginia became a wasteland."
        location, confidence = self.enricher.classify_location(text, "Appalachia")
    
>       assert location == "appalachia"
E       AssertionError: assert 'Appalachia' == 'appalachia'
E         
E         - appalachia
E         ? ^
E         + Appalachia
E         ? ^

tools\wiki_to_chromadb\tests\unit\test_metadata_enrichment_v2.py:114: AssertionError
__________________ TestEnrichChunk.test_enrich_faction_chunk __________________

self = <tools.wiki_to_chromadb.tests.unit.test_metadata_enrichment_v2.TestEnrichChunk object at 0x0000024D7A3D1C90>

    def test_enrich_faction_chunk(self):
        """Test enriching a faction-related chunk"""
>       metadata = ChunkMetadata(
            title="Brotherhood of Steel",
            section_path="History",
            section_level=1,
            chunk_index=0,
            infobox_type=None
        )
E       pydantic_core._pydantic_core.ValidationError: 4 validation errors for ChunkMetadata
E       wiki_title
E         Field required [type=missing, input_value={'title': 'Brotherhood of...0, 'infobox_type': None}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       timestamp
E         Field required [type=missing, input_value={'title': 'Brotherhood of...0, 'infobox_type': None}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       section
E         Field required [type=missing, input_value={'title': 'Brotherhood of...0, 'infobox_type': None}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       total_chunks
E         Field required [type=missing, input_value={'title': 'Brotherhood of...0, 'infobox_type': None}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing

tools\wiki_to_chromadb\tests\unit\test_metadata_enrichment_v2.py:247: ValidationError
_________________ TestEnrichChunk.test_enrich_location_chunk __________________

self = <tools.wiki_to_chromadb.tests.unit.test_metadata_enrichment_v2.TestEnrichChunk object at 0x0000024D7A3D1F30>

    def test_enrich_location_chunk(self):
        """Test enriching a location-related chunk"""
>       metadata = ChunkMetadata(
            title="Appalachia",
            section_path="Overview",
            section_level=1,
            chunk_index=0,
            infobox_type=None
        )
E       pydantic_core._pydantic_core.ValidationError: 4 validation errors for ChunkMetadata
E       wiki_title
E         Field required [type=missing, input_value={'title': 'Appalachia', '...0, 'infobox_type': None}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       timestamp
E         Field required [type=missing, input_value={'title': 'Appalachia', '...0, 'infobox_type': None}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       section
E         Field required [type=missing, input_value={'title': 'Appalachia', '...0, 'infobox_type': None}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       total_chunks
E         Field required [type=missing, input_value={'title': 'Appalachia', '...0, 'infobox_type': None}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing

tools\wiki_to_chromadb\tests\unit\test_metadata_enrichment_v2.py:268: ValidationError
_______________ TestEnrichChunk.test_knowledge_tier_assignment ________________

self = <tools.wiki_to_chromadb.tests.unit.test_metadata_enrichment_v2.TestEnrichChunk object at 0x0000024D7A3D21D0>

    def test_knowledge_tier_assignment(self):
        """Test knowledge tier assignment based on confidence"""
>       metadata = ChunkMetadata(
            title="Test Article",
            section_path="Content",
            section_level=1,
            chunk_index=0,
            infobox_type=None
        )
E       pydantic_core._pydantic_core.ValidationError: 4 validation errors for ChunkMetadata
E       wiki_title
E         Field required [type=missing, input_value={'title': 'Test Article',...0, 'infobox_type': None}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       timestamp
E         Field required [type=missing, input_value={'title': 'Test Article',...0, 'infobox_type': None}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       section
E         Field required [type=missing, input_value={'title': 'Test Article',...0, 'infobox_type': None}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing
E       total_chunks
E         Field required [type=missing, input_value={'title': 'Test Article',...0, 'infobox_type': None}, input_type=dict]
E           For further information visit https://errors.pydantic.dev/2.9/v/missing

tools\wiki_to_chromadb\tests\unit\test_metadata_enrichment_v2.py:288: ValidationError
_________ TestMetadataAuditor.test_generate_audit_reports_without_db __________

self = <tools.wiki_to_chromadb.tests.unit.test_phase6_audit.TestMetadataAuditor object at 0x0000024D7A3D0610>
tmp_path = WindowsPath('C:/Users/doghe/AppData/Local/Temp/pytest-of-doghe/pytest-210/test_generate_audit_reports_wi0')

    def test_generate_audit_reports_without_db(self, tmp_path):
        """Test audit report generation without database"""
        auditor = MetadataAuditor("nonexistent_db")
    
        # Generate reports to temp directory
>       auditor.generate_audit_reports(str(tmp_path))

tools\wiki_to_chromadb\tests\unit\test_phase6_audit.py:121: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tools\wiki_to_chromadb\phase6_metadata_audit.py:484: in generate_audit_reports
    self._generate_markdown_report(output_path, timestamp, summary)
tools\wiki_to_chromadb\phase6_metadata_audit.py:644: in _generate_markdown_report
    f.write(report)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <encodings.cp1252.IncrementalEncoder object at 0x0000024D0656B100>
input = '# Phase 6: Metadata Audit Report\r\n\r\n**Date**: 2026-01-20T12:29:49.760947  \r\n**Chunks Audited**: 0  \r\n**Databa...949.json`\r\n- `phase6_knowledge_tier_audit_20260120_122949.json`\r\n- `phase6_audit_summary_20260120_122949.json`\r\n'
final = False

    def encode(self, input, final=False):
>       return codecs.charmap_encode(input,self.errors,encoding_table)[0]
E       UnicodeEncodeError: 'charmap' codec can't encode character '\u2705' in position 1715: character maps to <undefined>

C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\encodings\cp1252.py:19: UnicodeEncodeError
------------------------------ Captured log call ------------------------------
WARNING  wiki_to_chromadb.tools.wiki_to_chromadb.phase6_metadata_audit:phase6_metadata_audit.py:52 Could not connect to ChromaDB: Collection [fallout_wiki] does not exist
WARNING  wiki_to_chromadb.tools.wiki_to_chromadb.phase6_metadata_audit:phase6_metadata_audit.py:77 No database connection, skipping audit
WARNING  wiki_to_chromadb.tools.wiki_to_chromadb.phase6_metadata_audit:phase6_metadata_audit.py:211 No database connection, skipping audit
WARNING  wiki_to_chromadb.tools.wiki_to_chromadb.phase6_metadata_audit:phase6_metadata_audit.py:306 No database connection, skipping audit
WARNING  wiki_to_chromadb.tools.wiki_to_chromadb.phase6_metadata_audit:phase6_metadata_audit.py:389 No database connection, skipping audit
_____________ TestMetadataAuditor.test_markdown_report_generation _____________

self = <tools.wiki_to_chromadb.tests.unit.test_phase6_audit.TestMetadataAuditor object at 0x0000024D7A3D3D00>
tmp_path = WindowsPath('C:/Users/doghe/AppData/Local/Temp/pytest-of-doghe/pytest-210/test_markdown_report_generatio0')

    def test_markdown_report_generation(self, tmp_path):
        """Test markdown report content"""
        auditor = MetadataAuditor("nonexistent_db")
        auditor.stats['total_checked'] = 1000
        auditor.stats['invalid_range'] = 50
    
        summary = auditor._generate_summary_stats()
>       auditor._generate_markdown_report(tmp_path, "test", summary)

tools\wiki_to_chromadb\tests\unit\test_phase6_audit.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tools\wiki_to_chromadb\phase6_metadata_audit.py:644: in _generate_markdown_report
    f.write(report)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <encodings.cp1252.IncrementalEncoder object at 0x0000024D0B250820>
input = '# Phase 6: Metadata Audit Report\r\n\r\n**Date**: 2026-01-20T12:29:49.830063  \r\n**Chunks Audited**: 1,000  \r\n**Da...6_content_type_audit_test.json`\r\n- `phase6_knowledge_tier_audit_test.json`\r\n- `phase6_audit_summary_test.json`\r\n'
final = False

    def encode(self, input, final=False):
>       return codecs.charmap_encode(input,self.errors,encoding_table)[0]
E       UnicodeEncodeError: 'charmap' codec can't encode character '\u2705' in position 1740: character maps to <undefined>

C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\encodings\cp1252.py:19: UnicodeEncodeError
------------------------------ Captured log call ------------------------------
WARNING  wiki_to_chromadb.tools.wiki_to_chromadb.phase6_metadata_audit:phase6_metadata_audit.py:52 Could not connect to ChromaDB: Collection [fallout_wiki] does not exist
___________________________ test_enhanced_generator ___________________________

    def test_enhanced_generator():
        """Test Phase 2.6 enhancements"""
        print("="*80)
        print("Testing Enhanced Generator (Phase 2.6)")
        print("="*80)
    
        # Initialize
        generator = ScriptGenerator()
    
        # Test 1: Weather script with catchphrase rotation
        print("\n\nTEST 1: Weather script with catchphrase rotation")
        print("-"*80)
    
>       result1 = generator.generate_script(
            script_type="weather",
            dj_name="Julie (2102, Appalachia)",
            context_query="Appalachia weather sunny morning conditions",
            weather_type="sunny",
            time_of_day="morning",
            hour=8,
            temperature=72,
            enable_catchphrase_rotation=True,
            enable_natural_voice=True,
            enable_validation_retry=True
        )

tools\script-generator\tests\test_enhanced_generator.py:25: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tools\script-generator\generator.py:531: in generate_script
    prompt = template.render(
C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\environment.py:1295: in render
    self.environment.handle_exception()
C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\environment.py:942: in handle_exception
    raise rewrite_traceback_stack(source=source)
tools\script-generator\templates\weather.jinja2:73: in top-level template code
    {% if weather_continuity.weather_changed %}
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <jinja2.environment.Environment object at 0x0000024D0B33FE50>
obj = Undefined, attribute = 'weather_changed'

    def getattr(self, obj: t.Any, attribute: str) -> t.Any:
        """Get an item or attribute of an object but prefer the attribute.
        Unlike :meth:`getitem` the attribute *must* be a string.
        """
        try:
>           return getattr(obj, attribute)
E           jinja2.exceptions.UndefinedError: 'weather_continuity' is undefined

C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\environment.py:490: UndefinedError
---------------------------- Captured stdout call -----------------------------
================================================================================
Testing Enhanced Generator (Phase 2.6)
================================================================================
Initializing Script Generator...
  Templates: C:\esp32-project\tools\script-generator\templates
  ChromaDB:  C:\esp32-project\chroma_db
  Ollama:    http://localhost:11434
Loaded existing collection 'fallout_wiki'
[OK] RAG Cache initialized (max_size=100, ttl=1800s)
[OK] Connected to Ollama
[OK] ChromaDB loaded (291,343 chunks)


TEST 1: Weather script with catchphrase rotation
--------------------------------------------------------------------------------

================================================================================
Generating WEATHER script for Julie (2102, Appalachia)
================================================================================

[1/5] Loading personality...
[OK] Loaded: Julie (2102, Appalachia)
[OK] Catchphrase selected: Welcome home, Appalachia.

[2/5] Querying RAG database...
  Query: Appalachia weather sunny morning conditions
[OK] Retrieved 5 results (fresh)
      Cache: 0.0% hit rate, 0 hits, 1 misses
  Using top 3 chunks (955 chars)

[3/5] Rendering template...

ðŸ”„ Retry attempt 1/5...

[1/5] Loading personality...
[OK] Loaded: Julie (2102, Appalachia)
[OK] Catchphrase selected: I'm just happy to be here, playing music for you guys.

[2/5] Querying RAG database...
  Query: Appalachia weather sunny morning conditions
[OK] Retrieved 5 results (cached)
      Cache: 0.5% hit rate, 1 hits, 1 misses
  Using top 3 chunks (955 chars)

[3/5] Rendering template...

ðŸ”„ Retry attempt 2/5...

[1/5] Loading personality...
[OK] Loaded: Julie (2102, Appalachia)
[OK] Catchphrase selected: If you're out there, and you're listening... you are not alone.

[2/5] Querying RAG database...
  Query: Appalachia weather sunny morning conditions
[OK] Retrieved 5 results (cached)
      Cache: 0.7% hit rate, 2 hits, 1 misses
  Using top 3 chunks (955 chars)

[3/5] Rendering template...

ðŸ”„ Retry attempt 3/5...

[1/5] Loading personality...
[OK] Loaded: Julie (2102, Appalachia)

[2/5] Querying RAG database...
  Query: Appalachia weather sunny morning conditions
[OK] Retrieved 5 results (cached)
      Cache: 0.8% hit rate, 3 hits, 1 misses
  Using top 3 chunks (955 chars)

[3/5] Rendering template...

ðŸ”„ Retry attempt 4/5...

[1/5] Loading personality...
[OK] Loaded: Julie (2102, Appalachia)

[2/5] Querying RAG database...
  Query: Appalachia weather sunny morning conditions
[OK] Retrieved 5 results (cached)
      Cache: 0.8% hit rate, 4 hits, 1 misses
  Using top 3 chunks (955 chars)

[3/5] Rendering template...

ðŸ”„ Retry attempt 5/5...

[1/5] Loading personality...
[OK] Loaded: Julie (2102, Appalachia)
[OK] Catchphrase selected: If you're out there, and you're listening... you are not alone.

[2/5] Querying RAG database...
  Query: Appalachia weather sunny morning conditions
[OK] Retrieved 5 results (cached)
      Cache: 0.8% hit rate, 5 hits, 1 misses
  Using top 3 chunks (955 chars)

[3/5] Rendering template...
________________ TestFullPipeline.test_generate_weather_script ________________

self = <test_generator.TestFullPipeline testMethod=test_generate_weather_script>

    def test_generate_weather_script(self):
        """Test full weather script generation"""
>       result = self.generator.generate_script(
            script_type="weather",
            dj_name="Julie (2102, Appalachia)",
            context_query="Appalachia weather sunny",
            weather_type="sunny",
            time_of_day="morning",
            hour=8,
            temperature=70,
            n_results=3
        )

tools\script-generator\tests\test_generator.py:189: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tools\script-generator\generator.py:531: in generate_script
    prompt = template.render(
C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\environment.py:1295: in render
    self.environment.handle_exception()
C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\environment.py:942: in handle_exception
    raise rewrite_traceback_stack(source=source)
tools\script-generator\templates\weather.jinja2:73: in top-level template code
    {% if weather_continuity.weather_changed %}
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <jinja2.environment.Environment object at 0x0000024D06522440>
obj = Undefined, attribute = 'weather_changed'

    def getattr(self, obj: t.Any, attribute: str) -> t.Any:
        """Get an item or attribute of an object but prefer the attribute.
        Unlike :meth:`getitem` the attribute *must* be a string.
        """
        try:
>           return getattr(obj, attribute)
E           jinja2.exceptions.UndefinedError: 'weather_continuity' is undefined

C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\environment.py:490: UndefinedError
---------------------------- Captured stdout call -----------------------------

================================================================================
Generating WEATHER script for Julie (2102, Appalachia)
================================================================================

[1/5] Loading personality...
[OK] Loaded: Julie (2102, Appalachia)

[2/5] Querying RAG database...
  Query: Appalachia weather sunny
[OK] Retrieved 3 results (cached)
      Cache: 0.8% hit rate, 12 hits, 4 misses
  Using top 3 chunks (1118 chars)

[3/5] Rendering template...

ðŸ”„ Retry attempt 1/5...

[1/5] Loading personality...
[OK] Loaded: Julie (2102, Appalachia)
[OK] Catchphrase selected: Welcome home, Appalachia.

[2/5] Querying RAG database...
  Query: Appalachia weather sunny
[OK] Retrieved 3 results (cached)
      Cache: 0.8% hit rate, 13 hits, 4 misses
  Using top 3 chunks (1118 chars)

[3/5] Rendering template...

ðŸ”„ Retry attempt 2/5...

[1/5] Loading personality...
[OK] Loaded: Julie (2102, Appalachia)
[OK] Catchphrase selected: I'm just happy to be here, playing music for you guys.

[2/5] Querying RAG database...
  Query: Appalachia weather sunny
[OK] Retrieved 3 results (cached)
      Cache: 0.8% hit rate, 14 hits, 4 misses
  Using top 3 chunks (1118 chars)

[3/5] Rendering template...

ðŸ”„ Retry attempt 3/5...

[1/5] Loading personality...
[OK] Loaded: Julie (2102, Appalachia)
[OK] Catchphrase selected: If you're out there, and you're listening... you are not alone.

[2/5] Querying RAG database...
  Query: Appalachia weather sunny
[OK] Retrieved 3 results (cached)
      Cache: 0.8% hit rate, 15 hits, 4 misses
  Using top 3 chunks (1118 chars)

[3/5] Rendering template...

ðŸ”„ Retry attempt 4/5...

[1/5] Loading personality...
[OK] Loaded: Julie (2102, Appalachia)

[2/5] Querying RAG database...
  Query: Appalachia weather sunny
[OK] Retrieved 3 results (cached)
      Cache: 0.8% hit rate, 16 hits, 4 misses
  Using top 3 chunks (1118 chars)

[3/5] Rendering template...

ðŸ”„ Retry attempt 5/5...

[1/5] Loading personality...
[OK] Loaded: Julie (2102, Appalachia)
[OK] Catchphrase selected: Welcome home, Appalachia.

[2/5] Querying RAG database...
  Query: Appalachia weather sunny
[OK] Retrieved 3 results (cached)
      Cache: 0.8% hit rate, 17 hits, 4 misses
  Using top 3 chunks (1118 chars)

[3/5] Rendering template...
______________________ TestFullPipeline.test_save_script ______________________

self = <test_generator.TestFullPipeline testMethod=test_save_script>

    def test_save_script(self):
        """Test script saving"""
>       result = self.generator.generate_script(
            script_type="weather",
            dj_name="Julie (2102, Appalachia)",
            context_query="Appalachia weather",
            weather_type="sunny",
            time_of_day="morning",
            hour=8,
            temperature=70,
            n_results=2
        )

tools\script-generator\tests\test_generator.py:238: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tools\script-generator\generator.py:531: in generate_script
    prompt = template.render(
C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\environment.py:1295: in render
    self.environment.handle_exception()
C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\environment.py:942: in handle_exception
    raise rewrite_traceback_stack(source=source)
tools\script-generator\templates\weather.jinja2:73: in top-level template code
    {% if weather_continuity.weather_changed %}
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <jinja2.environment.Environment object at 0x0000024D06522440>
obj = Undefined, attribute = 'weather_changed'

    def getattr(self, obj: t.Any, attribute: str) -> t.Any:
        """Get an item or attribute of an object but prefer the attribute.
        Unlike :meth:`getitem` the attribute *must* be a string.
        """
        try:
>           return getattr(obj, attribute)
E           jinja2.exceptions.UndefinedError: 'weather_continuity' is undefined

C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\environment.py:490: UndefinedError
---------------------------- Captured stdout call -----------------------------

================================================================================
Generating WEATHER script for Julie (2102, Appalachia)
================================================================================

[1/5] Loading personality...
[OK] Loaded: Julie (2102, Appalachia)
[OK] Catchphrase selected: Welcome home, Appalachia.

[2/5] Querying RAG database...
  Query: Appalachia weather
[OK] Retrieved 2 results (cached)
      Cache: 0.8% hit rate, 17 hits, 5 misses
  Using top 2 chunks (665 chars)

[3/5] Rendering template...

ðŸ”„ Retry attempt 1/5...

[1/5] Loading personality...
[OK] Loaded: Julie (2102, Appalachia)
[OK] Catchphrase selected: I'm just happy to be here, playing music for you guys.

[2/5] Querying RAG database...
  Query: Appalachia weather
[OK] Retrieved 2 results (cached)
      Cache: 0.8% hit rate, 18 hits, 5 misses
  Using top 2 chunks (665 chars)

[3/5] Rendering template...

ðŸ”„ Retry attempt 2/5...

[1/5] Loading personality...
[OK] Loaded: Julie (2102, Appalachia)

[2/5] Querying RAG database...
  Query: Appalachia weather
[OK] Retrieved 2 results (cached)
      Cache: 0.8% hit rate, 19 hits, 5 misses
  Using top 2 chunks (665 chars)

[3/5] Rendering template...

ðŸ”„ Retry attempt 3/5...

[1/5] Loading personality...
[OK] Loaded: Julie (2102, Appalachia)
[OK] Catchphrase selected: If you're out there, and you're listening... you are not alone.

[2/5] Querying RAG database...
  Query: Appalachia weather
[OK] Retrieved 2 results (cached)
      Cache: 0.8% hit rate, 20 hits, 5 misses
  Using top 2 chunks (665 chars)

[3/5] Rendering template...

ðŸ”„ Retry attempt 4/5...

[1/5] Loading personality...
[OK] Loaded: Julie (2102, Appalachia)
[OK] Catchphrase selected: Welcome home, Appalachia.

[2/5] Querying RAG database...
  Query: Appalachia weather
[OK] Retrieved 2 results (cached)
      Cache: 0.8% hit rate, 21 hits, 5 misses
  Using top 2 chunks (665 chars)

[3/5] Rendering template...

ðŸ”„ Retry attempt 5/5...

[1/5] Loading personality...
[OK] Loaded: Julie (2102, Appalachia)
[OK] Catchphrase selected: If you're out there, and you're listening... you are not alone.

[2/5] Querying RAG database...
  Query: Appalachia weather
[OK] Retrieved 2 results (cached)
      Cache: 0.8% hit rate, 22 hits, 5 misses
  Using top 2 chunks (665 chars)

[3/5] Rendering template...
___________ TestGeneratorCacheIntegration.test_cache_report_prints ____________

self = <test_generator_cache_integration.TestGeneratorCacheIntegration object at 0x0000024D7A4EDF30>
mock_dependencies = {'chromadb': <MagicMock name='ChromaDBIngestor' id='2529922896688'>, 'db_instance': <Mock name='ChromaDBIngestor()' id...<MagicMock name='OllamaClient' id='2529841432320'>, 'ollama_instance': <Mock name='OllamaClient()' id='2529841819280'>}
capsys = <_pytest.capture.CaptureFixture object at 0x0000024D064EC700>

    def test_cache_report_prints(self, mock_dependencies, capsys):
        """Test print_cache_report method"""
        from generator import ScriptGenerator
    
        gen = ScriptGenerator()
>       gen.print_cache_report()

tools\script-generator\tests\test_generator_cache_integration.py:131: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <generator.ScriptGenerator object at 0x0000024D064EDC30>

    def print_cache_report(self):
        """
        Print detailed cache performance report.
    
        Phase 1 Checkpoint 1.2: Cache reporting
        """
        stats = self.rag_cache.get_statistics()
    
        print("\n" + "="*60)
        print("RAG CACHE PERFORMANCE REPORT")
        print("="*60)
        print(f"Cache Size:        {stats['cache_size']} / {stats['max_cache_size']} entries")
        print(f"Hit Rate:          {stats['hit_rate']:.1f}%")
        print(f"Total Queries:     {stats['total_queries']}")
        print(f"  - Cache Hits:    {stats['cache_hits']}")
        print(f"  - Cache Misses:  {stats['cache_misses']}")
        print(f"Evictions:         {stats['evictions']}")
        print(f"Expired Entries:   {stats['expired_entries']}")
>       print(f"Topics Cached:     {len(stats['topics_cached'])}")
E       KeyError: 'topics_cached'

tools\script-generator\generator.py:1075: KeyError
---------------------------- Captured stdout call -----------------------------
Initializing Script Generator...
  Templates: C:\esp32-project\tools\script-generator\templates
  ChromaDB:  C:\esp32-project\chroma_db
  Ollama:    http://localhost:11434
[OK] RAG Cache initialized (max_size=100, ttl=1800s)
[OK] Connected to Ollama
[OK] ChromaDB loaded (1,000 chunks)

============================================================
RAG CACHE PERFORMANCE REPORT
============================================================
Cache Size:        0 / 100 entries
Hit Rate:          0.0%
Total Queries:     0
  - Cache Hits:    0
  - Cache Misses:  0
Evictions:         0
Expired Entries:   0
_________ TestConstraintEmbedding.test_constraint_embedding_in_prompt _________

self = <test_llm_pipeline.TestConstraintEmbedding testMethod=test_constraint_embedding_in_prompt>

    def test_constraint_embedding_in_prompt(self):
        """Test that constraints are properly embedded in system prompt"""
>       constraints = ValidationConstraints(
            max_year=2287,
            forbidden_topics=["Institute", "Railroad"],
            forbidden_factions=["Enclave"],
            tone="informative",
            max_length=400
        )
E       TypeError: ValidationConstraints.__init__() got an unexpected keyword argument 'tone'

tools\script-generator\tests\test_llm_pipeline.py:38: TypeError
_______ TestValidationGuidedGeneration.test_single_llm_call_generation ________

self = <test_llm_pipeline.TestValidationGuidedGeneration testMethod=test_single_llm_call_generation>

    def test_single_llm_call_generation(self):
        """Test that only one LLM call is made (key innovation)"""
>       constraints = ValidationConstraints(
            max_year=2287,
            forbidden_topics=["Institute"],
            tone="casual"
        )
E       TypeError: ValidationConstraints.__init__() got an unexpected keyword argument 'tone'

tools\script-generator\tests\test_llm_pipeline.py:113: TypeError
__________ TestSchedulerIntegration.test_generate_from_segment_plan ___________

self = <test_llm_pipeline.TestSchedulerIntegration testMethod=test_generate_from_segment_plan>

    def test_generate_from_segment_plan(self):
        """Test generation from SegmentPlan (Phase 2 integration)"""
>       constraints = ValidationConstraints(
            max_year=2287,
            forbidden_topics=["Institute"],
            tone="casual"
        )
E       TypeError: ValidationConstraints.__init__() got an unexpected keyword argument 'tone'

tools\script-generator\tests\test_llm_pipeline.py:249: TypeError
________________ TestMetricsTracking.test_average_calculations ________________

self = <test_llm_pipeline.TestMetricsTracking testMethod=test_average_calculations>

    def test_average_calculations(self):
        """Test that averages are calculated correctly"""
        constraints = ValidationConstraints(max_year=2287)
        dj_context = {'name': 'Julie', 'year': 2287}
    
        for _ in range(10):
            self.pipeline.generate_with_validation(
                template='news',
                lore_chunks=[],
                constraints=constraints,
                dj_context=dj_context
            )
    
        metrics = self.pipeline.get_metrics()
    
        # Verify calculations
>       self.assertGreater(metrics['avg_generation_time_ms'], 0)
E       AssertionError: 0 not greater than 0

tools\script-generator\tests\test_llm_pipeline.py:371: AssertionError
_________________ TestBroadcastScheduler.test_scheduler_init __________________

self = <test_phase1_session_state.TestBroadcastScheduler object at 0x0000024D7A539F00>

    def test_scheduler_init(self):
        """Test BroadcastScheduler initialization."""
        scheduler = BroadcastScheduler()
    
>       assert scheduler.last_segment_times is not None
E       AttributeError: 'BroadcastScheduler' object has no attribute 'last_segment_times'

tools\script-generator\tests\test_phase1_session_state.py:316: AttributeError
__________ TestBroadcastScheduler.test_segment_interval_enforcement ___________

self = <test_phase1_session_state.TestBroadcastScheduler object at 0x0000024D7A5397B0>

    def test_segment_interval_enforcement(self):
        """Test that intervals are enforced."""
        scheduler = BroadcastScheduler()
    
        # Record weather generation
        scheduler.record_segment_generated("weather")
    
        # Should not be ready immediately
>       assert scheduler.is_time_for_segment("weather") == False
E       AssertionError: assert True == False
E        +  where True = is_time_for_segment('weather')
E        +    where is_time_for_segment = <broadcast_scheduler.BroadcastScheduler object at 0x0000024D0B233490>.is_time_for_segment

tools\script-generator\tests\test_phase1_session_state.py:364: AssertionError
______________ TestBroadcastScheduler.test_next_priority_segment ______________

self = <test_phase1_session_state.TestBroadcastScheduler object at 0x0000024D7A538D30>

    def test_next_priority_segment(self):
        """Test getting next priority segment."""
        scheduler = BroadcastScheduler()
    
        next_seg = scheduler.get_next_priority_segment()
    
        # Should get something (all are ready initially)
>       assert next_seg is not None
E       assert None is not None

tools\script-generator\tests\test_phase1_session_state.py:376: AssertionError
_________________ TestBroadcastScheduler.test_segments_status _________________

self = <test_phase1_session_state.TestBroadcastScheduler object at 0x0000024D7A538340>

    def test_segments_status(self):
        """Test getting segments status."""
        scheduler = BroadcastScheduler()
    
        status = scheduler.get_segments_status()
    
>       assert "weather" in status
E       AssertionError: assert 'weather' in {'news_done': [], 'news_hours': [], 'time_checks_done': [], 'weather_done': [], ...}

tools\script-generator\tests\test_phase1_session_state.py:385: AssertionError
_________________ TestBroadcastScheduler.test_scheduler_reset _________________

self = <test_phase1_session_state.TestBroadcastScheduler object at 0x0000024D7A53A8F0>

    def test_scheduler_reset(self):
        """Test resetting scheduler."""
        scheduler = BroadcastScheduler()
    
        scheduler.record_segment_generated("weather")
>       assert scheduler.is_time_for_segment("weather") == False
E       AssertionError: assert True == False
E        +  where True = is_time_for_segment('weather')
E        +    where is_time_for_segment = <broadcast_scheduler.BroadcastScheduler object at 0x0000024D0B1F6650>.is_time_for_segment

tools\script-generator\tests\test_phase1_session_state.py:396: AssertionError
_____________ TestBroadcastScheduler.test_time_priority_variation _____________

self = <test_phase1_session_state.TestBroadcastScheduler object at 0x0000024D7A53AB60>

    def test_time_priority_variation(self):
        """Test that priorities vary by time of day."""
        scheduler = BroadcastScheduler()
    
>       morning_priorities = scheduler.time_of_day_priorities[TimeOfDay.MORNING]
E       AttributeError: 'BroadcastScheduler' object has no attribute 'time_of_day_priorities'

tools\script-generator\tests\test_phase1_session_state.py:405: AttributeError
_________________ TestPhase6Validator.test_query_performance __________________

self = <test_phase6_validation.TestPhase6Validator testMethod=test_query_performance>
mock_profile = <MagicMock name='JulieProfile' id='2529841820336'>
mock_db = <MagicMock name='ChromaDBManager' id='2529923642080'>

    @patch('phase6_validation.ChromaDBManager')
    @patch('phase6_validation.JulieProfile')
    def test_query_performance(self, mock_profile, mock_db):
        """Test query performance benchmark."""
        # Mock profile
        mock_profile_instance = Mock()
        mock_profile_instance.get_base_filter.return_value = {}
        mock_profile_instance.get_enhanced_filter.return_value = {}
        mock_profile.return_value = mock_profile_instance
    
        # Mock database
        mock_collection = Mock()
        mock_collection.query.return_value = {'ids': [['chunk1']]}
    
        mock_db_instance = Mock()
        mock_db_instance.collection = mock_collection
        self.validator.db_manager = mock_db_instance
    
        # Run test
        results = self.validator.benchmark_query_performance(num_queries=10)
    
        # Assertions
        self.assertEqual(results['total_queries'], 10)
        self.assertIn('baseline_avg', results)
        self.assertIn('enhanced_avg', results)
>       self.assertIn('overhead_ms', results)
E       AssertionError: 'overhead_ms' not found in {'total_queries': 10, 'query_times': [], 'baseline_times': [0.0, 0.0, 0.0, 0.0, 0.0], 'enhanced_times': [0.0, 0.0, 0.0, 0.0, 0.0], 'baseline_avg': 0.0, 'baseline_min': 0.0, 'baseline_max': 0.0, 'enhanced_avg': 0.0, 'enhanced_min': 0.0, 'enhanced_max': 0.0}

tools\script-generator\tests\test_phase6_validation.py:218: AssertionError
---------------------------- Captured stdout call -----------------------------

âš¡ Benchmarking Query Performance (10 queries)...
âœ… Performance benchmark complete
   Baseline avg: 0.00ms
   Enhanced avg: 0.00ms
   Overhead: 0.00ms (0.0%)
___________________ TestRAGCache.test_cache_miss_and_store ____________________

self = <test_rag_cache.TestRAGCache object at 0x0000024D7A5FC0D0>
rag_cache = <rag_cache.RAGCache object at 0x0000024D0B1B9630>

    def test_cache_miss_and_store(self, rag_cache):
        """Test cache miss causes DB query and stores result"""
        # Mock the internal ChromaDB query method
        rag_cache.chromadb.query = Mock(return_value={
            'ids': [['chunk1']],
            'documents': [['Test document']],
            'metadatas': [[{'year': 2102}]],
            'distances': [[0.1]]
        })
    
        dj_context = {'name': 'Julie', 'year': 2102, 'region': 'Appalachia'}
    
        # First query - should miss cache
>       results = rag_cache.query_with_cache("test query", dj_context, num_chunks=5)

tools\script-generator\tests\test_rag_cache.py:201: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tools\script-generator\rag_cache.py:343: in query_with_cache
    results = query_for_dj(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

ingestor = <Mock id='2529922090080'>, dj_name = 'Julie'
query_text = 'test query', n_results = 5

    def query_for_dj(ingestor: ChromaDBIngestor, dj_name: str,
                    query_text: str, n_results: int = 10) -> Dict[str, Any]:
        """
        Query ChromaDB with DJ-specific filtering.
    
        Args:
            ingestor: ChromaDBIngestor instance
            dj_name: DJ name (must match DJ_QUERY_FILTERS keys)
            query_text: Query string
            n_results: Number of results
    
        Returns:
            Query results
        """
        if dj_name not in DJ_QUERY_FILTERS:
>           raise ValueError(f"Unknown DJ: {dj_name}. Available: {list(DJ_QUERY_FILTERS.keys())}")
E           ValueError: Unknown DJ: Julie. Available: ['Julie (2102, Appalachia)', 'Mr. New Vegas (2281, Mojave)', 'Travis Miles Nervous (2287, Commonwealth)', 'Travis Miles Confident (2287, Commonwealth)']

tools\wiki_to_chromadb\chromadb_ingest.py:345: ValueError
_________________________ TestRAGCache.test_cache_hit _________________________

self = <test_rag_cache.TestRAGCache object at 0x0000024D7A5FC2E0>
rag_cache = <rag_cache.RAGCache object at 0x0000024D0B251900>

    def test_cache_hit(self, rag_cache):
        """Test cache hit on repeated query"""
        rag_cache.chromadb.query = Mock(return_value={
            'ids': [['chunk1']],
            'documents': [['Test document']],
            'metadatas': [[{'year': 2102}]],
            'distances': [[0.1]]
        })
    
        dj_context = {'name': 'Julie', 'year': 2102, 'region': 'Appalachia'}
    
        # First query - miss
>       rag_cache.query_with_cache("test query", dj_context, num_chunks=5)

tools\script-generator\tests\test_rag_cache.py:219: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tools\script-generator\rag_cache.py:343: in query_with_cache
    results = query_for_dj(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

ingestor = <Mock id='2529922724816'>, dj_name = 'Julie'
query_text = 'test query', n_results = 5

    def query_for_dj(ingestor: ChromaDBIngestor, dj_name: str,
                    query_text: str, n_results: int = 10) -> Dict[str, Any]:
        """
        Query ChromaDB with DJ-specific filtering.
    
        Args:
            ingestor: ChromaDBIngestor instance
            dj_name: DJ name (must match DJ_QUERY_FILTERS keys)
            query_text: Query string
            n_results: Number of results
    
        Returns:
            Query results
        """
        if dj_name not in DJ_QUERY_FILTERS:
>           raise ValueError(f"Unknown DJ: {dj_name}. Available: {list(DJ_QUERY_FILTERS.keys())}")
E           ValueError: Unknown DJ: Julie. Available: ['Julie (2102, Appalachia)', 'Mr. New Vegas (2281, Mojave)', 'Travis Miles Nervous (2287, Commonwealth)', 'Travis Miles Confident (2287, Commonwealth)']

tools\wiki_to_chromadb\chromadb_ingest.py:345: ValueError
_______________________ TestRAGCache.test_lru_eviction ________________________

self = <test_rag_cache.TestRAGCache object at 0x0000024D7A5FC5B0>
rag_cache = <rag_cache.RAGCache object at 0x0000024D065694B0>

    def test_lru_eviction(self, rag_cache):
        """Test LRU eviction when cache is full"""
        rag_cache.max_cache_size = 3
    
        rag_cache.chromadb.query = Mock(return_value={
            'ids': [['chunk']],
            'documents': [['Doc']],
            'metadatas': [[{}]],
            'distances': [[0.1]]
        })
    
        dj_context = {'name': 'Julie', 'year': 2102}
    
        # Fill cache
>       rag_cache.query_with_cache("query 1", dj_context)

tools\script-generator\tests\test_rag_cache.py:241: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tools\script-generator\rag_cache.py:343: in query_with_cache
    results = query_for_dj(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

ingestor = <Mock id='2529842070432'>, dj_name = 'Julie', query_text = 'query 1'
n_results = 5

    def query_for_dj(ingestor: ChromaDBIngestor, dj_name: str,
                    query_text: str, n_results: int = 10) -> Dict[str, Any]:
        """
        Query ChromaDB with DJ-specific filtering.
    
        Args:
            ingestor: ChromaDBIngestor instance
            dj_name: DJ name (must match DJ_QUERY_FILTERS keys)
            query_text: Query string
            n_results: Number of results
    
        Returns:
            Query results
        """
        if dj_name not in DJ_QUERY_FILTERS:
>           raise ValueError(f"Unknown DJ: {dj_name}. Available: {list(DJ_QUERY_FILTERS.keys())}")
E           ValueError: Unknown DJ: Julie. Available: ['Julie (2102, Appalachia)', 'Mr. New Vegas (2281, Mojave)', 'Travis Miles Nervous (2287, Commonwealth)', 'Travis Miles Confident (2287, Commonwealth)']

tools\wiki_to_chromadb\chromadb_ingest.py:345: ValueError
________________________ TestRAGCache.test_custom_ttl _________________________

self = <test_rag_cache.TestRAGCache object at 0x0000024D7A5FC880>
rag_cache = <rag_cache.RAGCache object at 0x0000024D0B3314E0>

    def test_custom_ttl(self, rag_cache):
        """Test custom TTL for cache entry"""
        rag_cache.chromadb.query = Mock(return_value={
            'ids': [['chunk']],
            'documents': [['Doc']],
            'metadatas': [[{}]],
            'distances': [[0.1]]
        })
    
        dj_context = {'name': 'Julie', 'year': 2102}
    
        # Query with short TTL
>       rag_cache.query_with_cache("test", dj_context, ttl=1)

tools\script-generator\tests\test_rag_cache.py:265: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tools\script-generator\rag_cache.py:343: in query_with_cache
    results = query_for_dj(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

ingestor = <Mock id='2529923640208'>, dj_name = 'Julie', query_text = 'test'
n_results = 5

    def query_for_dj(ingestor: ChromaDBIngestor, dj_name: str,
                    query_text: str, n_results: int = 10) -> Dict[str, Any]:
        """
        Query ChromaDB with DJ-specific filtering.
    
        Args:
            ingestor: ChromaDBIngestor instance
            dj_name: DJ name (must match DJ_QUERY_FILTERS keys)
            query_text: Query string
            n_results: Number of results
    
        Returns:
            Query results
        """
        if dj_name not in DJ_QUERY_FILTERS:
>           raise ValueError(f"Unknown DJ: {dj_name}. Available: {list(DJ_QUERY_FILTERS.keys())}")
E           ValueError: Unknown DJ: Julie. Available: ['Julie (2102, Appalachia)', 'Mr. New Vegas (2281, Mojave)', 'Travis Miles Nervous (2287, Commonwealth)', 'Travis Miles Confident (2287, Commonwealth)']

tools\wiki_to_chromadb\chromadb_ingest.py:345: ValueError
____________________ TestRAGCache.test_topic_based_caching ____________________

self = <test_rag_cache.TestRAGCache object at 0x0000024D7A5FCB50>
rag_cache = <rag_cache.RAGCache object at 0x0000024D0B1BA170>

    def test_topic_based_caching(self, rag_cache):
        """Test topic-based cache indexing"""
        rag_cache.chromadb.query = Mock(return_value={
            'ids': [['chunk']],
            'documents': [['Regional climate data']],
            'metadatas': [[{}]],
            'distances': [[0.1]]
        })
    
        dj_context = {'name': 'Julie', 'year': 2102, 'region': 'Appalachia'}
    
        # Cache with topic
>       rag_cache.query_with_cache(
            "climate data",
            dj_context,
            topic='regional_climate'
        )

tools\script-generator\tests\test_rag_cache.py:290: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tools\script-generator\rag_cache.py:343: in query_with_cache
    results = query_for_dj(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

ingestor = <Mock id='2529922095792'>, dj_name = 'Julie'
query_text = 'climate data', n_results = 5

    def query_for_dj(ingestor: ChromaDBIngestor, dj_name: str,
                    query_text: str, n_results: int = 10) -> Dict[str, Any]:
        """
        Query ChromaDB with DJ-specific filtering.
    
        Args:
            ingestor: ChromaDBIngestor instance
            dj_name: DJ name (must match DJ_QUERY_FILTERS keys)
            query_text: Query string
            n_results: Number of results
    
        Returns:
            Query results
        """
        if dj_name not in DJ_QUERY_FILTERS:
>           raise ValueError(f"Unknown DJ: {dj_name}. Available: {list(DJ_QUERY_FILTERS.keys())}")
E           ValueError: Unknown DJ: Julie. Available: ['Julie (2102, Appalachia)', 'Mr. New Vegas (2281, Mojave)', 'Travis Miles Nervous (2287, Commonwealth)', 'Travis Miles Confident (2287, Commonwealth)']

tools\wiki_to_chromadb\chromadb_ingest.py:345: ValueError
__________________ TestRAGCache.test_cache_invalidation_all ___________________

self = <test_rag_cache.TestRAGCache object at 0x0000024D7A5FCE20>
rag_cache = <rag_cache.RAGCache object at 0x0000024D0B257C10>

    def test_cache_invalidation_all(self, rag_cache):
        """Test clearing entire cache"""
        rag_cache.chromadb.query = Mock(return_value={
            'ids': [['chunk']],
            'documents': [['Doc']],
            'metadatas': [[{}]],
            'distances': [[0.1]]
        })
    
        dj_context = {'name': 'Julie', 'year': 2102}
    
        # Add some entries
>       rag_cache.query_with_cache("query 1", dj_context)

tools\script-generator\tests\test_rag_cache.py:316: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tools\script-generator\rag_cache.py:343: in query_with_cache
    results = query_for_dj(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

ingestor = <Mock id='2529922738800'>, dj_name = 'Julie', query_text = 'query 1'
n_results = 5

    def query_for_dj(ingestor: ChromaDBIngestor, dj_name: str,
                    query_text: str, n_results: int = 10) -> Dict[str, Any]:
        """
        Query ChromaDB with DJ-specific filtering.
    
        Args:
            ingestor: ChromaDBIngestor instance
            dj_name: DJ name (must match DJ_QUERY_FILTERS keys)
            query_text: Query string
            n_results: Number of results
    
        Returns:
            Query results
        """
        if dj_name not in DJ_QUERY_FILTERS:
>           raise ValueError(f"Unknown DJ: {dj_name}. Available: {list(DJ_QUERY_FILTERS.keys())}")
E           ValueError: Unknown DJ: Julie. Available: ['Julie (2102, Appalachia)', 'Mr. New Vegas (2281, Mojave)', 'Travis Miles Nervous (2287, Commonwealth)', 'Travis Miles Confident (2287, Commonwealth)']

tools\wiki_to_chromadb\chromadb_ingest.py:345: ValueError
_________________ TestRAGCache.test_cache_invalidation_topic __________________

self = <test_rag_cache.TestRAGCache object at 0x0000024D7A5E33D0>
rag_cache = <rag_cache.RAGCache object at 0x0000024D064F54B0>

    def test_cache_invalidation_topic(self, rag_cache):
        """Test clearing topic-specific cache"""
        rag_cache.chromadb.query = Mock(return_value={
            'ids': [['chunk']],
            'documents': [['Doc']],
            'metadatas': [[{}]],
            'distances': [[0.1]]
        })
    
        dj_context = {'name': 'Julie', 'year': 2102}
    
        # Add entries with topics
>       rag_cache.query_with_cache("weather query", dj_context, topic='weather')

tools\script-generator\tests\test_rag_cache.py:339: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tools\script-generator\rag_cache.py:343: in query_with_cache
    results = query_for_dj(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

ingestor = <Mock id='2529841599952'>, dj_name = 'Julie'
query_text = 'weather query', n_results = 5

    def query_for_dj(ingestor: ChromaDBIngestor, dj_name: str,
                    query_text: str, n_results: int = 10) -> Dict[str, Any]:
        """
        Query ChromaDB with DJ-specific filtering.
    
        Args:
            ingestor: ChromaDBIngestor instance
            dj_name: DJ name (must match DJ_QUERY_FILTERS keys)
            query_text: Query string
            n_results: Number of results
    
        Returns:
            Query results
        """
        if dj_name not in DJ_QUERY_FILTERS:
>           raise ValueError(f"Unknown DJ: {dj_name}. Available: {list(DJ_QUERY_FILTERS.keys())}")
E           ValueError: Unknown DJ: Julie. Available: ['Julie (2102, Appalachia)', 'Mr. New Vegas (2281, Mojave)', 'Travis Miles Nervous (2287, Commonwealth)', 'Travis Miles Confident (2287, Commonwealth)']

tools\wiki_to_chromadb\chromadb_ingest.py:345: ValueError
============================== warnings summary ===============================
tools/wiki_to_chromadb/tests/integration/test_full_pipeline.py::TestFullPipeline::test_vault_101_full_pipeline
tools/wiki_to_chromadb/tests/integration/test_full_pipeline.py::TestFullPipeline::test_ncr_full_pipeline
tools/wiki_to_chromadb/tests/integration/test_full_pipeline.py::TestFullPipeline::test_multi_page_pipeline
tools/wiki_to_chromadb/tests/integration/test_full_pipeline.py::TestChromaDBQueries::test_query_by_location
tools/wiki_to_chromadb/tests/integration/test_full_pipeline.py::TestChromaDBQueries::test_query_by_content_type
tools/wiki_to_chromadb/tests/integration/test_full_pipeline.py::TestChromaDBQueries::test_query_pre_war_content
tools/wiki_to_chromadb/tests/integration/test_full_pipeline.py::TestChromaDBQueries::test_query_post_war_content
  C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\site-packages\chromadb\api\types.py:894: DeprecationWarning: The EmbeddingFunction class does not implement name(). This will be required in a future version.
    self.name() is NotImplemented

tools/script-generator/tests/test_enhanced_generator.py: 1 warning
tools/script-generator/tests/test_generator.py: 11 warnings
  C:\Users\doghe\AppData\Local\Programs\Python\Python310\lib\site-packages\chromadb\api\models\CollectionCommon.py:155: DeprecationWarning: legacy embedding function config
    return load_collection_configuration_from_json(self._model.configuration_json)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

---------- coverage: platform win32, python 3.10.11-final-0 ----------
Name                                                                   Stmts   Miss  Cover   Missing
----------------------------------------------------------------------------------------------------
tools\__init__.py                                                          1      0   100%
tools\script-generator\__init__.py                                         1      0   100%
tools\script-generator\broadcast_engine.py                               437    299    32%   29-30, 42-43, 53-54, 127-157, 195, 197, 205, 209, 219, 264, 296-297, 302-303, 318, 329-351, 361-365, 384, 388-393, 406-414, 423-444, 462-537, 557-582, 594-604, 630-820, 839-872, 889-908, 920-956, 964-1074, 1082-1115, 1119, 1133-1163
tools\script-generator\broadcast_freshness.py                            160    116    28%   23-25, 64, 90, 119-171, 190-247, 280-326, 331-378, 382
tools\script-generator\broadcast_scheduler.py                             60     21    65%   59, 63, 70-81, 85-92, 96, 122-124
tools\script-generator\broadcast_scheduler_v2.py                         197     38    81%   128, 167, 213-216, 250, 286-299, 404-411, 471, 496, 505, 543-544, 579, 581, 583, 585, 589, 593-594, 598, 602, 606, 610
tools\script-generator\consistency_validator.py                          110      7    94%   81, 210, 241, 245, 260-262
tools\script-generator\content_types\__init__.py                           1      0   100%
tools\script-generator\content_types\gossip.py                           105     33    69%   72, 119, 148, 164-168, 172, 191, 206, 276-296, 326, 333, 349-368
tools\script-generator\content_types\news.py                              70     13    81%   92-93, 108-110, 136, 148, 174, 215, 217, 220-223
tools\script-generator\content_types\time_check.py                        80     27    66%   137, 164-166, 176, 201-203, 217, 242-243, 267-269, 311-325, 369-371
tools\script-generator\content_types\weather.py                           65     16    75%   141, 150, 153-156, 160-163, 167, 217, 303-309
tools\script-generator\demo_llm_validation_integration.py                 86     86     0%   8-147
tools\script-generator\dj_knowledge_profiles.py                          175     38    78%   54, 58, 62, 68, 641-674, 689-701, 706-721
tools\script-generator\generator.py                                      402    138    66%   145, 214, 216, 218, 225, 231, 245, 330, 571-573, 647, 658, 675-698, 709-716, 757-815, 849-905, 923-936, 952-968, 977-980, 989-992, 1004-1027, 1076-1078, 1083-1123
tools\script-generator\llm_pipeline.py                                   101     17    83%   367-384
tools\script-generator\llm_validator.py                                  207     30    86%   147, 264-266, 322-333, 410, 475, 485-486, 509-517, 573-585, 704-706, 730-731, 740, 766-767
tools\script-generator\ollama_client.py                                   77     25    68%   138-140, 168-169, 174-208
tools\script-generator\personality_loader.py                              67     33    51%   121-165
tools\script-generator\phase6_validation.py                              328     70    79%   21-22, 105-106, 116-117, 128-129, 135, 140, 147, 154, 159, 170, 189-191, 274-276, 387-389, 462-463, 470-472, 505, 521, 533, 557, 575-581, 589-591, 613, 661-679, 684-710, 714
tools\script-generator\query_helpers.py                                   71      6    92%   131, 163, 208-211
tools\script-generator\query_weather_history.py                          114    114     0%   24-266
tools\script-generator\rag_cache.py                                      164     35    79%   163, 229, 245-252, 262-267, 298, 320-321, 328-336, 364, 397-410, 427-430
tools\script-generator\regenerate_weather_calendar.py                     74     74     0%   21-192
tools\script-generator\regional_climate.py                                40      0   100%
tools\script-generator\segment_plan.py                                    75      6    92%   77, 80-81, 84, 100, 156
tools\script-generator\session_memory.py                                 106      2    98%   314-320
tools\script-generator\set_weather.py                                     69     69     0%   21-201
tools\script-generator\story_system\__init__.py                            2      0   100%
tools\script-generator\story_system\escalation_engine.py                 143    143     0%   13-418
tools\script-generator\story_system\lore_validator.py                    127    127     0%   13-358
tools\script-generator\story_system\story_extractor.py                   259    192    26%   101-103, 122, 133, 150, 159-165, 167-169, 184, 193-199, 201-203, 211-221, 230-277, 283-338, 342-381, 386-441, 445-475, 479-485, 488-493, 496-503, 506-511, 514-520, 530-541, 544-550
tools\script-generator\story_system\story_models.py                      123     20    84%   163, 168, 233-235, 240, 245-247, 256-272
tools\script-generator\story_system\story_scheduler.py                   119     94    21%   101-145, 159-177, 189-202, 215-247, 259-276, 280-292, 296-299, 308-323, 332-336, 345
tools\script-generator\story_system\story_state.py                       119     60    50%   89-95, 107, 120-126, 136-139, 151, 161-186, 200-212, 220, 224-271, 316-317, 322-326, 330-335
tools\script-generator\story_system\story_weaver.py                      113     94    17%   67-89, 107, 119-136, 148-155, 170-187, 203-226, 239-258, 279-314, 326-334
tools\script-generator\story_system\tests\__init__.py                      0      0   100%
tools\script-generator\story_system\tests\test_escalation_engine.py      154    154     0%   7-449
tools\script-generator\story_system\tests\test_lore_validator.py          92     92     0%   3-268
tools\script-generator\story_system\tests\test_scheduler.py              168    168     0%   3-322
tools\script-generator\story_system\tests\test_story_extractor.py        130    130     0%   3-303
tools\script-generator\story_system\tests\test_story_models.py            95     95     0%   3-283
tools\script-generator\story_system\tests\test_story_weaver.py           142    142     0%   7-341
tools\script-generator\story_system\tests\test_timeline_validator.py      85     85     0%   3-269
tools\script-generator\story_system\timeline_validator.py                104    104     0%   13-324
tools\script-generator\test_broadcast_llm_validation.py                  108    108     0%   8-202
tools\script-generator\test_dj_knowledge_system.py                       132    132     0%   11-386
tools\script-generator\test_llm_validator_standalone.py                  137    137     0%   8-302
tools\script-generator\tests\conftest.py                                  58     44    24%   28-34, 50-56, 71-87, 103, 119, 135, 159-162, 166-179, 183
tools\script-generator\tests\e2e\__init__.py                               0      0   100%
tools\script-generator\tests\e2e\test_4hour_broadcast.py                  71     61    14%   23-128, 132-133
tools\script-generator\tests\e2e\test_7day_extended.py                    81     72    11%   22-143, 147-148
tools\script-generator\tests\e2e\test_24hour_broadcast.py                 45     36    20%   22-88, 91-92
tools\script-generator\tests\e2e\test_ollama_setup.py                     67     51    24%   22-23, 31-43, 48-68, 73-102, 106-107
tools\script-generator\tests\e2e\test_single_segments.py                  87     74    15%   29-114, 119-161, 165-166
tools\script-generator\tests\test_broadcast_freshness.py                 146      0   100%
tools\script-generator\tests\test_broadcast_scheduler_v2.py              190      1    99%   437
tools\script-generator\tests\test_enhanced_generator.py                   37     24    35%   38-75, 78
tools\script-generator\tests\test_enhanced_queries.py                    189      0   100%
tools\script-generator\tests\test_generator.py                           146     43    71%   82-83, 120, 180-181, 185, 200-203, 250-268, 291-321, 325-326
tools\script-generator\tests\test_generator_cache_integration.py          70      5    93%   133-136, 140
tools\script-generator\tests\test_llm_pipeline.py                        178     26    85%   46-68, 119-135, 256-270, 372-373, 448
tools\script-generator\tests\test_llm_validator.py                       132     28    79%   117-118, 143-144, 228-229, 253-254, 265-266, 301-302, 307-323, 327
tools\script-generator\tests\test_phase1_session_state.py                265     15    94%   317-318, 367, 377, 386-389, 398-399, 406-413, 486
tools\script-generator\tests\test_phase2_consistency_validator.py        155      2    99%   248, 431
tools\script-generator\tests\test_phase2_integration.py                   97      1    99%   219
tools\script-generator\tests\test_phase3_content_types.py                214      1    99%   418
tools\script-generator\tests\test_phase3_continuity.py                    86      2    98%   31, 232
tools\script-generator\tests\test_phase4_emergency.py                     82      2    98%   35, 274
tools\script-generator\tests\test_phase5_cli_tools.py                    196     12    94%   155, 402-414, 418-419
tools\script-generator\tests\test_phase6_validation.py                   132      1    99%   301
tools\script-generator\tests\test_rag_cache.py                           156     33    79%   203-205, 222-225, 242-251, 268-276, 296-302, 317-325, 340-349, 378
tools\script-generator\tests\test_validation_fix.py                       25      3    88%   32-34
tools\script-generator\tests\test_weather_simulator.py                   153      1    99%   309
tools\script-generator\tests\validate_scripts_enhanced.py                443    370    16%   95, 111-112, 126-130, 133-135, 182-284, 296-362, 373-394, 403-422, 431-473, 482-502, 513-543, 552-608, 614-650, 654-688, 692-720, 724-745, 749-754, 760-809, 813-848, 853-907, 911
tools\script-generator\validation_engine.py                              172    172     0%   18-523
tools\script-generator\validation_rules.py                               157    157     0%   12-491
tools\script-generator\weather_simulator.py                              143      6    96%   276-279, 316, 329, 346
tools\script-generator\world_state.py                                    137      4    97%   16-17, 261, 271
tools\shared\__init__.py                                                   1      0   100%
tools\shared\logging_config.py                                           266     60    77%   72, 167-201, 221, 232-233, 245, 262-268, 332-335, 377, 494, 507, 534, 544-575
tools\shared\mock_ollama_client.py                                       123     43    65%   134, 137, 140, 143, 150, 154-157, 189, 249, 254-303
tools\shared\project_config.py                                            18      3    83%   40-42
tools\wiki_to_chromadb\__init__.py                                         1      0   100%
tools\wiki_to_chromadb\analyze_dump_stats.py                              89     89     0%   8-199
tools\wiki_to_chromadb\analyze_log.py                                    210    210     0%   12-316
tools\wiki_to_chromadb\benchmark.py                                      202    202     0%   11-390
tools\wiki_to_chromadb\chromadb_ingest.py                                125     45    64%   19-22, 90-94, 156, 176-183, 187, 192, 211-213, 274-275, 353-420
tools\wiki_to_chromadb\chunker.py                                        149    149     0%   19-454
tools\wiki_to_chromadb\chunker_v2.py                                     125     43    66%   49-56, 129, 157-164, 173, 182-183, 196, 282-315, 320-354
tools\wiki_to_chromadb\config.py                                          64     27    58%   73-103, 107-116, 126-128, 134, 140
tools\wiki_to_chromadb\constants.py                                       12      0   100%
tools\wiki_to_chromadb\debug_missing_sections.py                          52     52     0%   5-80
tools\wiki_to_chromadb\debug_sections.py                                  56     56     0%   5-87
tools\wiki_to_chromadb\examples\__init__.py                                0      0   100%
tools\wiki_to_chromadb\examples\example_julie_knowledge.py                51     51     0%   11-93
tools\wiki_to_chromadb\examples\example_query.py                          89     89     0%   7-173
tools\wiki_to_chromadb\examples\example_structural_queries.py            123    123     0%   12-218
tools\wiki_to_chromadb\examples\migrate_chromadb_ingest.py                27     27     0%   19-155
tools\wiki_to_chromadb\extractors.py                                     123     10    92%   92, 147, 187-188, 195-197, 291-293
tools\wiki_to_chromadb\logging_config.py                                  36     17    53%   21-23, 35-60
tools\wiki_to_chromadb\metadata_enrichment.py                            225     38    83%   62, 95-96, 101-102, 107-108, 112, 114, 116, 118, 121, 123, 125, 168, 216, 292, 331-332, 346-347, 366-367, 479-513
tools\wiki_to_chromadb\metadata_enrichment_v2.py                         232     33    86%   95-96, 103, 222-224, 229-231, 239-241, 245, 247, 249, 251, 254, 256, 260, 324, 359-362, 371-372, 379, 410, 418, 505-509, 564
tools\wiki_to_chromadb\models.py                                         166     13    92%   23, 135-136, 222, 244-245, 260-262, 266, 270-272
tools\wiki_to_chromadb\phase6_metadata_audit.py                          260    163    37%   23-25, 50, 80-196, 214-292, 309-375, 392-440, 620, 622, 646, 677-690, 694
tools\wiki_to_chromadb\process_wiki.py                                   224    224     0%   19-456
tools\wiki_to_chromadb\re_enrich_database.py                              91     91     0%   8-175
tools\wiki_to_chromadb\re_enrich_phase6.py                               229    197    14%   21-24, 61-62, 67, 72-75, 88-94, 110-293, 305-384, 393-409, 414-458, 462
tools\wiki_to_chromadb\setup.py                                          112    112     0%   7-188
tools\wiki_to_chromadb\template_parser.py                                 87     87     0%   14-265
tools\wiki_to_chromadb\test_database.py                                   62     62     0%   5-100
tools\wiki_to_chromadb\test_ingestion_quality.py                         129    129     0%   4-278
tools\wiki_to_chromadb\test_new_patterns.py                               45     45     0%   5-80
tools\wiki_to_chromadb\test_section_fix.py                                35     35     0%   2-74
tools\wiki_to_chromadb\tests\__init__.py                                   0      0   100%
tools\wiki_to_chromadb\tests\fixtures\__init__.py                          0      0   100%
tools\wiki_to_chromadb\tests\fixtures\sample_data.py                       8      0   100%
tools\wiki_to_chromadb\tests\integration\conftest.py                      15      5    67%   14, 20-22, 28
tools\wiki_to_chromadb\tests\integration\test_full_pipeline.py           183      0   100%
tools\wiki_to_chromadb\tests\unit\__init__.py                              0      0   100%
tools\wiki_to_chromadb\tests\unit\test_broadcast_metadata.py             165      6    96%   87-89, 103-105
tools\wiki_to_chromadb\tests\unit\test_chunker_v2.py                     128      2    98%   74, 271
tools\wiki_to_chromadb\tests\unit\test_extractors.py                      89      1    99%   181
tools\wiki_to_chromadb\tests\unit\test_metadata_enrichment.py            211      0   100%
tools\wiki_to_chromadb\tests\unit\test_metadata_enrichment_v2.py         145     13    91%   115, 255-264, 276-284, 297-305
tools\wiki_to_chromadb\tests\unit\test_phase6_audit.py                    96     16    83%   124-134, 145-153
tools\wiki_to_chromadb\tests\unit\test_re_enrich_phase6.py               144     63    56%   25-32, 43-48, 61-71, 86-104, 119-125, 136-143, 154-160, 175-176, 187-190, 206-207, 217-221, 240-243, 252-257
tools\wiki_to_chromadb\tests\unit\test_section_fixes.py                   80      1    99%   168
tools\wiki_to_chromadb\verify_database.py                                209    209     0%   13-556
tools\wiki_to_chromadb\verify_fixes.py                                    52     52     0%   7-82
tools\wiki_to_chromadb\wiki_parser.py                                     81     81     0%   8-193
tools\wiki_to_chromadb\wiki_parser_v2.py                                  63     28    56%   79-125
----------------------------------------------------------------------------------------------------
TOTAL                                                                  15413   7639    50%

=========================== short test summary info ===========================
FAILED tests/unit/test_broadcast_engine.py::TestBroadcastEngineSegmentGeneration::test_generate_weather_segment - TypeError: fromisoformat: argument must be str
FAILED tests/unit/test_llm_pipeline.py::TestLLMPipelineGeneration::test_generate_with_validation_updates_metrics - assert 0 > 0
FAILED tests/unit/test_llm_pipeline.py::TestLLMPipelineSegmentPlanIntegration::test_generate_from_plan - AttributeError: <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B1D6140> does not have the attribute 'chat'
FAILED tests/unit/test_llm_pipeline.py::TestLLMPipelineSegmentPlanIntegration::test_generate_from_plan_with_custom_lore - AttributeError: <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B257970> does not have the attribute 'chat'
FAILED tests/unit/test_llm_pipeline.py::TestLLMPipelineMetrics::test_metrics_tracking - AttributeError: <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B31E5C0> does not have the attribute 'chat'
FAILED tests/unit/test_llm_pipeline.py::TestLLMPipelineMetrics::test_metrics_reset - AttributeError: <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B29E020> does not have the attribute 'chat'
FAILED tests/unit/test_llm_pipeline.py::TestLLMPipelineMetrics::test_print_metrics_report - AttributeError: <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B324760> does not have the attribute 'chat'
FAILED tests/unit/test_llm_pipeline.py::TestLLMPipelineRetryLogic::test_single_call_success - AttributeError: <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D27AD8CD0> does not have the attribute 'chat'
FAILED tests/unit/test_llm_pipeline.py::TestLLMPipelineCacheIntegration::test_cache_hit_tracking - AttributeError: <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B2CC280> does not have the attribute 'chat'
FAILED tests/unit/test_llm_pipeline.py::TestLLMPipelineCacheIntegration::test_cache_miss_tracking - AttributeError: <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D064F4790> does not have the attribute 'chat'
FAILED tests/unit/test_llm_pipeline.py::TestLLMPipelineCacheIntegration::test_no_cache_tracking_without_cache - AttributeError: <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B260430> does not have the attribute 'chat'
FAILED tests/unit/test_llm_pipeline.py::TestLLMPipelineValidationGuided::test_validation_guided_percentage - AttributeError: <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B333AC0> does not have the attribute 'chat'
FAILED tests/unit/test_llm_pipeline.py::TestLLMPipelineValidationGuided::test_embedded_constraints_in_prompt - AttributeError: <tools.shared.mock_ollama_client.MockOllamaClient object at 0x0000024D0B1F8400> does not have the attribute 'chat'
FAILED tests/unit/test_llm_validator.py::TestLLMValidatorValidation::test_validate_with_json_response - AttributeError: 'MockOllamaClient' object has no attribute 'set_custom_response'
FAILED tests/unit/test_llm_validator.py::TestLLMValidatorValidation::test_validate_with_critical_issues - AttributeError: 'MockOllamaClient' object has no attribute 'set_custom_response'
FAILED tests/unit/test_llm_validator.py::TestLLMValidatorValidation::test_validate_with_malformed_json - AttributeError: 'MockOllamaClient' object has no attribute 'set_custom_response'
FAILED tests/unit/test_llm_validator.py::TestLLMValidatorValidation::test_validate_with_specific_aspects - AttributeError: 'MockOllamaClient' object has no attribute 'set_custom_response'
FAILED tests/unit/test_llm_validator.py::TestLLMValidatorQuickValidate::test_quick_validate_valid_script - AttributeError: 'MockOllamaClient' object has no attribute 'set_custom_response'
FAILED tests/unit/test_llm_validator.py::TestLLMValidatorQuickValidate::test_quick_validate_with_issues - AttributeError: 'MockOllamaClient' object has no attribute 'set_custom_response'
FAILED tests/unit/test_llm_validator.py::TestHybridValidatorValidation::test_hybrid_validation_both_modes - AttributeError: 'MockOllamaClient' object has no attribute 'set_custom_response'
FAILED tests/unit/test_llm_validator.py::TestHybridValidatorValidation::test_hybrid_validation_llm_only_mode - AttributeError: 'MockOllamaClient' object has no attribute 'set_custom_response'
FAILED tests/unit/test_llm_validator.py::TestHybridValidatorValidation::test_hybrid_validation_combines_issues - AttributeError: 'MockOllamaClient' object has no attribute 'set_custom_response'
FAILED tests/unit/test_llm_validator.py::TestValidateScriptConvenienceFunction::test_validate_script_llm_strategy - AttributeError: 'MockOllamaClient' object has no attribute 'set_custom_response'
FAILED tests/unit/test_llm_validator.py::TestValidateScriptConvenienceFunction::test_validate_script_hybrid_strategy - AttributeError: 'MockOllamaClient' object has no attribute 'set_custom_response'
FAILED tests/unit/test_llm_validator.py::TestValidationModes::test_validation_mode_all_aspects - AttributeError: 'MockOllamaClient' object has no attribute 'set_custom_response'
FAILED tests/unit/test_llm_validator.py::TestValidationModes::test_validation_mode_subset_aspects - AttributeError: 'MockOllamaClient' object has no attribute 'set_custom_response'
FAILED tests/unit/test_ollama_client.py::TestOllamaClientMocked::test_connection_error - ConnectionError: Cannot connect to Ollama at http://localhost:11434. Is Ollama running? Start with: ollama serve
FAILED tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestComplexityTierClassification::test_complex_tier_long_text - pydantic_core._pydantic_core.ValidationError: 30 validation errors for StructuralMetadata
wikilinks.0.display
  Field required [type=missing, input_value={'target': 'link0'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.0.type
  Field required [type=missing, input_value={'target': 'link0'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.1.display
  Field required [type=missing, input_value={'target': 'link1'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.1.type
  Field required [type=missing, input_value={'target': 'link1'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.2.display
  Field required [type=missing, input_value={'target': 'link2'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.2.type
  Field required [type=missing, input_value={'target': 'link2'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.3.display
  Field required [type=missing, input_value={'target': 'link3'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.3.type
  Field required [type=missing, input_value={'target': 'link3'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.4.display
  Field required [type=missing, input_value={'target': 'link4'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.4.type
  Field required [type=missing, input_value={'target': 'link4'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.5.display
  Field required [type=missing, input_value={'target': 'link5'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.5.type
  Field required [type=missing, input_value={'target': 'link5'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.6.display
  Field required [type=missing, input_value={'target': 'link6'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.6.type
  Field required [type=missing, input_value={'target': 'link6'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.7.display
  Field required [type=missing, input_value={'target': 'link7'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.7.type
  Field required [type=missing, input_value={'target': 'link7'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.8.display
  Field required [type=missing, input_value={'target': 'link8'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.8.type
  Field required [type=missing, input_value={'target': 'link8'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.9.display
  Field required [type=missing, input_value={'target': 'link9'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.9.type
  Field required [type=missing, input_value={'target': 'link9'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.10.display
  Field required [type=missing, input_value={'target': 'link10'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.10.type
  Field required [type=missing, input_value={'target': 'link10'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.11.display
  Field required [type=missing, input_value={'target': 'link11'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.11.type
  Field required [type=missing, input_value={'target': 'link11'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.12.display
  Field required [type=missing, input_value={'target': 'link12'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.12.type
  Field required [type=missing, input_value={'target': 'link12'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.13.display
  Field required [type=missing, input_value={'target': 'link13'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.13.type
  Field required [type=missing, input_value={'target': 'link13'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.14.display
  Field required [type=missing, input_value={'target': 'link14'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.14.type
  Field required [type=missing, input_value={'target': 'link14'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
FAILED tools/wiki_to_chromadb/tests/unit/test_broadcast_metadata.py::TestComplexityTierClassification::test_moderate_tier - pydantic_core._pydantic_core.ValidationError: 10 validation errors for StructuralMetadata
wikilinks.0.display
  Field required [type=missing, input_value={'target': 'link0'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.0.type
  Field required [type=missing, input_value={'target': 'link0'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.1.display
  Field required [type=missing, input_value={'target': 'link1'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.1.type
  Field required [type=missing, input_value={'target': 'link1'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.2.display
  Field required [type=missing, input_value={'target': 'link2'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.2.type
  Field required [type=missing, input_value={'target': 'link2'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.3.display
  Field required [type=missing, input_value={'target': 'link3'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.3.type
  Field required [type=missing, input_value={'target': 'link3'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.4.display
  Field required [type=missing, input_value={'target': 'link4'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
wikilinks.4.type
  Field required [type=missing, input_value={'target': 'link4'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
FAILED tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestEnhancedYearExtraction::test_century_expressions - assert 2267 == 2299
FAILED tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestEnhancedLocationClassification::test_specific_location_classification - AssertionError: assert 'Appalachia' == 'appalachia'
  
  - appalachia
  ? ^
  + Appalachia
  ? ^
FAILED tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestEnrichChunk::test_enrich_faction_chunk - pydantic_core._pydantic_core.ValidationError: 4 validation errors for ChunkMetadata
wiki_title
  Field required [type=missing, input_value={'title': 'Brotherhood of...0, 'infobox_type': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
timestamp
  Field required [type=missing, input_value={'title': 'Brotherhood of...0, 'infobox_type': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
section
  Field required [type=missing, input_value={'title': 'Brotherhood of...0, 'infobox_type': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
total_chunks
  Field required [type=missing, input_value={'title': 'Brotherhood of...0, 'infobox_type': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
FAILED tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestEnrichChunk::test_enrich_location_chunk - pydantic_core._pydantic_core.ValidationError: 4 validation errors for ChunkMetadata
wiki_title
  Field required [type=missing, input_value={'title': 'Appalachia', '...0, 'infobox_type': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
timestamp
  Field required [type=missing, input_value={'title': 'Appalachia', '...0, 'infobox_type': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
section
  Field required [type=missing, input_value={'title': 'Appalachia', '...0, 'infobox_type': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
total_chunks
  Field required [type=missing, input_value={'title': 'Appalachia', '...0, 'infobox_type': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
FAILED tools/wiki_to_chromadb/tests/unit/test_metadata_enrichment_v2.py::TestEnrichChunk::test_knowledge_tier_assignment - pydantic_core._pydantic_core.ValidationError: 4 validation errors for ChunkMetadata
wiki_title
  Field required [type=missing, input_value={'title': 'Test Article',...0, 'infobox_type': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
timestamp
  Field required [type=missing, input_value={'title': 'Test Article',...0, 'infobox_type': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
section
  Field required [type=missing, input_value={'title': 'Test Article',...0, 'infobox_type': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
total_chunks
  Field required [type=missing, input_value={'title': 'Test Article',...0, 'infobox_type': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.9/v/missing
FAILED tools/wiki_to_chromadb/tests/unit/test_phase6_audit.py::TestMetadataAuditor::test_generate_audit_reports_without_db - UnicodeEncodeError: 'charmap' codec can't encode character '\u2705' in position 1715: character maps to <undefined>
FAILED tools/wiki_to_chromadb/tests/unit/test_phase6_audit.py::TestMetadataAuditor::test_markdown_report_generation - UnicodeEncodeError: 'charmap' codec can't encode character '\u2705' in position 1740: character maps to <undefined>
FAILED tools/script-generator/tests/test_enhanced_generator.py::test_enhanced_generator - jinja2.exceptions.UndefinedError: 'weather_continuity' is undefined
FAILED tools/script-generator/tests/test_generator.py::TestFullPipeline::test_generate_weather_script - jinja2.exceptions.UndefinedError: 'weather_continuity' is undefined
FAILED tools/script-generator/tests/test_generator.py::TestFullPipeline::test_save_script - jinja2.exceptions.UndefinedError: 'weather_continuity' is undefined
FAILED tools/script-generator/tests/test_generator_cache_integration.py::TestGeneratorCacheIntegration::test_cache_report_prints - KeyError: 'topics_cached'
FAILED tools/script-generator/tests/test_llm_pipeline.py::TestConstraintEmbedding::test_constraint_embedding_in_prompt - TypeError: ValidationConstraints.__init__() got an unexpected keyword argument 'tone'
FAILED tools/script-generator/tests/test_llm_pipeline.py::TestValidationGuidedGeneration::test_single_llm_call_generation - TypeError: ValidationConstraints.__init__() got an unexpected keyword argument 'tone'
FAILED tools/script-generator/tests/test_llm_pipeline.py::TestSchedulerIntegration::test_generate_from_segment_plan - TypeError: ValidationConstraints.__init__() got an unexpected keyword argument 'tone'
FAILED tools/script-generator/tests/test_llm_pipeline.py::TestMetricsTracking::test_average_calculations - AssertionError: 0 not greater than 0
FAILED tools/script-generator/tests/test_phase1_session_state.py::TestBroadcastScheduler::test_scheduler_init - AttributeError: 'BroadcastScheduler' object has no attribute 'last_segment_times'
FAILED tools/script-generator/tests/test_phase1_session_state.py::TestBroadcastScheduler::test_segment_interval_enforcement - AssertionError: assert True == False
 +  where True = is_time_for_segment('weather')
 +    where is_time_for_segment = <broadcast_scheduler.BroadcastScheduler object at 0x0000024D0B233490>.is_time_for_segment
FAILED tools/script-generator/tests/test_phase1_session_state.py::TestBroadcastScheduler::test_next_priority_segment - assert None is not None
FAILED tools/script-generator/tests/test_phase1_session_state.py::TestBroadcastScheduler::test_segments_status - AssertionError: assert 'weather' in {'news_done': [], 'news_hours': [], 'time_checks_done': [], 'weather_done': [], ...}
FAILED tools/script-generator/tests/test_phase1_session_state.py::TestBroadcastScheduler::test_scheduler_reset - AssertionError: assert True == False
 +  where True = is_time_for_segment('weather')
 +    where is_time_for_segment = <broadcast_scheduler.BroadcastScheduler object at 0x0000024D0B1F6650>.is_time_for_segment
FAILED tools/script-generator/tests/test_phase1_session_state.py::TestBroadcastScheduler::test_time_priority_variation - AttributeError: 'BroadcastScheduler' object has no attribute 'time_of_day_priorities'
FAILED tools/script-generator/tests/test_phase6_validation.py::TestPhase6Validator::test_query_performance - AssertionError: 'overhead_ms' not found in {'total_queries': 10, 'query_times': [], 'baseline_times': [0.0, 0.0, 0.0, 0.0, 0.0], 'enhanced_times': [0.0, 0.0, 0.0, 0.0, 0.0], 'baseline_avg': 0.0, 'baseline_min': 0.0, 'baseline_max': 0.0, 'enhanced_avg': 0.0, 'enhanced_min': 0.0, 'enhanced_max': 0.0}
FAILED tools/script-generator/tests/test_rag_cache.py::TestRAGCache::test_cache_miss_and_store - ValueError: Unknown DJ: Julie. Available: ['Julie (2102, Appalachia)', 'Mr. New Vegas (2281, Mojave)', 'Travis Miles Nervous (2287, Commonwealth)', 'Travis Miles Confident (2287, Commonwealth)']
FAILED tools/script-generator/tests/test_rag_cache.py::TestRAGCache::test_cache_hit - ValueError: Unknown DJ: Julie. Available: ['Julie (2102, Appalachia)', 'Mr. New Vegas (2281, Mojave)', 'Travis Miles Nervous (2287, Commonwealth)', 'Travis Miles Confident (2287, Commonwealth)']
FAILED tools/script-generator/tests/test_rag_cache.py::TestRAGCache::test_lru_eviction - ValueError: Unknown DJ: Julie. Available: ['Julie (2102, Appalachia)', 'Mr. New Vegas (2281, Mojave)', 'Travis Miles Nervous (2287, Commonwealth)', 'Travis Miles Confident (2287, Commonwealth)']
FAILED tools/script-generator/tests/test_rag_cache.py::TestRAGCache::test_custom_ttl - ValueError: Unknown DJ: Julie. Available: ['Julie (2102, Appalachia)', 'Mr. New Vegas (2281, Mojave)', 'Travis Miles Nervous (2287, Commonwealth)', 'Travis Miles Confident (2287, Commonwealth)']
FAILED tools/script-generator/tests/test_rag_cache.py::TestRAGCache::test_topic_based_caching - ValueError: Unknown DJ: Julie. Available: ['Julie (2102, Appalachia)', 'Mr. New Vegas (2281, Mojave)', 'Travis Miles Nervous (2287, Commonwealth)', 'Travis Miles Confident (2287, Commonwealth)']
FAILED tools/script-generator/tests/test_rag_cache.py::TestRAGCache::test_cache_invalidation_all - ValueError: Unknown DJ: Julie. Available: ['Julie (2102, Appalachia)', 'Mr. New Vegas (2281, Mojave)', 'Travis Miles Nervous (2287, Commonwealth)', 'Travis Miles Confident (2287, Commonwealth)']
FAILED tools/script-generator/tests/test_rag_cache.py::TestRAGCache::test_cache_invalidation_topic - ValueError: Unknown DJ: Julie. Available: ['Julie (2102, Appalachia)', 'Mr. New Vegas (2281, Mojave)', 'Travis Miles Nervous (2287, Commonwealth)', 'Travis Miles Confident (2287, Commonwealth)']
===== 58 failed, 869 passed, 23 skipped, 19 warnings in 222.43s (0:03:42) =====
================================================================================

ðŸ“ Logs saved:
   Human-readable: C:\esp32-project\logs\session_20260120_122847_all.log
   Structured JSON: C:\esp32-project\logs\session_20260120_122847_all.json
   LLM-optimized: C:\esp32-project\logs\session_20260120_122847_all.llm.md

================================================================================
SESSION ENDED
End Time: 2026-01-20 12:32:33
Duration: 226.11 seconds
Status: completed
================================================================================

Log saved to: C:\esp32-project\logs\session_20260120_122847_all.log
Metadata saved to: C:\esp32-project\logs\session_20260120_122847_all.json
LLM log saved to: C:\esp32-project\logs\session_20260120_122847_all.llm.md
